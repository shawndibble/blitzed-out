{"version":3,"file":"index.tsx-DCVCFFRx.js","sources":["../../src/views/Navigation/UserPresenceOverlay/index.tsx"],"sourcesContent":["import { Box, Typography, Popover, Chip } from '@mui/material';\nimport { useEffect, useRef } from 'react';\nimport TextAvatar from '@/components/TextAvatar';\nimport { useTranslation } from 'react-i18next';\nimport { Player } from '@/types/player';\nimport type { HybridPlayer } from '@/hooks/useHybridPlayerList';\nimport { isLocalPlayer } from '@/hooks/useHybridPlayerList';\n\ninterface PlayerWithLocation extends Player {\n  location?: number;\n}\n\ninterface UserPresenceOverlayProps {\n  isOpen: boolean;\n  onClose: () => void;\n  playerList: (PlayerWithLocation | HybridPlayer)[];\n  anchorEl: HTMLElement | null;\n}\n\nexport default function UserPresenceOverlay({\n  isOpen,\n  onClose,\n  playerList,\n  anchorEl,\n}: UserPresenceOverlayProps): JSX.Element {\n  const { t } = useTranslation();\n  const contentRef = useRef<HTMLDivElement>(null);\n\n  // Focus management\n  useEffect(() => {\n    if (isOpen && contentRef.current) {\n      contentRef.current.focus();\n    }\n  }, [isOpen]);\n\n  return (\n    <Popover\n      open={isOpen}\n      anchorEl={anchorEl}\n      onClose={onClose}\n      anchorOrigin={{\n        vertical: 'bottom',\n        horizontal: 'center',\n      }}\n      transformOrigin={{\n        vertical: 'top',\n        horizontal: 'center',\n      }}\n      sx={{ zIndex: 1300 }}\n      slotProps={{\n        paper: {\n          sx: {\n            borderRadius: 2,\n            boxShadow: 3,\n            p: { xs: 1.5, sm: 2 },\n            backgroundColor: 'background.paper',\n          },\n        },\n      }}\n      disableRestoreFocus\n      disableEnforceFocus\n    >\n      <Box\n        ref={contentRef}\n        role=\"dialog\"\n        aria-label={t('online')}\n        aria-modal=\"true\"\n        tabIndex={-1}\n        onKeyDown={(event) => {\n          if (event.key === 'Escape') {\n            onClose();\n          }\n        }}\n      >\n        <Typography\n          variant=\"subtitle2\"\n          sx={{\n            mb: 1.5,\n            color: 'text.secondary',\n            fontSize: '0.75rem',\n            textTransform: 'uppercase',\n            letterSpacing: 0.5,\n          }}\n        >\n          {/* Show different title for local vs online players */}\n          {playerList.some((p) => 'isLocal' in p && isLocalPlayer(p as HybridPlayer))\n            ? t('players')\n            : t('online')}{' '}\n          ({playerList.length})\n        </Typography>\n\n        <Box\n          sx={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: { xs: 1, sm: 1.5 },\n            alignItems: 'flex-start',\n          }}\n        >\n          {playerList.map((player) => {\n            const isLocal = 'isLocal' in player && player.isLocal;\n            const showLocalMode = playerList.some(\n              (p) => 'isLocal' in p && isLocalPlayer(p as HybridPlayer)\n            );\n\n            return (\n              <Box\n                key={player.uid}\n                sx={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: { xs: 0.75, sm: 1 },\n                  width: 'auto',\n                }}\n              >\n                <TextAvatar uid={player.uid} displayName={player.displayName} size=\"medium\" />\n                <Box sx={{ display: 'flex', flexDirection: 'column', gap: 0.25, minWidth: 0 }}>\n                  <Typography\n                    variant=\"body2\"\n                    sx={{\n                      fontSize: { xs: '0.8125rem', sm: '0.875rem' },\n                      color: player.isSelf ? 'primary.main' : 'text.primary',\n                      fontWeight: player.isSelf ? 600 : 400,\n                      whiteSpace: 'nowrap',\n                    }}\n                  >\n                    {player.displayName}\n                    {player.isSelf && (\n                      <Typography\n                        component=\"span\"\n                        sx={{\n                          ml: 0.5,\n                          fontSize: { xs: '0.7rem', sm: '0.75rem' },\n                          color: 'text.secondary',\n                        }}\n                      >\n                        ({t('you')})\n                      </Typography>\n                    )}\n                  </Typography>\n                  {isLocal && !showLocalMode && (\n                    <Chip\n                      label={t('localPlayer')}\n                      size=\"small\"\n                      color=\"secondary\"\n                      variant=\"outlined\"\n                      sx={{\n                        fontSize: '0.625rem',\n                        height: '16px',\n                        alignSelf: 'flex-start',\n                      }}\n                    />\n                  )}\n                </Box>\n              </Box>\n            );\n          })}\n        </Box>\n      </Box>\n    </Popover>\n  );\n}\n"],"names":["UserPresenceOverlay","isOpen","onClose","playerList","anchorEl","t","useTranslation","contentRef","useRef","useEffect","jsx","Popover","jsxs","Box","event","Typography","p","isLocalPlayer","player","isLocal","showLocalMode","TextAvatar","Chip"],"mappings":"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"}