import{u as A,b as i,j as e,ar as v,aP as S,S as y,a3 as b,ay as C,aw as d,t as k,ae as P,az as D,a8 as T,aA as F,aa as K,a4 as I}from"./chunk-DEpGQMoM.js";import{j as G,f as R,h as q}from"./chunk-C0b6J2Rd.js";import{G as N}from"./chunk-B9w7spwz.js";import{A as z}from"./chunk-CZcF1WFm.js";import{u as B,C as _}from"./chunk-DsiWUki8.js";(function(){var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};t.SENTRY_RELEASE={id:"b82d01bea29447e452b49ba3e85b9fac2f7942a4"}})();try{(function(){var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="f5b53ff5-e792-450d-a100-b4bf14ad678f",t._sentryDebugIdIdentifier="sentry-dbid-f5b53ff5-e792-450d-a100-b4bf14ad678f")})()}catch(t){}function V({onSuccess:t,onSwitchToRegister:n,onSwitchToForgotPassword:l,isLinking:s=!1}){const{t:a}=A(),[o,r]=i.useState(""),[u,c]=i.useState(""),[h,m]=i.useState(""),[f,g]=i.useState(!1),j=async p=>{p.preventDefault(),m(""),g(!0);try{await G(o,u),t&&t()}catch(w){console.error("Login error:",w),m(w.message||"Failed to sign in")}finally{g(!1)}};return e.jsxs(v,{component:"form",onSubmit:j,sx:{mt:1},children:[h&&e.jsx(S,{severity:"error",sx:{mb:2},children:h}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:a("email"),name:"email",autoComplete:"email",autoFocus:!0,value:o,onChange:p=>r(p.target.value)}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:a("password"),type:"password",id:"password",autoComplete:"current-password",value:u,onChange:p=>c(p.target.value)}),e.jsx(b,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:f,children:f?e.jsx(C,{size:24}):s?e.jsx(d,{i18nKey:"linkAccount",children:"Link Account"}):e.jsx(d,{i18nKey:"signIn"})}),e.jsxs(k,{align:"center",children:[e.jsx(b,{onClick:n,variant:"text",children:e.jsx(d,{i18nKey:"needAccount"})})," | ",e.jsx(b,{onClick:l,variant:"text",children:e.jsx(d,{i18nKey:"forgotPassword"})})]})]})}function H({onSuccess:t,onSwitchToLogin:n,isAnonymous:l=!1}){const{t:s}=A(),[a,o]=i.useState(""),[r,u]=i.useState(""),[c,h]=i.useState(""),[m,f]=i.useState(""),[g,j]=i.useState(""),[p,w]=i.useState(!1),L=async x=>{if(x.preventDefault(),j(""),c!==m){j(s("passwordsDoNotMatch")||"Passwords do not match");return}w(!0);try{await R(r==null?void 0:r.trim(),c,a==null?void 0:a.trim()),t&&t()}catch(E){console.error("Registration error:",E),j(E.message||"Failed to create account")}finally{w(!1)}};return e.jsxs(v,{component:"form",onSubmit:L,sx:{mt:1},children:[g&&e.jsx(S,{severity:"error",sx:{mb:2},children:g}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,id:"displayName",label:s("displayName"),name:"displayName",autoComplete:"name",autoFocus:!0,value:a,onChange:x=>o(x.target.value)}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:s("email"),name:"email",autoComplete:"email",value:r,onChange:x=>u(x.target.value)}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:s("password"),type:"password",id:"password",autoComplete:"new-password",value:c,onChange:x=>h(x.target.value)}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:s("confirmPassword"),type:"password",id:"confirmPassword",autoComplete:"new-password",value:m,onChange:x=>f(x.target.value)}),e.jsx(b,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:p,children:p?e.jsx(C,{size:24}):l?e.jsx(d,{i18nKey:"linkAccount"}):e.jsx(d,{i18nKey:"createAccount"})}),e.jsx(k,{align:"center",children:e.jsx(b,{onClick:n,variant:"text",children:e.jsx(d,{i18nKey:"alreadyHaveAccount"})})})]})}function M({onSuccess:t,isLinking:n=!1}){const[l,s]=i.useState(""),[a,o]=i.useState(!1),r=async()=>{s(""),o(!0);try{await q(),t&&t()}catch(u){s(u.message||"Failed to sign in with Google")}finally{o(!1)}};return e.jsxs(v,{sx:{mt:2,mb:2},children:[l&&e.jsx(S,{severity:"error",sx:{mb:2},children:l}),e.jsx(P,{sx:{mb:2},children:e.jsx(k,{variant:"body2",color:"text.secondary",children:e.jsx(d,{i18nKey:"or",children:"OR"})})}),e.jsx(b,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(N,{}),onClick:r,disabled:a,sx:{mb:1},"aria-busy":a,"aria-live":"polite",children:a?e.jsx(C,{size:24}):n?D("linkWithGoogle","Link with Google"):D("signInWithGoogle","Sign in with Google")})]})}function W(){const t=i.useContext(z);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function O({children:t,open:n,close:l=null,isMobile:s=null,title:a=null,isLoading:o=!1,maxWidth:r="md",fullWidth:u=!1,ariaLabelledby:c,ariaDescribedby:h,actions:m}){const f=B(),g=s!==null?s:f;return o?null:e.jsxs(T,{fullScreen:g,open:n,maxWidth:r,fullWidth:u,"aria-labelledby":c,"aria-describedby":h,children:[e.jsxs(F,{children:[a,typeof l=="function"&&e.jsx(_,{close:l})]}),e.jsx(K,{children:t}),m&&e.jsx(I,{sx:{p:2,gap:1},children:m})]})}function Y({onToggleForm:t}){const[n,l]=i.useState(""),[s,a]=i.useState(""),[o,r]=i.useState(!1),[u,c]=i.useState(!1),{forgotPassword:h}=W(),m=async f=>{f.preventDefault(),a(""),r(!1),c(!0);try{await h(n),r(!0)}catch(g){a(g.message||"Failed to send reset email")}finally{c(!1)}};return e.jsxs(v,{component:"form",onSubmit:m,sx:{mt:1},children:[s&&e.jsx(S,{severity:"error",sx:{mb:2},children:s}),o&&e.jsx(S,{severity:"success",sx:{mb:2},children:e.jsx(d,{i18nKey:"resetEmailSent"})}),e.jsx(y,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:e.jsx(d,{i18nKey:"email"}),name:"email",autoComplete:"email",autoFocus:!0,value:n,onChange:f=>l(f.target.value)}),e.jsx(b,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:u,children:u?e.jsx(C,{size:24}):e.jsx(d,{i18nKey:"sendResetLink"})}),e.jsx(v,{sx:{textAlign:"center"},children:e.jsx(b,{variant:"text",onClick:()=>t("login"),children:e.jsx(d,{i18nKey:"backToLogin"})})})]})}function $({open:t,close:n,initialView:l="login"}){const[s,a]=i.useState(l),{isAnonymous:o}=W(),{t:r}=A(),u=()=>{switch(s){case"login":return r(o?"linkAccount":"signIn");case"register":return r("createAccount");case"reset":return r("resetPassword");default:return r("Authentication")}};return e.jsxs(O,{title:u(),open:t,close:n,children:[s==="login"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{onSwitchToRegister:()=>a("register"),onSwitchToForgotPassword:()=>a("reset"),onSuccess:n,isLinking:o}),e.jsx(M,{onSuccess:n,isLinking:o})]}),s==="reset"&&e.jsx(Y,{onToggleForm:a}),s==="register"&&e.jsx(H,{onSwitchToLogin:()=>a("login"),onSuccess:n,isAnonymous:o})]})}export{$ as A,O as D,W as u};
//# sourceMappingURL=chunk-lEjw_34E.js.map
