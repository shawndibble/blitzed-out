import{r as n,ad as R,au as C,j as e,am as m,ao as p,T as a,Q as B,ar as F,a1 as L}from"./chunk-DJZJtpVs.js";import{T as I}from"./chunk-9fkTg0gS.js";import{l as E}from"./chunk-C1_7opHt.js";import{b as H}from"./chunk-Ceez7gAO.js";import{p as M,u as P,R as A}from"./chunk-C5PWcsn3.js";import{l as V}from"./chunk-Cpyy8WXm.js";import{g as W}from"./chunk-B4ipE-Yx.js";import"./chunk-7OQk-BoX.js";import"./chunk-DEqUmdJg.js";import"../assets/index-MqAcv3q7.js";import"./chunk-DtF_b7C9.js";import"./chunk-B4PEA_xj.js";import"./chunk-yLOK5aTh.js";function $(s){const i=E(s,"room");let o=!1,t="";if(i){const{roomBackgroundURL:c}=JSON.parse(i.settings),l=M(c);l?.isVideo&&(o=l.isVideo),l?.url&&(t=l.url)}return["color","gray"].some(c=>t.includes(c))&&(t=""),{isVideo:o,url:t}}function O(){const[s,i]=n.useState(document.fullscreenElement!=null);n.useEffect(()=>{const t=()=>{i(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]);const o=n.useCallback(()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen().catch(t=>{console.error("Error attempting to enable fullscreen:",t)}):document.exitFullscreen().catch(t=>{console.error("Error attempting to exit fullscreen:",t)})},[]);return{isFullscreen:s,toggleFullscreen:o}}const D="actions",K=s=>{const{text:i,displayName:o}=s;if(!o)return{};const t=i?.split(`
`),[c,l]=t?.slice(1)||[],g=c?.split(":")[1]?.trim(),r=l?.split(":")[1]?.trim();return{displayName:o,type:g,activity:r}};function ne(){const{id:s}=R(),[i,o]=n.useState(""),[t,c]=n.useState(!1),[l,g]=n.useState(!1),{messages:r,isLoading:f}=H(),{isVideo:h,url:d}=$(r);n.useEffect(()=>{console.log("Background info:",{url:d,isVideo:h,messagesCount:r.length})},[d,h,r.length]);const v=E(r,D),y=P(v),{isFullscreen:k,toggleFullscreen:N}=O();if(n.useEffect(()=>{W().currentUser||V("Cast Viewer").catch(x=>{console.error("Anonymous login failed:",x)})},[s]),n.useEffect(()=>{const u=window.cast?.framework?.CastReceiverContext,x=navigator.userAgent,S=x.includes("CrKey")||x.includes("TV"),b=window.self!==window.top,j=u||S||window.location.search.includes("chromecast")||window.location.search.includes("receiver");return console.log("Cast detection:",{isCastEnvironment:!!u,isChromecast:S,isInIframe:b,searchParams:window.location.search,isActuallyCasting:j}),j&&(document.body.classList.add("cast-receiver-mode"),document.body.classList.remove("theme-light"),g(!0),console.log("Applied cast-receiver-mode class")),b&&(document.body.classList.add("in-iframe"),console.log("Applied in-iframe class")),()=>{j&&document.body.classList.remove("cast-receiver-mode"),b&&document.body.classList.remove("in-iframe")}},[]),n.useEffect(()=>{if(f)return;const u=r[r.length-1];u?.type==="settings"&&(c(!0),o(`${u.displayName} ${C("changedSettings")}`))},[r,f]),!v)return e.jsxs(m,{className:"flex-column",style:{backgroundColor:"transparent",color:"white",minHeight:"100vh"},children:[!!d&&e.jsx(A,{url:d,isVideo:h}),e.jsx(p,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"100vh"},children:e.jsx(p,{container:!0,justifyContent:"center",children:e.jsxs("div",{className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",textAlign:"center",width:"clamp(320px, 90vw, 1400px)",margin:"0 auto"},children:[e.jsxs(a,{variant:"h2",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"1rem",fontSize:"clamp(1.5rem, 6vw, 4rem)"},children:["blitzedout.com/",s]}),f?e.jsx(a,{variant:"h4",style:{color:"#90CAF9",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 4vw, 2.5rem)"},children:"Connecting to game..."}):e.jsx(a,{variant:"h4",style:{color:"#A5D6A7",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 4vw, 2.5rem)"},children:"Ready for game to start"})]})})})]});const{displayName:T,type:z,activity:w}=K(v);return e.jsxs(m,{className:"flex-column",style:{backgroundColor:"transparent",color:"white",minHeight:"100vh"},children:[!!d&&e.jsx(A,{url:d,isVideo:h}),e.jsxs(m,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(m,{flex:"1",children:!l&&!k&&e.jsx(B,{variant:"text",onClick:N,style:{color:"white"},children:C("fullscreen")})}),e.jsx(m,{textAlign:"center",flex:"1",children:!!y?.displayName&&e.jsx(a,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 3vw, 2rem)"},children:e.jsx(F,{i18nKey:"nextPlayersTurn",values:{player:y.displayName}})})},y?.displayName),e.jsx(m,{flex:"1",textAlign:"right",className:"text-stroke",children:w&&e.jsxs(a,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(0.8rem, 2.5vw, 1.5rem)"},children:["blitzedout.com/",s]})})]}),e.jsx(p,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"calc(100vh - 5rem)"},children:e.jsx(p,{container:!0,justifyContent:"center",children:w?e.jsxs(p,{size:12,className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",maxWidth:"95vw",minWidth:"fit-content",margin:"0 auto"},children:[e.jsx(a,{variant:"h3",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(1.2rem, 5vw, 3rem)"},children:`${z} ${C("for")} ${T}`}),e.jsx(m,{className:"divider",style:{marginTop:"-0.5rem",height:"0.5rem",backgroundColor:"white",border:"2px solid black"},children:e.jsx(L,{})}),e.jsx(a,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600,fontSize:"clamp(1.8rem, 8vw, 6rem)",lineHeight:1.2},children:w})]}):e.jsx("div",{className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",maxWidth:"95vw",minWidth:"fit-content",margin:"0 auto"},children:e.jsxs(a,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600,fontSize:"clamp(1.8rem, 8vw, 6rem)",lineHeight:1.2},children:["blitzedout.com/",s]})})})},r.length),e.jsx(I,{open:!!t,close:()=>c(!1),hideCloseButton:!0,children:e.jsx(a,{variant:"h5",style:{color:"white"},children:i})})]})}export{ne as default};
