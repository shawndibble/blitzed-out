import{r as d,az as p}from"./chunk-D2_qQxSg.js";import{h as f,o as g}from"../assets/index-BicJ8E66.js";import{u as y}from"./chunk-CahDYY_a.js";import{u as h}from"./chunk-Bo4_NF39.js";function S(t){const n=g(t,"actions","DESC");return[...new Map(n.map(a=>[a.uid,a])).values()]}function L(){const{user:t}=y(),{messages:n,isLoading:a}=h(),{onlineUsers:o}=f();return d.useMemo(()=>{if(a||!t)return[];const c=S(n);return Object.values(o).map(e=>{const s=c.find(i=>i.uid===e.uid)?.text,u=/(?:#)[\d]*(?=:)/gs;let r=0;if(s&&s.match(u)){const i=s.match(u);i&&i[0]&&(r=Number(i[0].replace("#","")))}const l=r>0?r-1:r,m=!!s?.includes(p("finish"));return{displayName:e.displayName||"Unknown",uid:e.uid,isSelf:e.uid===t.uid,location:e.gameState?.location||l,isFinished:e.gameState?.isFinished||m,status:e.status||"away",lastActivity:e.lastSeen||new Date(0)}}).sort((e,s)=>e.isSelf?-1:s.isSelf?1:e.status==="active"&&s.status!=="active"?-1:s.status==="active"&&e.status!=="active"?1:e.displayName.localeCompare(s.displayName))},[t,o,n,a])}export{L as u};
