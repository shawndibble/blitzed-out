import{a7 as U,ad as w,r as t,j as E}from"./chunk-u7ZaklyY.js";import{a as R}from"./chunk-CaZ9lMwi.js";import{u as S}from"./chunk-Bgbo4R2z.js";import"./chunk-C1hnJ-He.js";import"../assets/index-CVlHkNKo.js";import"./chunk-D4nXmTaT.js";(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"b0aec1b7336667c3da787da9b7139ec106644213"}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="16825557-318e-47ff-aa06-b9ef869d849b",n._sentryDebugIdIdentifier="sentry-dbid-16825557-318e-47ff-aa06-b9ef869d849b")})()}catch{}function v(n){if(!n||typeof n!="object")return!1;const e=n;return typeof e.displayName=="string"&&typeof e.uid=="string"&&(e.lastSeen instanceof Date||typeof e.lastSeen=="number"||typeof e.lastSeen=="string")}const h=U.createContext(void 0);function P(n){const{id:e}=w(),{onlineUsers:f,setUsers:a,setRoom:l,clearUsers:o,flushPendingUpdates:u}=S(),i=t.useRef(null),d=t.useRef(e),c=t.useCallback(p=>{if(p===null)o();else{const b={};Object.entries(p).forEach(([y,r])=>{if(v(r)){const m={...r,lastSeen:r.lastSeen instanceof Date?r.lastSeen:new Date(r.lastSeen)};b[y]=m}else console.warn(`Invalid user data for uid ${y}:`,r)}),a(b)}},[a,o]),s=t.useCallback(()=>{i.current&&(i.current(),i.current=null),u()},[u]);t.useEffect(()=>{if(d.current!==e&&(l(e||null),d.current=e),!e){s(),o();return}return s(),R(e,c),i.current=null,s},[e,l,o,c,s]),t.useEffect(()=>s,[s]);const g=t.useMemo(()=>({onlineUsers:f}),[f]);return E.jsx(h.Provider,{value:g,...n})}export{h as UserListContext,P as UserListProvider};
//# sourceMappingURL=userList.tsx-Bkh03yvz.js.map
