import{R as U,aj as v,r as t,j as E}from"./chunk-gLqOAnAo.js";import{A as w}from"./chunk-Ce3NdNab.js";import{u as S}from"./chunk-Cxiyhgvx.js";import"./chunk-D9KXFDlS.js";import"./chunk-DF6sfhGu.js";import"./chunk-DFT8axIh.js";(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};n.SENTRY_RELEASE={id:"ba7d3cfce23f41097f343c1a83f9f2db3c72f794"}})();try{(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="1940b608-a483-456d-9859-3ce9aa0541ca",n._sentryDebugIdIdentifier="sentry-dbid-1940b608-a483-456d-9859-3ce9aa0541ca")})()}catch(n){}function h(n){if(!n||typeof n!="object")return!1;const e=n;return typeof e.displayName=="string"&&typeof e.uid=="string"&&(e.lastSeen instanceof Date||typeof e.lastSeen=="number"||typeof e.lastSeen=="string")}const _=U.createContext(void 0);function P(n){const{id:e}=v(),{onlineUsers:l,setUsers:c,setRoom:d,clearUsers:a,flushPendingUpdates:p}=S(),i=t.useRef(null),b=t.useRef(e),u=t.useRef(()=>{});t.useEffect(()=>{u.current=r=>{if(r===null)a();else{const f={};Object.entries(r).forEach(([g,o])=>{if(h(o)){const R={...o,lastSeen:o.lastSeen instanceof Date?o.lastSeen:new Date(o.lastSeen)};f[g]=R}else console.warn(`Invalid user data for uid ${g}:`,o)}),c(f)}}},[c,a]);const y=t.useCallback(r=>{var f;(f=u.current)==null||f.call(u,r)},[]),s=t.useCallback(()=>{i.current&&(i.current(),i.current=null),p()},[p]);t.useEffect(()=>{if(b.current!==e&&(d(e||null),b.current=e),!e){s(),a();return}s();const r=w(e,y,l);return i.current=r||null,s},[e,d,a,y,s]),t.useEffect(()=>s,[s]);const m=t.useMemo(()=>({onlineUsers:l}),[l]);return E.jsx(_.Provider,{value:m,...n})}export{_ as UserListContext,P as UserListProvider};
//# sourceMappingURL=userList.tsx-CWf72k_f.js.map
