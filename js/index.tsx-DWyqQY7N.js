import{r as a,ad as z,au as w,j as e,am as m,ao as d,T as o,Q as R,ar as B,a1 as F}from"./chunk-DJZJtpVs.js";import{T as L}from"./chunk-9fkTg0gS.js";import{l as S}from"./chunk-gZbrz2vQ.js";import{b as H}from"./chunk-CtQs5dKM.js";import{p as I,u as M,R as C}from"./chunk-C96DKwZz.js";import{l as V}from"./chunk-DkIK5w_4.js";import{g as P}from"./chunk-B4ipE-Yx.js";import"./chunk-7OQk-BoX.js";import"./chunk-DEqUmdJg.js";import"../assets/index-fjMb4uzY.js";import"./chunk-DtF_b7C9.js";import"./chunk-B4PEA_xj.js";import"./chunk-yLOK5aTh.js";function $(s){const i=S(s,"room");let r=!1,t="";if(i){const{roomBackgroundURL:c}=JSON.parse(i.settings),n=I(c);n?.isVideo&&(r=n.isVideo),n?.url&&(t=n.url)}return["color","gray"].some(c=>t.includes(c))&&(t=""),{isVideo:r,url:t}}function O(){const[s,i]=a.useState(document.fullscreenElement!=null);a.useEffect(()=>{const t=()=>{i(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]);const r=a.useCallback(()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen().catch(t=>{console.error("Error attempting to enable fullscreen:",t)}):document.exitFullscreen().catch(t=>{console.error("Error attempting to exit fullscreen:",t)})},[]);return{isFullscreen:s,toggleFullscreen:r}}const D="actions",K=s=>{const{text:i,displayName:r}=s;if(!r)return{};const t=i?.split(`
`),[c,n]=t?.slice(1)||[],h=c?.split(":")[1]?.trim(),l=n?.split(":")[1]?.trim();return{displayName:r,type:h,activity:l}};function re(){const{id:s}=z(),[i,r]=a.useState(""),[t,c]=a.useState(!1),[n,h]=a.useState(!1),{messages:l,isLoading:g}=H(),{isVideo:b,url:p}=$(l),f=S(l,D),v=M(f),{isFullscreen:A,toggleFullscreen:N}=O();if(a.useEffect(()=>{P().currentUser||V("Cast Viewer").catch(x=>{console.error("Anonymous login failed:",x)})},[s]),a.useEffect(()=>{const u=window.cast?.framework?.CastReceiverContext,x=navigator.userAgent,T=x.includes("CrKey")||x.includes("TV"),j=u||T||window.location.search.includes("chromecast");return j&&(document.body.classList.add("cast-receiver-mode"),document.body.classList.remove("theme-light"),h(!0)),()=>{j&&document.body.classList.remove("cast-receiver-mode")}},[]),a.useEffect(()=>{if(g)return;const u=l[l.length-1];u?.type==="settings"&&(c(!0),r(`${u.displayName} ${w("changedSettings")}`))},[l,g]),!f)return e.jsxs(m,{className:"flex-column",style:{backgroundColor:"#000",color:"white",minHeight:"100vh"},children:[!!p&&e.jsx(C,{url:p,isVideo:b}),e.jsx(d,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"100vh"},children:e.jsx(d,{container:!0,justifyContent:"center",children:e.jsxs("div",{className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",textAlign:"center",width:"clamp(320px, 90vw, 1400px)",margin:"0 auto"},children:[e.jsxs(o,{variant:"h2",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"1rem",fontSize:"clamp(1.5rem, 6vw, 4rem)"},children:["blitzedout.com/",s]}),g?e.jsx(o,{variant:"h4",style:{color:"#90CAF9",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 4vw, 2.5rem)"},children:"Connecting to game..."}):e.jsx(o,{variant:"h4",style:{color:"#A5D6A7",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 4vw, 2.5rem)"},children:"Ready for game to start"})]})})})]});const{displayName:k,type:E,activity:y}=K(f);return e.jsxs(m,{className:"flex-column",style:{backgroundColor:n?"#000":"transparent",color:"white",minHeight:"100vh"},children:[!!p&&e.jsx(C,{url:p,isVideo:b}),e.jsxs(m,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(m,{flex:"1",children:!n&&!A&&e.jsx(R,{variant:"text",onClick:N,style:{color:"white"},children:w("fullscreen")})}),e.jsx(m,{textAlign:"center",flex:"1",children:!!v?.displayName&&e.jsx(o,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 3vw, 2rem)"},children:e.jsx(B,{i18nKey:"nextPlayersTurn",values:{player:v.displayName}})})},v?.displayName),e.jsx(m,{flex:"1",textAlign:"right",className:"text-stroke",children:y&&e.jsxs(o,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(0.8rem, 2.5vw, 1.5rem)"},children:["blitzedout.com/",s]})})]}),e.jsx(d,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"calc(100vh - 5rem)"},children:e.jsx(d,{container:!0,justifyContent:"center",children:y?e.jsxs(d,{size:12,className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",width:"clamp(320px, 90vw, 1400px)",margin:"0 auto"},children:[e.jsx(o,{variant:"h3",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(1.2rem, 5vw, 3rem)"},children:`${E} ${w("for")} ${k}`}),e.jsx(m,{className:"divider",style:{marginTop:"-0.5rem",height:"0.5rem",backgroundColor:"white",border:"2px solid black"},children:e.jsx(F,{})}),e.jsx(o,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600,fontSize:"clamp(1.8rem, 8vw, 6rem)",lineHeight:1.2},children:y})]}):e.jsx("div",{className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",width:"clamp(320px, 90vw, 1400px)",margin:"0 auto"},children:e.jsxs(o,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600,fontSize:"clamp(1.8rem, 8vw, 6rem)",lineHeight:1.2},children:["blitzedout.com/",s]})})})},l.length),e.jsx(L,{open:!!t,close:()=>c(!1),hideCloseButton:!0,children:e.jsx(o,{variant:"h5",style:{color:"white"},children:i})})]})}export{re as default};
