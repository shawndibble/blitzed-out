const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index.tsx-22QCbOlJ.js","js/chunk-DJZJtpVs.js","js/chunk-7OQk-BoX.js","js/chunk-9fkTg0gS.js","js/chunk-DEqUmdJg.js","js/chunk-CGbfZ7mk.js","js/chunk-B4PEA_xj.js","js/chunk-CsjAM9X4.js","assets/index-oY9PZqEo.js","js/schedule.tsx-ZMicmyxF.js","js/chunk-DaloJZLJ.js","js/chunk-B4ipE-Yx.js","js/theme.tsx-2WIj6fh0.js","js/chunk-iJ_-m3-G.js","js/chunk-BEKzMAkI.js","js/chunk-DtF_b7C9.js","js/index.tsx-D3ThYi9B.js","js/chunk-DjeJ_KZ7.js","js/chunk-C7uh7Oo9.js","js/chunk-yLOK5aTh.js","js/chunk-BR5RUHq6.js","js/chunk-DCfXBZKV.js","js/index.tsx-BbzYcVgX.js","js/chunk-HM8k9wFq.js"])))=>i.map(i=>d[i]);
import{_ as v}from"../assets/index-oY9PZqEo.js";import{a7 as M,E as R,K as B,r as a,ad as G,j as e,aE as E,au as T,I as b,ak as D,aF as U,G as $,M as q,aG as F,aH as W,B as H,aI as K,aJ as J,am as V,aK as Q,aC as X,at as Y,s as y,aL as Z,aM as ee,aN as se}from"./chunk-DJZJtpVs.js";import{ScheduleContext as te}from"./schedule.tsx-ZMicmyxF.js";import{e as oe,f as ne,g as N,D as re,h as ae,i as A,j as ie,k as ce,l as le}from"./chunk-DEqUmdJg.js";import{useTheme as de}from"./theme.tsx-2WIj6fh0.js";import{i as ue}from"./chunk-iJ_-m3-G.js";const ke={en:{label:"English",voice:"Google UK English Male"},es:{label:"Español",voice:"Google español de Estados Unidos"},fr:{label:"Français",voice:"Google français"},zh:{label:"中文",voice:"Google 中文（中国大陆）"},hi:{label:"हिन्दी",voice:"Google हिन्दी"}};function ge(){const s=M.useContext(te);if(!s)throw new Error("ScheduleContext's value is undefined.");return s}function he(s="sm"){const r=R();return B(r.breakpoints.down(s))}const me="/img/blitzed-out-DGhYHOgx.png";window.__castApiInitialized=window.__castApiInitialized||!1;window.__castScriptLoading=window.__castScriptLoading||!1;function fe(){const[s,r]=a.useState(!1),[l,i]=a.useState(null),{id:c}=G(),m=a.useRef(null),[h,x]=a.useState(!1),[S,C]=a.useState(!1),g=a.useCallback(n=>{try{const t=`${window.location.origin}/${c}/cast`;n.sendMessage("urn:x-cast:com.blitzedout.app",{type:"LOAD",url:t})}catch(t){console.error("Error sending cast message:",t)}},[c]);a.useEffect(()=>{const n=()=>{try{if(!window?.cast?.framework)return;if(window.__castApiInitialized){x(!0),t();return}window.cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:"1227B8DE",autoJoinPolicy:window.chrome?.cast?.AutoJoinPolicy?.ORIGIN_SCOPED}),window.__castApiInitialized=!0,x(!0),t()}catch(o){console.error("Error initializing Cast API:",o)}},t=()=>{try{const o=window.cast?.framework?.CastContext.getInstance();if(!o)return;const d=o.getCurrentSession();if(d&&(r(!0),i(d),c&&g(d)),!window?.cast?.framework)return;o.addEventListener(window.cast.framework.CastContextEventType.SESSION_STATE_CHANGED,p=>{console.log("🎭 Cast session state changed:",p.sessionState);const u=o.getCurrentSession();switch(console.log("🎭 Current session:",u?"exists":"null"),p.sessionState){case window.cast?.framework?.SessionState.SESSION_STARTED:case window.cast?.framework?.SessionState.SESSION_RESUMED:console.log("🎭 Cast session started/resumed - setting isCasting=true"),r(!0),i(u),u&&c&&g(u);break;case window.cast?.framework?.SessionState.SESSION_ENDED:console.log("🎭 Cast session ended - setting isCasting=false"),r(!1),i(null);break;default:p.sessionState==="SESSION_ENDING"?(console.log("🎭 Cast session ending - setting isCasting=false"),r(!1),i(null)):console.log("🎭 Unhandled session state:",p.sessionState);break}})}catch(o){console.error("Error setting up session listener:",o)}};if(window.chrome&&window.chrome.cast&&window.cast)n();else if(window.__onGCastApiAvailable=function(o){o&&n()},!document.querySelector('script[src*="cast_sender.js"]')&&!window.__castScriptLoading){window.__castScriptLoading=!0;const o=document.createElement("script");o.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",o.onload=()=>{window.__castScriptLoading=!1},o.onerror=()=>{window.__castScriptLoading=!1,console.error("Failed to load Cast SDK")},document.head.appendChild(o)}return()=>{}},[c,g]);const w=()=>{if(!h){console.warn("Cast API not ready yet");return}if(s){console.log("🛑 Stop casting button clicked"),C(!0),console.log("🛑 Immediately setting isCasting=false due to user request"),r(!1),i(null);try{const n=window.cast?.framework?.CastContext.getInstance();if(n){console.log("🛑 Calling castContext.endCurrentSession(true)");try{const t=n.endCurrentSession(!0);t&&typeof t.catch=="function"&&t.catch(o=>{console.error("🛑 Error ending session via context:",o)})}catch(t){console.error("🛑 Error calling endCurrentSession:",t)}}if(l){console.log("🛑 Calling castSession.endSession(true)");try{const t=l.endSession(!0);t&&typeof t.catch=="function"&&t.catch(o=>{console.error("🛑 Error ending session directly:",o)})}catch(t){console.error("🛑 Error calling endSession:",t)}}setTimeout(()=>{console.log("🛑 Clearing user stop flag"),C(!1)},3e3)}catch(n){console.error("🛑 Error stopping cast session:",n),C(!1)}}else try{const n=window.cast?.framework?.CastContext.getInstance();n&&n.requestSession().catch(t=>console.error("Error requesting cast session:",t))}catch(n){console.error("Error requesting cast session:",n)}};return a.useEffect(()=>{s&&l&&c&&g(l)},[c,s,l,g]),a.useEffect(()=>{if(!h)return;const n=()=>{try{const o=window.cast?.framework?.CastContext.getInstance();if(!o)return;const d=o.getCurrentSession(),p=d?d.getSessionState():"NO_SESSION",u=d&&(d.getSessionState()==="CONNECTED"||d.getSessionState()==="SESSION_STARTED");(s&&!u||!s&&u)&&console.log("🔍 Periodic check - isCasting:",s,"sessionState:",p,"hasActiveSession:",u),s&&!u?(console.log("🔧 Fixing state: was casting but no active session - setting isCasting=false"),r(!1),i(null)):!s&&u&&!S?(console.log("🔧 Fixing state: not casting but has active session - setting isCasting=true"),r(!0),i(d)):!s&&u&&S&&console.log("🔧 User requested stop but session still active - respecting user request")}catch(o){console.error("Error checking cast state:",o)}};n();const t=setInterval(n,5e3);return()=>clearInterval(t)},[h,s,S]),h?e.jsx(E,{title:s?T("stopCasting"):T("startCasting"),children:e.jsx(b,{ref:m,onClick:w,color:s?"primary":"default",children:s?e.jsx(oe,{}):e.jsx(ne,{})})}):null}const O={light:ae,dark:re,system:N},pe={light:"Light theme",dark:"Dark theme",system:"Follow system"};function xe({size:s="medium",variant:r="menu",tooltip:l,showLabels:i=!0,"aria-label":c}){const m=R(),{themeMode:h,resolvedThemeMode:x,setThemeMode:S,toggleTheme:C}=de(),{t:g}=D(),[w,n]=M.useState(null),t=!!w,d=h==="system"?N:O[x],p=()=>{r==="toggle"?C():n(null)},u=f=>{r==="menu"?n(f.currentTarget):p()},j=()=>{n(null)},P=f=>{S(f),j()},_=()=>l||(r==="toggle"?x==="light"?g("theme.switchToDark","Switch to dark theme"):g("theme.switchToLight","Switch to light theme"):g("theme.chooseTheme","Choose theme")),k=()=>c||(r==="toggle"?`Toggle theme, currently ${x}`:`Theme menu, currently ${h}`);return r==="toggle"?e.jsx(E,{title:_(),arrow:!0,children:e.jsx(b,{onClick:p,size:s,"aria-label":k(),sx:{transition:"all 0.3s ease","&:hover":{transform:"scale(1.1)",backgroundColor:"action.hover"},"& .MuiSvgIcon-root":{transition:"transform 0.3s ease"},"&:hover .MuiSvgIcon-root":{transform:"rotate(180deg)"}},children:e.jsx(d,{})})}):e.jsxs(e.Fragment,{children:[e.jsx(E,{title:_(),arrow:!0,children:e.jsx(b,{onClick:u,size:s,"aria-label":k(),"aria-controls":t?"theme-menu":void 0,"aria-haspopup":"true","aria-expanded":t?"true":void 0,sx:{transition:"all 0.3s ease",backgroundColor:t?"action.selected":"transparent","&:hover":{transform:"scale(1.05)",backgroundColor:"action.hover"},"& .MuiSvgIcon-root":{transition:"transform 0.3s ease"}},children:e.jsx(d,{})})}),e.jsx(U,{id:"theme-menu",anchorEl:w,open:t,onClose:j,TransitionComponent:$,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},PaperProps:{elevation:8,sx:{mt:1,minWidth:160,borderRadius:2,border:`1px solid ${m.palette.divider}`,"& .MuiMenuItem-root":{borderRadius:1,margin:"2px 4px",transition:"all 0.2s ease","&:hover":{backgroundColor:"action.hover",transform:"translateX(4px)"}}}},children:["light","dark","system"].map(f=>{const L=O[f],I=h===f;return e.jsxs(q,{onClick:()=>P(f),selected:I,sx:{fontWeight:I?600:400,backgroundColor:I?"action.selected":"transparent"},children:[e.jsx(F,{sx:{minWidth:36},children:e.jsx(L,{fontSize:"small",sx:{color:I?"primary.main":"text.secondary",transition:"color 0.2s ease"}})}),i&&e.jsx(W,{primary:g(`theme.${f}`,pe[f]),sx:{"& .MuiListItemText-primary":{fontSize:"0.875rem",color:I?"primary.main":"text.primary",transition:"color 0.2s ease"}}})]},f)})})]})}const z=a.forwardRef(({playerList:s,onClick:r,innerRef:l,...i},c)=>{const m=c||l;return r?e.jsxs(H,{...i,ref:m,onClick:r,sx:{display:"flex",alignItems:"center",borderRadius:1,px:.5,py:.25,minWidth:44,minHeight:44,color:"text.primary",fontSize:"inherit",fontWeight:500,"&:hover":{backgroundColor:"action.hover"},"&:focus":{backgroundColor:"action.focus"}},children:[e.jsx(A,{color:"success",sx:{fontSize:8,marginRight:"0.2rem"}}),s.length]}):e.jsxs("div",{...i,ref:m,style:{display:"flex",alignItems:"center",color:"var(--mui-palette-text-primary)",fontWeight:500},children:[e.jsx(A,{color:"success",sx:{fontSize:8,marginRight:"0.2rem"}}),s.length]})});z.displayName="PlayersOnline";const Se=a.lazy(()=>v(()=>import("./index.tsx-22QCbOlJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),Ce=a.lazy(()=>v(()=>import("./index.tsx-D3ThYi9B.js"),__vite__mapDeps([16,8,1,2,4,17,10,11,18,13,14,15,6,19,20,21,9,5,12]))),we=a.lazy(()=>v(()=>import("./index.tsx-BbzYcVgX.js"),__vite__mapDeps([22,1,2,23])));function Ie(){return e.jsx(Y,{size:16})}function Te({room:s,playerList:r=[]}){const{t:l}=D(),[i,c]=a.useState(!1),[m,h]=a.useState(!1),[x,S]=a.useState(!1),{schedule:C}=ge(),g=he(),w=a.useRef(null),n=()=>{c(!0),S(!0)},t=()=>{h(!m)},o=()=>{h(!1)};return e.jsx(K,{position:"fixed",children:e.jsxs(J,{disableGutters:!0,variant:"dense",component:"nav",className:"nav",children:[e.jsxs("div",{className:"site-name",children:[e.jsx(V,{component:"img",sx:{height:32},alt:"Blitzed Out Logo",src:me}),e.jsx("h1",{className:"gradient-text",children:"Blitzed Out"})]}),e.jsx("div",{children:e.jsxs("div",{className:"nav-room-name",children:[e.jsx("h2",{children:ue(s)||s===void 0?l("public"):s}),e.jsx(z,{playerList:r,onClick:t,ref:w,"aria-label":l("online"),"aria-expanded":m,"aria-haspopup":"dialog"}),e.jsx(b,{onClick:n,"aria-label":"schedule game",sx:{ml:2},children:e.jsx(Q,{color:"primary",badgeContent:x?null:C.length,children:e.jsx(ie,{})})}),i&&e.jsx(X,{children:e.jsx(a.Suspense,{fallback:e.jsx(Ie,{}),children:e.jsx(Se,{open:i,close:()=>c(!1),isMobile:g})})}),r.length>0&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(we,{isOpen:m,onClose:o,playerList:r,anchorEl:w.current})})]})}),e.jsxs("div",{className:"menu-drawer",children:[e.jsx(xe,{size:"medium",variant:"menu","aria-label":"Toggle theme menu - choose between light, dark, or system theme"}),e.jsx(fe,{}),e.jsx(a.Suspense,{fallback:null,children:e.jsx(Ce,{})})]})]})})}const Ae=y(s=>e.jsx(Z,{disableGutters:!0,elevation:0,square:!0,...s}))(({theme:s})=>({border:`1px solid ${s.palette.divider}`,"&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"}})),Oe=y(ee)(({theme:s})=>({padding:s.spacing(2),borderTop:`1px solid ${s.palette.divider}`})),Me=y(s=>e.jsx(se,{expandIcon:e.jsx(ce,{sx:{fontSize:"0.9rem"}}),...s}))(({theme:s})=>({backgroundColor:s.palette.mode==="dark"?"rgba(255, 255, 255, .05)":"rgba(148, 163, 184, .08)",flexDirection:"row-reverse","& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(90deg)"},"& .MuiAccordionSummary-content":{marginLeft:s.spacing(1)}}));function Re({close:s}){return e.jsx(b,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8},children:e.jsx(le,{})})}export{Ae as A,Re as C,Te as N,ge as a,Me as b,Oe as c,ke as l,he as u};
