import{j as e,ar as j,u as z,au as R,av as M,a$ as O,t as h,aw as m,a6 as E,aj as _e,b,S as Ke,a3 as w,X as Be,aP as X,at as C,aL as Ne,Q as We,O as Ve,ax as Ue,M as Ge,aZ as Ye,aV as He,b0 as qe,az as we,ay as Ce,aI as J,aK as Z,aJ as D,ae as Oe,W as Fe,h as Qe,b1 as Xe,b2 as Je,b3 as Ze,aq as De,a8 as et,aA as tt,aa as nt}from"./chunk-CVSdvP5Z.js";import{u as rt,C as st}from"./chunk-BeueL4UK.js";import{v as it,w as ot,H as lt,d as at,r as ee,T as ct}from"./chunk-_SwOSjSw.js";import{i as $,d as B}from"./chunk-guvQFVv-.js";import{b as dt}from"./chunk-CNqt7FHs.js";import{j as pt,r as ut,D as xt}from"./chunk-BVO8KFPS.js";import{L as ht,M as ke,Y as mt,G as gt}from"./chunk-DLsc9B5u.js";import{u as bt}from"./chunk-BO6dzI_Q.js";import{c as te,a as yt,b as ft}from"./chunk-U-BuBlCh.js";import{u as vt}from"./chunk-C9iFBQh5.js";import"./chunk-B-cyqPC2.js";import"./chunk-BUoOus3c.js";import"./chunk-E8HqAuJ1.js";import"../assets/index-CZH-e7F_.js";import"./chunk-AkXvan0D.js";import"./chunk-84IffDWI.js";import"./chunk-Pkb0UFv2.js";import"./chunk-9Rprt94M.js";import"./chunk-BmM2eEZX.js";(function(){var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};t.SENTRY_RELEASE={id:"874067a760cfa9079dd7f585e4ceff298b0e879f"}})();try{(function(){var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="e28a2b6e-6cda-4a09-827f-c00ed1b1715f",t._sentryDebugIdIdentifier="sentry-dbid-e28a2b6e-6cda-4a09-827f-c00ed1b1715f")})()}catch(t){}function N({children:t,justifyContent:n="space-evenly"}){return e.jsx(j,{sx:{mt:3,display:"flex",flexDirection:"row",justifyContent:n,alignItems:"center"},children:t})}function ne({isPublic:t,onClick:n,isSelected:r}){const{t:o}=z();return e.jsx(R,{sx:{cursor:"pointer",border:r?"3px solid":"1px solid",borderColor:r?"primary.main":"grey.300",backgroundColor:r?"primary.50":"background.paper",transform:r?"scale(1.02)":"scale(1)",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.main",boxShadow:r?4:2,transform:"scale(1.02)"}},onClick:n,children:e.jsx(M,{sx:{p:3},children:e.jsxs(O,{direction:"row",spacing:3,alignItems:"center",children:[e.jsx(j,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:56,height:56,borderRadius:"50%",backgroundColor:r?"primary.main":"primary.50",color:r?"primary.contrastText":"primary.main",transition:"all 0.2s ease-in-out"},children:t?e.jsx(it,{sx:{fontSize:28},"aria-label":"Public"}):e.jsx(ot,{sx:{fontSize:28},"aria-label":"Private"})}),e.jsxs(O,{spacing:.5,flex:1,children:[e.jsxs(O,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(h,{variant:"h6",component:"h3",sx:{fontWeight:600},children:e.jsx(m,{i18nKey:t?"public":"private"})}),r&&e.jsx(E,{label:o("selected"),size:"small",color:"primary",sx:{fontSize:"0.75rem",fontWeight:500,height:20}})]}),e.jsx(h,{variant:"body1",color:"text.secondary",sx:{fontSize:"0.95rem"},children:e.jsx(m,{i18nKey:t?"publicRoomBenefit":"privateRoomBenefit"})})]})]})})})}var jt=Object.defineProperty,St=Object.defineProperties,Pt=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable,se=(t,n,r)=>n in t?jt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,G=(t,n)=>{for(var r in n||(n={}))_t.call(n,r)&&se(t,r,n[r]);if(re)for(var r of re(n))wt.call(n,r)&&se(t,r,n[r]);return t},Y=(t,n)=>St(t,Pt(n)),H=(t,n,r)=>new Promise((o,i)=>{var s=u=>{try{c(r.next(u))}catch(a){i(a)}},d=u=>{try{c(r.throw(u))}catch(a){i(a)}},c=u=>u.done?o(u.value):Promise.resolve(u.value).then(s,d);c((r=r.apply(t,n)).next())});function Ct({formData:t,setFormData:n,nextStep:r}){var o;const{t:i}=z(),{id:s}=_e(),[d,c]=b.useState(!$(t.room||s)),[u,a]=b.useState(((o=t.room)==null?void 0:o.toUpperCase())||"");b.useEffect(()=>{const _=t.room||s,f=!$(_);c(f),a((_==null?void 0:_.toUpperCase())||"")},[s,t.room,d]);const p=_=>H(null,null,function*(){try{const f=pt(),P=ut(f,`rooms/${_}/uids`);return(yield xt(P)).exists()}catch(f){return!1}}),l=b.useCallback(()=>H(null,null,function*(){const _=dt("123456789ABCDEFGHJKLMNPQRSTUVWXYZ",5);let f,P=0;const k=10;do if(f=_(),P++,P>=k)break;while(yield p(f));return f}),[]),x=b.useCallback(()=>{n(Y(G({},t),{room:"PUBLIC",gameMode:"online",roomRealtime:!0})),c(!1)},[t,n]),S=b.useCallback(()=>H(null,null,function*(){const _=yield l();n(Y(G({},t),{room:_,gameMode:"online",roomRealtime:!1})),a(_.toUpperCase()),c(!0)}),[t,n,l]),v=b.useCallback(_=>{n(Y(G({},t),{room:_,boardUpdated:!0}))},[t,n]),g=b.useCallback(_=>{const f=_.target.value.toUpperCase();a(f)},[]),y=b.useCallback(()=>{v(u)},[v,u]),T=b.useCallback(_=>{_.key==="Enter"&&v(u)},[v,u]),A=$(t.room||s);function U(){r(A?3:1)}return e.jsxs(j,{sx:{m:1},children:[e.jsx(h,{variant:"h5",gutterBottom:!0,textAlign:"center",children:e.jsx(m,{i18nKey:"chooseRoomType"})}),e.jsx(h,{variant:"body1",color:"text.secondary",textAlign:"center",sx:{mb:3},children:e.jsx(m,{i18nKey:"roomTypeDescription"})}),e.jsxs(O,{spacing:2,sx:{mb:3},children:[e.jsx(ne,{isPublic:!0,onClick:x,isSelected:A}),e.jsx(ne,{isPublic:!1,onClick:S,isSelected:!A})]}),d&&e.jsxs(j,{sx:{p:3,borderRadius:2,backgroundColor:"primary.50",mb:2},children:[e.jsx(h,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:i("privateRoomCode")}),e.jsx(Ke,{fullWidth:!0,id:"privateRoom",value:u,onBlur:y,onKeyDown:T,onChange:g,inputProps:{style:{textTransform:"uppercase",fontFamily:"monospace",fontSize:"1.25rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.2em"}},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper","& fieldset":{borderColor:"divider",borderWidth:2},"&:hover fieldset":{borderColor:"primary.main"},"&.Mui-focused fieldset":{borderColor:"primary.main",borderWidth:2}}}}),e.jsx(h,{variant:"body2",color:"text.secondary",sx:{mt:1.5,textAlign:"center"},children:i("privateRoomCodeHelp")})]}),e.jsx(N,{children:e.jsx(w,{variant:"contained",onClick:U,size:"large",children:e.jsx(m,{i18nKey:"next"})})})]})}var Ot=Object.defineProperty,kt=Object.defineProperties,It=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,At=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable,oe=(t,n,r)=>n in t?Ot(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,le=(t,n)=>{for(var r in n||(n={}))At.call(n,r)&&oe(t,r,n[r]);if(ie)for(var r of ie(n))$t.call(n,r)&&oe(t,r,n[r]);return t},ae=(t,n)=>kt(t,It(n)),Rt=(t,n,r)=>new Promise((o,i)=>{var s=u=>{try{c(r.next(u))}catch(a){i(a)}},d=u=>{try{c(r.throw(u))}catch(a){i(a)}},c=u=>u.done?o(u.value):Promise.resolve(u.value).then(s,d);c((r=r.apply(t,n)).next())});function Mt({formData:t,setFormData:n,nextStep:r,prevStep:o}){const{t:i}=z(),{hasLocalPlayers:s,clearLocalSession:d}=bt(),[c,u]=b.useState(!1),[a,p]=b.useState(null),l=t.room!=="PUBLIC",x=b.useCallback(()=>{u(!0),p(null)},[]),S=b.useCallback(()=>{s&&d(),n(y=>ae(le({},y),{hasLocalPlayers:!1,localPlayersData:void 0,localPlayerSessionSettings:void 0,gameMode:y.gameMode==="local"?"online":y.gameMode})),r()},[s,d,r,n]),v=b.useCallback((y,T)=>Rt(null,null,function*(){try{n(ae(le({},t),{localPlayersData:y,localPlayerSessionSettings:T,hasLocalPlayers:!0})),u(!1),r()}catch(A){p(A instanceof Error?A.message:"Failed to save local player configuration")}}),[t,n,r]),g=b.useCallback(()=>{u(!1),p(null)},[]);return b.useEffect(()=>{if(!l){const y=setTimeout(()=>{r()},100);return()=>clearTimeout(y)}},[l,r]),l?c?e.jsx(Be,{in:!0,children:e.jsxs(j,{children:[a&&e.jsx(X,{severity:"error",sx:{mb:2},children:a}),e.jsx(ht,{roomId:t.room||"PRIVATE",isPrivateRoom:l,onComplete:v,onCancel:g,initialPlayers:t.localPlayersData,initialSettings:t.localPlayerSessionSettings})]})}):e.jsxs(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[e.jsx(h,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(m,{i18nKey:"localPlayersStep.title"})}),e.jsx(h,{variant:"body1",color:"text.secondary",sx:{mb:3},children:e.jsx(m,{i18nKey:"localPlayersStep.subtitle"})}),e.jsxs(C,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(C,{size:{xs:12,sm:6},children:e.jsx(R,{sx:{cursor:"pointer",border:"1px solid",borderColor:"divider",backgroundColor:"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:x,children:e.jsx(M,{sx:{p:3},children:e.jsxs(O,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(h,{variant:"h6",sx:{fontWeight:600},children:e.jsx(m,{i18nKey:"localPlayersStep.setupOption.title"})}),e.jsx(h,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-line",textAlign:"left",width:"100%",lineHeight:1.8,mb:2},children:e.jsx(m,{i18nKey:"localPlayersStep.setupOption.description"})}),e.jsx(w,{variant:"outlined",fullWidth:!0,size:"large",sx:{mt:2},"data-testid":"localPlayersStep.setupOption.button",onClick:x,children:i("localPlayersStep.setupOption.button")})]})})})}),e.jsx(C,{size:{xs:12,sm:6},children:e.jsx(R,{sx:{cursor:"pointer",border:"1px solid",borderColor:"divider",backgroundColor:"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:S,children:e.jsx(M,{sx:{p:3},children:e.jsxs(O,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(h,{variant:"h6",sx:{fontWeight:600},children:e.jsx(m,{i18nKey:"localPlayersStep.skipOption.title"})}),e.jsx(h,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-line",textAlign:"left",width:"100%",lineHeight:1.8,mb:2},children:e.jsx(m,{i18nKey:"localPlayersStep.skipOption.description"})}),e.jsx(w,{variant:"outlined",fullWidth:!0,size:"large",sx:{mt:2},"data-testid":"localPlayersStep.skipOption.button",onClick:S,children:i("localPlayersStep.skipOption.button")})]})})})})]}),s&&e.jsx(X,{severity:"info",sx:{mb:3},children:e.jsx(h,{variant:"body2",children:e.jsx(m,{i18nKey:"localPlayersStep.currentStatus.hasPlayers"})})}),e.jsx(j,{sx:{flexGrow:1}}),e.jsxs(N,{children:[e.jsx(w,{onClick:o,children:e.jsx(m,{i18nKey:"previous"})}),e.jsx(w,{variant:"contained",onClick:S,children:e.jsx(m,{i18nKey:"skip"})})]})]}):e.jsx(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:e.jsx(h,{variant:"h6",color:"text.secondary",children:i("localPlayersStep.publicRoomMessage","Local players are not available for public rooms. Continuing...")})})}var Et=Object.defineProperty,zt=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,ce=Object.getOwnPropertySymbols,Lt=Object.prototype.hasOwnProperty,Kt=Object.prototype.propertyIsEnumerable,de=(t,n,r)=>n in t?Et(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,L=(t,n)=>{for(var r in n||(n={}))Lt.call(n,r)&&de(t,r,n[r]);if(ce)for(var r of ce(n))Kt.call(n,r)&&de(t,r,n[r]);return t},K=(t,n)=>zt(t,Tt(n));function Bt({formData:t,setFormData:n,nextStep:r,prevStep:o}){const{t:i}=z(),s=!!t.hasLocalPlayers;b.useEffect(()=>{s&&n(l=>K(L({},l),{gameMode:"local",roomRealtime:!1}))},[s,n]);const[d,c]=b.useState(!B(t==null?void 0:t.gameMode)&&!s);b.useEffect(()=>{c(!B(t==null?void 0:t.gameMode)&&!s)},[t==null?void 0:t.gameMode,s]);const u=[{id:"local",title:"yesInteracting",description:i("physicalInteractionDesc"),isSelected:!B(t==null?void 0:t.gameMode)},{id:"online",title:"noInteracting",description:i("soloOnlinePlayDesc"),isSelected:B(t==null?void 0:t.gameMode)}],a=[{value:"dom",label:"Dominant",description:i("dominantRoleDesc")},{value:"vers",label:"Switch",description:i("switchRoleDesc")},{value:"sub",label:"Submissive",description:i("submissiveRoleDesc")}],p=[{id:"clothed",title:"noNaked",description:i("foreplayClothedDesc"),isSelected:!t.isNaked},{id:"naked",title:"yesNaked",description:i("intimateNudityDesc"),isSelected:t.isNaked}];return e.jsxs(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[!s&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(m,{i18nKey:"playingWithPeople"})}),e.jsx(C,{container:!0,spacing:2,sx:{mb:3},children:u.map(l=>e.jsx(C,{size:{xs:12,sm:6},children:e.jsx(R,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:l.isSelected?"3px solid":"1px solid",borderColor:l.isSelected?"primary.main":"divider",backgroundColor:l.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>n(K(L({},t),{gameMode:l.id==="local"?"local":"online",roomRealtime:l.id!=="local"})),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),n(K(L({},t),{gameMode:l.id==="local"?"local":"online",roomRealtime:l.id!=="local"})))},children:e.jsx(M,{sx:{p:3},children:e.jsxs(O,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(h,{variant:"h6",sx:{fontWeight:600},children:i(l.title)}),e.jsx(h,{variant:"body2",color:"text.secondary",children:l.description}),l.isSelected&&e.jsx(E,{label:i("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},l.id))})]}),s&&e.jsx(h,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(m,{i18nKey:"gameModeSelection"})}),d&&e.jsxs(j,{sx:{mb:3},children:[e.jsx(h,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:e.jsx(m,{i18nKey:"yourRole"})}),e.jsx(C,{container:!0,spacing:2,sx:{mb:3},children:a.map(l=>e.jsx(C,{size:{xs:12,sm:4},children:e.jsx(R,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:t.role===l.value?"2px solid":"1px solid",borderColor:t.role===l.value?"primary.main":"divider",backgroundColor:t.role===l.value?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>n(K(L({},t),{role:l.value})),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),n(K(L({},t),{role:l.value})))},children:e.jsx(M,{sx:{p:2.5},children:e.jsxs(O,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(h,{variant:"subtitle1",sx:{fontWeight:600},children:i(l.value)}),e.jsx(h,{variant:"body2",color:"text.secondary",children:l.description}),t.role===l.value&&e.jsx(E,{label:i("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},l.value))})]}),!B(t==null?void 0:t.gameMode)&&e.jsxs(j,{sx:{mb:3},children:[e.jsx(h,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:e.jsx(m,{i18nKey:"areYouNaked"})}),e.jsx(C,{container:!0,spacing:2,children:p.map(l=>e.jsx(C,{size:{xs:12,sm:6},children:e.jsx(R,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:l.isSelected?"2px solid":"1px solid",borderColor:l.isSelected?"primary.main":"divider",backgroundColor:l.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>n(K(L({},t),{isNaked:l.id==="naked"})),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),n(K(L({},t),{isNaked:l.id==="naked"})))},children:e.jsx(M,{sx:{p:3},children:e.jsxs(O,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(h,{variant:"h6",sx:{fontWeight:600},children:i(l.title)}),e.jsx(h,{variant:"body2",color:"text.secondary",children:l.description}),l.isSelected&&e.jsx(E,{label:i("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},l.id))})]}),e.jsx(j,{sx:{flexGrow:1}}),e.jsxs(N,{children:[e.jsx(w,{onClick:o,children:e.jsx(m,{i18nKey:"previous"})}),e.jsx(w,{variant:"contained",onClick:r,children:e.jsx(m,{i18nKey:"next"})})]})]})}var Nt=Object.defineProperty,Wt=Object.defineProperties,Vt=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable,ue=(t,n,r)=>n in t?Nt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,I=(t,n)=>{for(var r in n||(n={}))Ut.call(n,r)&&ue(t,r,n[r]);if(pe)for(var r of pe(n))Gt.call(n,r)&&ue(t,r,n[r]);return t},V=(t,n)=>Wt(t,Vt(n));const Yt=(t,n)=>{const{gameMode:r,isNaked:o}=t,i=B(r);return i&&["foreplay","sex"].includes(n.type)||!i&&o&&["solo","foreplay"].includes(n.type)||!i&&!o&&["solo","sex"].includes(n.type)},Ht=t=>{const n=I({},t),r=t.selectedActions||{},o={};return Object.entries(r).forEach(([i,s])=>{Yt(t,s)||(o[i]=s)}),n.selectedActions=o,n},Ie=(t,n,r)=>{const o=t.selectedActions||{};return Object.entries(o).map(([i,s])=>{const d=n.find(c=>c.value===i);return s.type!==r||!d?null:i}).filter(i=>!!i)},qt=(t,n,r)=>{const o=I({},t),i=I({},o.selectedActions);return Object.keys(i).forEach(s=>{i[s].type===n&&!r.includes(s)&&delete i[s]}),o.selectedActions=i,o},Ae=(t,n,r)=>{r(o=>{const i=qt(o,n,t),s=I({},i.selectedActions);return t.forEach(d=>{if(s[d])return;let c={type:n,levels:[1]};n==="consumption"&&(c=V(I({},c),{variation:i.isAppend?"appendMost":"standalone"})),s[d]=c}),V(I({},i),{selectedActions:s})})},$e=(t,n,r,o,i=null)=>{o(s=>{const d=I({},s.selectedActions||{});return t.length===0?delete d[n]:d[n]=I(V(I({},d[n]||{}),{type:r,levels:t}),!!i&&{variation:i}),V(I({},s),{selectedActions:d})})},Ft=t=>!!(t&&Object.keys(t).some(n=>{const r=t[n];return(r==null?void 0:r.levels)&&r.levels.length>0&&(r==null?void 0:r.variation)!=="appendMost"}));function Re(){return e.jsxs(h,{variant:"h6",sx:{mt:2},children:[e.jsx(m,{i18nKey:"setIntensityLevel"}),e.jsx(Ne,{title:e.jsx(h,{variant:"body1",children:e.jsx(m,{i18nKey:"intensityTooltip"})}),arrow:!0,sx:{ml:1},children:e.jsx(lt,{sx:{ml:.5,fontSize:15}})})]})}function Me({onChange:t,values:n,options:r,label:o}){const i=b.useCallback(d=>{var c;return(c=r==null?void 0:r.find(u=>u.value===d))==null?void 0:c.label},[r]),s=b.useCallback(d=>e.jsx(j,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:d==null?void 0:d.map(c=>e.jsx(E,{label:i(c)},c))}),[i]);return e.jsxs(We,{fullWidth:!0,children:[e.jsx(Ve,{id:`${o}-label`,children:o}),e.jsx(Ue,{labelId:`${o}-label`,id:`${o}`,multiple:!0,value:n,onChange:t,fullWidth:!0,input:e.jsx(qe,{label:e.jsx(m,{i18nKey:"actionsLabel"})}),renderValue:s,children:r==null?void 0:r.map(({label:d,value:c})=>e.jsxs(Ge,{value:c,children:[e.jsx(Ye,{checked:n.includes(c)}),e.jsx(He,{primary:d})]},c))})]})}const Qt=4,Xt=t=>B(t==null?void 0:t.gameMode)?"solo":t.isNaked?"sex":"foreplay";function Jt({formData:t,setFormData:n,options:r,actionsList:o}){const i=Xt(t),s=r(i),c=Ie(t,s,i)||[],u=a=>{const{value:p}=a.target,l=typeof p=="string"?p.split(","):p;l.length<=Qt&&Ae(l,i,n)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"h6",sx:{my:2},children:e.jsx(m,{i18nKey:"pickActions"})}),e.jsx(Me,{onChange:u,values:c,options:s,label:we("actionsLabel")}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{}),c.map(a=>{var p,l;const x=o[a],S=x!=null&&x.intensities?Object.keys(x.intensities).map(Number).filter(g=>g>0).sort((g,y)=>g-y):[1,2,3,4],v=((l=(p=t.selectedActions)==null?void 0:p[a])==null?void 0:l.levels)||[];return e.jsx(ke,{actionName:a,actionLabel:(x==null?void 0:x.label)||a,selectedLevels:v,availableLevels:S,intensityNames:(x==null?void 0:x.intensities)||{},onChange:g=>$e(g,a,i,n)},a)})]})]})}var Zt=Object.defineProperty,Dt=Object.defineProperties,en=Object.getOwnPropertyDescriptors,xe=Object.getOwnPropertySymbols,tn=Object.prototype.hasOwnProperty,nn=Object.prototype.propertyIsEnumerable,he=(t,n,r)=>n in t?Zt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,q=(t,n)=>{for(var r in n||(n={}))tn.call(n,r)&&he(t,r,n[r]);if(xe)for(var r of xe(n))nn.call(n,r)&&he(t,r,n[r]);return t},me=(t,n)=>Dt(t,en(n));const rn=2;function sn({formData:t,setFormData:n,options:r,actionsList:o}){const i="consumption",s=r(i),c=Ie(t,s,i)||[],u=p=>{const{value:l}=p.target,x=typeof l=="string"?l.split(","):l;x.length<=rn&&Ae(x,i,n)},a=(p,l)=>{const x=p.target.checked?"appendMost":"standalone",S=p.target.checked,v=q({},t.selectedActions);l.forEach(y=>{v[y]&&(v[y]=me(q({},v[y]),{variation:x}))});const g=me(q({},t),{isAppend:S,selectedActions:v});n(g)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"h6",sx:{my:2},children:e.jsx(m,{i18nKey:"pickConsumptions"})}),e.jsx(Me,{onChange:u,values:c,options:s,label:we("consumables")}),!!c.length&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{}),c.map(p=>{var l,x;const S=o[p],v=S!=null&&S.intensities?Object.keys(S.intensities).map(Number).filter(y=>y>0).sort((y,T)=>y-T):[1,2,3,4],g=((x=(l=t.selectedActions)==null?void 0:l[p])==null?void 0:x.levels)||[];return e.jsx(ke,{actionName:p,actionLabel:(S==null?void 0:S.label)||p,selectedLevels:g,availableLevels:v,intensityNames:(S==null?void 0:S.intensities)||{},onChange:y=>$e(y,p,i,n,t.isAppend?"appendMost":"standalone")},p)}),e.jsx(h,{variant:"h6",sx:{mt:2},children:e.jsx(m,{i18nKey:"standaloneOrCombine"})}),e.jsx(mt,{trueCondition:t.isAppend,onChange:p=>a(p,c),yesLabel:"combineWithActions"})]})]})}function on({gameMode:t,onPresetSelect:n,selectedPreset:r,actionsList:o,showTitle:i=!0}){const{t:s}=z(),d={solo:[{id:"popperbating",name:s("presetPopperbating"),description:s("presetPopperbatingDesc"),actions:["bating"],consumptions:["poppers"],intensities:{bating:2,poppers:1}},{id:"smoking-tits",name:s("presetSmokingTits"),description:s("presetSmokingTitsDesc"),actions:["titTorture"],consumptions:["vaping"],intensities:{titTorture:2,vaping:1}},{id:"exploration-solo",name:s("presetExplorationSolo"),description:s("presetExplorationSoloDesc"),actions:["throatTraining","buttPlay","titTorture","ballBusting"],consumptions:[],intensities:{throatTraining:1,buttPlay:1,titTorture:1,ballBusting:1}},{id:"ball-busting",name:s("presetBallBusting"),description:s("presetBallBustingDesc"),actions:["ballBusting","bating"],consumptions:["poppers"],intensities:{ballBusting:2,bating:2}}],foreplay:[{id:"romantic-start",name:s("presetRomanticStart"),description:s("presetRomanticStartDesc"),actions:["kissing","stripping"],consumptions:["alcohol"],intensities:{kissing:2,stripping:1,alcohol:1}},{id:"degrading",name:s("presetDegrading"),description:s("presetDegradingDesc"),actions:["humiliation","footPlay","breathPlay"],consumptions:["poppers"],intensities:{humiliation:2,footPlay:2,breathPlay:2,poppers:2}},{id:"sensual-touch",name:s("presetSensualTouch"),description:s("presetSensualTouchDesc"),actions:["kissing","footPlay","tickling"],consumptions:[],intensities:{kissing:2,footPlay:1,tickling:1}},{id:"electric-play",name:s("presetElectricPlay"),description:s("presetElectricPlayDesc"),actions:["electric","bondage"],consumptions:["vaping"],intensities:{electric:1,bondage:2,vaping:1}}],sex:[{id:"gentle-sex",name:s("presetGentleSex"),description:s("presetGentleSexDesc"),actions:["throatTraining","bating","buttPlay"],consumptions:["alcohol"],intensities:{throatTraining:1,bating:1,buttPlay:1,alcohol:1}},{id:"fisting",name:s("presetFisting"),description:s("presetFistingDesc"),actions:["buttPlay"],consumptions:["poppers"],intensities:{buttPlay:4,poppers:4}},{id:"bdsm",name:s("presetBdsm"),description:s("presetBdsmDesc"),actions:["pissPlay","throatTraining","spanking","titTorture"],consumptions:[],intensities:{pissPlay:2,throatTraining:2,spanking:2,titTorture:2}},{id:"breath-control",name:s("presetBreathControl"),description:s("presetBreathControlDesc"),actions:["bating"],consumptions:["gasMask"],intensities:{bating:2,gasMask:2}}]},c=d[t]||d.solo,u=a=>{n(a)};return e.jsxs(j,{children:[i&&e.jsx(h,{variant:"h6",gutterBottom:!0,children:s("quickStart")}),e.jsx(C,{container:!0,spacing:2,children:c.map(a=>e.jsx(C,{size:{xs:12,sm:6,lg:3},children:e.jsx(R,{sx:{cursor:"pointer",border:r===a.id?2:1,borderColor:r===a.id?"primary.main":"divider",backgroundColor:r===a.id?"primary.dark":"background.paper",transition:"all 0.2s ease-in-out",height:"100%",boxShadow:1,"&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:3,backgroundColor:r===a.id?"primary.dark":"action.hover"}},onClick:()=>u(a),children:e.jsxs(M,{sx:{p:2.5},children:[e.jsx(h,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:a.name}),e.jsxs(j,{children:[a.actions.map((p,l)=>{var x;return e.jsx(E,{label:((x=o[p])==null?void 0:x.label)||p,size:"small",variant:"outlined",sx:{mr:.5,mb:.5,borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"primary.50"}}},`action-${l}`)}),a.consumptions.map((p,l)=>{var x;return e.jsx(E,{label:((x=o[p])==null?void 0:x.label)||p,size:"small",color:"secondary",variant:"outlined",sx:{mr:.5,mb:.5,borderColor:"secondary.main",color:"secondary.main","&:hover":{backgroundColor:"secondary.50"}}},`consumption-${l}`)})]})]})})},a.id))})]})}var ln=Object.defineProperty,an=Object.defineProperties,cn=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertySymbols,dn=Object.prototype.hasOwnProperty,pn=Object.prototype.propertyIsEnumerable,be=(t,n,r)=>n in t?ln(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,un=(t,n)=>{for(var r in n||(n={}))dn.call(n,r)&&be(t,r,n[r]);if(ge)for(var r of ge(n))pn.call(n,r)&&be(t,r,n[r]);return t},xn=(t,n)=>an(t,cn(n));function hn({formData:t,setFormData:n,nextStep:r,prevStep:o,actionsList:i,isActionsLoading:s=!1}){const{t:d}=z(),[c,u]=b.useState(""),[a,p]=b.useState(!1),[l,x]=b.useState(!0);function S(f){return Object.keys(i).filter(P=>{var k;return((k=i[P])==null?void 0:k.type)===f})}b.useEffect(()=>{const f=Ht(t);n(f)},[]),b.useEffect(()=>{t.selectedActions&&Object.keys(t.selectedActions).length>0&&(p(!0),x(!1))},[]);const v=f=>S(f).map(P=>{var k;return{value:P,label:(k=i[P])==null?void 0:k.label}});let g;t.gameMode==="online"?g="solo":t.gameMode==="local"&&!t.isNaked?g="foreplay":g="sex";const y=(f,P,k,Ee)=>{f.forEach(W=>{var F;if(i[W]){const ze=((F=k.intensities)==null?void 0:F[W])||P,Te=Object.keys(i[W].intensities||{}).filter(Q=>Q!=="None").length;Ee[W]={type:i[W].type,levels:Array.from({length:Math.min(ze,Te)},(Q,Le)=>Le+1)}}})},T=f=>{u(f.id);const P={};y(f.actions,2,f,P),y(f.consumptions,1,f,P),n(xn(un({},t),{selectedActions:P})),x(!1),p(!0)},A=(f,P)=>{x(P),P&&p(!1)},U=(f,P)=>{p(P),P&&x(!1)},_=!Ft(t.selectedActions);return s?e.jsxs(j,{children:[e.jsxs(j,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,gap:2},children:[e.jsx(Ce,{size:48}),e.jsx(h,{variant:"h6",color:"text.secondary",children:d("loadingAvailableActions")})]}),e.jsx(j,{sx:{mt:4},children:e.jsxs(N,{children:[e.jsx(w,{disabled:!0,children:e.jsx(m,{i18nKey:"previous"})}),e.jsx(w,{variant:"contained",disabled:!0,size:"large",children:e.jsx(m,{i18nKey:"next"})})]})})]}):e.jsxs(j,{children:[e.jsxs(J,{expanded:l,onChange:A,sx:{backgroundColor:"background.default",borderTop:1,borderBottom:1,borderColor:"divider",borderLeft:"none",borderRight:"none",borderRadius:0,"&:before":{display:"none"},boxShadow:"none"},children:[e.jsx(Z,{expandIcon:e.jsx(ee,{}),"aria-controls":"quickstart-content",id:"quickstart-header",sx:{backgroundColor:"background.default"},children:e.jsxs(O,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(at,{}),e.jsx(h,{variant:"h6",children:d("quickStart")})]})}),e.jsx(D,{sx:{pb:1},children:e.jsx(on,{gameMode:g,onPresetSelect:T,selectedPreset:c,actionsList:i,showTitle:!1})})]}),e.jsxs(J,{expanded:a,onChange:U,sx:{backgroundColor:"background.default",borderTop:l?"none":1,borderBottom:1,borderColor:"divider",borderLeft:"none",borderRight:"none",borderRadius:0,marginTop:l?-1:0,"&:before":{display:"none"},boxShadow:"none"},children:[e.jsx(Z,{expandIcon:e.jsx(ee,{}),"aria-controls":"customization-content",id:"customization-header",sx:{backgroundColor:"background.default"},children:e.jsxs(O,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ct,{}),e.jsx(h,{variant:"h6",children:d("customizeActions")})]})}),e.jsxs(D,{children:[e.jsx(h,{variant:"body2",color:"text.secondary",sx:{mb:2},children:d("customizeActionsDesc")}),e.jsx(Jt,{formData:t,setFormData:n,options:v,actionsList:i}),e.jsx(Oe,{sx:{my:3}}),e.jsx(sn,{formData:t,setFormData:n,options:v,actionsList:i})]})]}),e.jsx(j,{sx:{mt:4},children:e.jsxs(N,{children:[e.jsx(w,{onClick:()=>o($(t.room)?3:1),children:e.jsx(m,{i18nKey:"previous"})}),e.jsx(w,{variant:"contained",disabled:_,onClick:r,size:"large",children:e.jsx(m,{i18nKey:"next"})})]})})]})}var mn=Object.defineProperty,gn=Object.defineProperties,bn=Object.getOwnPropertyDescriptors,ye=Object.getOwnPropertySymbols,yn=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable,fe=(t,n,r)=>n in t?mn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,ve=(t,n)=>{for(var r in n||(n={}))yn.call(n,r)&&fe(t,r,n[r]);if(ye)for(var r of ye(n))fn.call(n,r)&&fe(t,r,n[r]);return t},je=(t,n)=>gn(t,bn(n)),vn=(t,n,r)=>new Promise((o,i)=>{var s=u=>{try{c(r.next(u))}catch(a){i(a)}},d=u=>{try{c(r.throw(u))}catch(a){i(a)}},c=u=>u.done?o(u.value):Promise.resolve(u.value).then(s,d);c((r=r.apply(t,n)).next())});function jn({formData:t,setFormData:n,prevStep:r,actionsList:o,close:i}){const s=[100,100],d=[0,0],[c,u]=b.useState(te((t==null?void 0:t.finishRange)||[],d)),[a,p]=b.useState(!1),l=yt(),{t:x}=z();b.useEffect(()=>{let g=je(ve({},t),{boardUpdated:!0});(!c||!te(t.finishRange||[],s))&&(g.finishRange=s),n(g)},[]);function S(){return vn(this,null,function*(){p(!0);try{yield l(t,o)}catch(g){console.error("Error submitting settings:",g)}finally{p(!1)}typeof i=="function"&&i()})}const v=[{id:"noOrgasm",title:"noOrgasm",description:x("noOrgasmDesc"),isSelected:!c},{id:"yesOrgasm",title:"yesOrgasm",description:x("yesOrgasmDesc"),isSelected:c}];return e.jsxs(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[e.jsx(h,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(m,{i18nKey:"WillYouOrgasm"})}),e.jsx(C,{container:!0,spacing:2,sx:{mb:4},children:v.map(g=>e.jsx(C,{size:{xs:12,sm:6},children:e.jsx(R,{sx:{cursor:"pointer",border:g.isSelected?"3px solid":"1px solid",borderColor:g.isSelected?"primary.main":"divider",backgroundColor:g.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%",transform:g.isSelected?"scale(1.02)":"scale(1)","&:hover":{borderColor:"primary.main",transform:"scale(1.02)",boxShadow:2}},onClick:()=>{const y=g.id==="yesOrgasm";n(je(ve({},t),{finishRange:y?d:s})),u(y)},children:e.jsx(M,{sx:{p:3},children:e.jsxs(O,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(h,{variant:"h6",sx:{fontWeight:600},children:x(g.title)}),e.jsx(h,{variant:"body2",color:"text.secondary",children:g.description}),g.isSelected&&e.jsx(E,{label:x("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},g.id))}),e.jsx(j,{sx:{flexGrow:1}}),e.jsxs(N,{children:[e.jsx(w,{onClick:r,disabled:a,children:e.jsx(m,{i18nKey:"previous"})}),e.jsx(w,{variant:"contained",onClick:S,disabled:a,startIcon:a?e.jsx(Ce,{size:20}):null,size:"large",sx:{px:4},children:e.jsx(m,{i18nKey:"buildGame"})})]})]})}var Sn=Object.defineProperty,Se=Object.getOwnPropertySymbols,Pn=Object.prototype.hasOwnProperty,_n=Object.prototype.propertyIsEnumerable,Pe=(t,n,r)=>n in t?Sn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,wn=(t,n)=>{for(var r in n||(n={}))Pn.call(n,r)&&Pe(t,r,n[r]);if(Se)for(var r of Se(n))_n.call(n,r)&&Pe(t,r,n[r]);return t};function Cn({currentStep:t,isPublicRoom:n,onStepClick:r}){const{t:o}=z(),i=Fe(),s=Qe(i.breakpoints.down("md")),d=n?[{label:String(o("roomSelection","Room Selection")),wizardStep:1},{label:String(o("actionsSelection","Actions Selection")),wizardStep:4},{label:String(o("finishSetup","Finish Setup")),wizardStep:5}]:[{label:String(o("roomSelection","Room Selection")),wizardStep:1},{label:String(o("localPlayersStep.title","Local Players")),wizardStep:2},{label:String(o("gameModeSelection","Game Mode Selection")),wizardStep:3},{label:String(o("actionsSelection","Actions Selection")),wizardStep:4},{label:String(o("finishSetup","Finish Setup")),wizardStep:5}],c=d.findIndex(a=>a.wizardStep===t),u=a=>{if(r){const p=d[a].wizardStep;r(p)}};return e.jsx(Xe,{activeStep:c,alternativeLabel:!s,orientation:"horizontal",sx:wn({},s&&{"& .MuiStepLabel-label":{display:"none"}}),children:d.map((a,p)=>e.jsx(Je,{children:e.jsx(Ze,{onClick:()=>u(p),sx:{cursor:r?"pointer":"default","&:hover":r?{"& .MuiStepLabel-label":{color:"primary.main"}}:{}},children:s?null:a.label})},p))})}function On({close:t}){const{id:n}=_e(),[r,o]=b.useState(1),i={room:n||"PUBLIC"},[s,d]=vt({gameMode:"online",roomRealtime:!0,actions:[],consumption:[],role:"sub",boardUpdated:!1,room:n||"PUBLIC",selectedActions:{}},i),{actionsList:c,isLoading:u}=ft(s.gameMode),a=v=>{if(!Number.isInteger(v))return o(r+1);o(r+(v||1))},p=v=>{if(!Number.isInteger(v))return o(r-1);o(r-(v||1))},l=()=>o(0),x=()=>{$(s.room)||s.gameMode==="online"?o(4):o(1)},S=()=>{switch(r){case 1:return e.jsx(Ct,{formData:s,setFormData:d,nextStep:a});case 2:return $(s.room)?(o(4),null):e.jsx(Mt,{formData:s,setFormData:d,nextStep:a,prevStep:p});case 3:return $(s.room)?(o(4),null):e.jsx(Bt,{formData:s,setFormData:d,nextStep:a,prevStep:p});case 4:return e.jsx(hn,{formData:s,setFormData:d,nextStep:a,prevStep:p,actionsList:c,isActionsLoading:u});case 5:return e.jsx(jn,{formData:s,setFormData:d,prevStep:p,actionsList:c,close:t});default:return null}};return r===0?e.jsx(gt,{closeDialog:t,onOpenSetupWizard:x}):e.jsxs(j,{children:[e.jsx(j,{sx:{width:"100%",mt:2,mb:4},children:e.jsx(Cn,{currentStep:r,isPublicRoom:$(s.room),onStepClick:o})}),S(),e.jsx(Oe,{sx:{mt:3}}),e.jsx(w,{onClick:l,children:e.jsx(m,{i18nKey:"advancedSetup"})})]})}function Fn({open:t,close:n}){const r=rt(),[o]=De();return o.get("importBoard")?null:e.jsxs(et,{fullScreen:r,open:t,maxWidth:"md",children:[e.jsxs(tt,{children:[e.jsx(m,{i18nKey:"gameSettingsHeading"}),typeof n=="function"&&e.jsx(st,{close:n})]}),e.jsx(nt,{children:e.jsx(On,{close:typeof n=="function"?n:void 0})})]})}export{Fn as default};
//# sourceMappingURL=index.tsx-DP4s5rYR.js.map
