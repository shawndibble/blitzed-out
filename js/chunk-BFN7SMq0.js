import{ae as k,r as j,j as e,z as T,y as M,ay as R,A as Q,M as S,aa as C,T as x,aH as O,I as re,ax as u,ab as oe,aE as ce,az as Y,aF as N,a1 as A,au as w,b1 as de,b2 as ue,b3 as he,bg as xe,aV as X,aW as je,ad as ge,$ as pe,Z as $,Q as F}from"./chunk-B0_VBOvR.js";import{K as me,b as D,J as K,N as be,$ as ye,a0 as fe}from"./chunk-DjfcUfB3.js";import{l as ve,u as se}from"./chunk-DyBi9s21.js";import{b as B,i as I,c as G}from"./chunk-C7PvMB7v.js";import{u as Se,C as Ce}from"./chunk-DIZE3aKd.js";import{d as we}from"./chunk-Bfa-QeNm.js";import{T as ke}from"./chunk-Cviq917M.js";import{u as Te}from"./chunk-RtjQ02-D.js";import{b as Ae,c as Ke}from"./chunk-BASZ8lRo.js";function te({formData:n,setFormData:s,backgrounds:t,isRoom:l=!1}){const{t:a}=k(),i=l?"roomBackground":"background",c=l?"roomBackgroundURL":"backgroundURL",[r,d]=j.useState(n?.[i]||Object.keys(t)[0]),o=()=>Object.entries(t).map(([b,g])=>e.jsx(S,{value:b,children:g},b)),h=b=>{s({...n,[i]:b.target.value}),d(b.target.value)};j.useEffect(()=>{r!==n?.[i]&&d(n?.[i]||"")},[n,r,i]);const p=b=>{const g={...n,[i]:"custom",[c]:b.target.value};l&&(g.roomUpdated=!0),s(g)};return e.jsxs(e.Fragment,{children:[e.jsxs(T,{fullWidth:!0,margin:"normal",children:[e.jsx(M,{id:"background-label",children:a("background")}),e.jsx(R,{labelId:"background-label",id:"background",label:a("background"),value:r||"",onChange:h,children:o()})]}),r==="custom"&&e.jsx(Q,{sx:{mt:2},label:a("url"),value:n?.[c]||"",fullWidth:!0,onChange:p,helperText:e.jsxs(e.Fragment,{children:[a("supportedSites"),e.jsx("br",{}),a("requiresEmbeddedUrl")]})})]})}const ee={en:["alex","samantha","google uk english male","google uk english female","google us english male","google us english female","victoria","allison","ava","susan","daniel","karen","moira","fiona"],es:["google español","google español de estados unidos","monica","jorge","diego","paulina","juan","esperanza","carlos","rosa"],fr:["google français","amelie","thomas","aurelie","marie","pierre","brigitte","bernard","claire","sylvie"],zh:["google 中文","google 中文（中国大陆）","ting-ting","sin-ji","mei-jia","yu-shu","li-mu","ya-ling","xiao-bao","xiao-rong"],hi:["google हिन्दी","lekha","sangeeta","veena","rishi","kalpana","hemant","kavita","arun","shilpa"]},ne={en:"Take a drink and enjoy the game.",es:"Toma un trago y disfruta del juego.",fr:"Prenez une boisson et profitez du jeu.",zh:"喝一杯，享受游戏。",hi:"एक पेय लें और खेल का आनंद लें।"};class Le{getAvailableVoices(s){const t=window.speechSynthesis.getVoices(),l=s?.split("-")[0]||"en",a=ee[l]||ee.en;return t.filter(i=>{const c=i.name.toLowerCase();return a.some(r=>c.includes(r.toLowerCase()))}).map(i=>({name:i.name,displayName:i.name}))}getPreferredVoice(s){const t=this.getAvailableVoices(s);return t.length>0?t[0].name:null}getSampleText(s){const t=s.split("-")[0];return ne[t]||ne.en}async speak(s,t,l=0){return new Promise((a,i)=>{if(!("speechSynthesis"in window)){i(new Error("Speech synthesis not supported"));return}const c=new SpeechSynthesisUtterance(s);if(c.pitch=l,t){const d=window.speechSynthesis.getVoices().find(o=>o.name===t);d&&(c.voice=d)}c.onend=()=>a(),c.onerror=r=>i(new Error(`Speech failed: ${r.error}`)),window.speechSynthesis.speak(c)})}stop(){window.speechSynthesis?.speaking&&window.speechSynthesis.cancel()}isAvailable(){return"speechSynthesis"in window}}const z=new Le,Pe=()=>{const[n,s]=j.useState(!1),[t,l]=j.useState(!1),[a,i]=j.useState(null),c=j.useCallback(()=>{z.stop(),s(!1),l(!1)},[]),r=j.useCallback(async(d,o={})=>{try{l(!0),i(null),c(),s(!0),await z.speak(d,o.voice,o.pitch),l(!1),s(!1)}catch(h){const p=h instanceof Error?h.message:"TTS failed";i(p),s(!1),l(!1),console.error("TTS Error:",h)}},[c]);return j.useEffect(()=>()=>{c()},[c]),{speak:r,stop:c,isPlaying:n,error:a,isLoading:t}};function Ve({formData:n,setFormData:s,onVoiceChange:t}){const{t:l,i18n:a}=k(),[i,c]=j.useState([]),[r,d]=j.useState(!0),{speak:o}=Pe(),h=n.locale||a.language||"en",p=n.voicePreference||"",b=j.useCallback(m=>{const v={...n,voicePreference:m};s(v),t?.(m)},[n,s,t]);j.useEffect(()=>{let m=!0;return(async()=>{try{if(m){const L=z.getAvailableVoices(h);if(c(L),!p&&L.length>0){const U=z.getPreferredVoice(h);U&&b(U)}d(!1)}}catch(L){console.error("Failed to load voices:",L),m&&d(!1)}})(),()=>{m=!1}},[h,p,b]);const g=m=>{b(m.target.value)},f=async()=>{const m=p||(i.length>0?i[0].name:"");if(!m)return;const v=z.getSampleText(h);try{await o(v,{voice:m,pitch:-2})}catch(L){console.error("Failed to play sample:",L)}},y=m=>m.displayName;return r?e.jsx(C,{sx:{py:1},children:e.jsx(x,{variant:"body2",color:"text.secondary",children:l("loadingVoices","Loading voices...")})}):i.length===0?e.jsx(C,{sx:{py:1},children:e.jsx(x,{variant:"body2",color:"text.secondary",children:l("noVoicesAvailable","No voices available for this language")})}):e.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:1,py:1},children:[e.jsxs(T,{fullWidth:!0,size:"small",children:[e.jsx(M,{id:"voice-select-label",children:l("voiceSelection","Voice")}),e.jsx(R,{labelId:"voice-select-label",value:p,label:l("voiceSelection","Voice"),onChange:g,children:i.map(m=>e.jsx(S,{value:m.name,children:y(m)},m.name))})]}),e.jsx(O,{title:l("playSample","Play sample"),children:e.jsx(re,{onClick:f,color:"primary",disabled:!p,size:"small",children:e.jsx(me,{})})})]})}function Ie({boardUpdated:n}){const{i18n:s}=k(),[t,l]=j.useState(s.resolvedLanguage||"en"),[a,i]=j.useState(!1);async function c(d){i(!0),l(d);try{await s.changeLanguage(d),n()}catch(o){console.error("Error changing language:",o),await s.changeLanguage(d),n()}finally{i(!1)}}const r=Object.entries(ve).map(([d,o])=>e.jsx(S,{value:d,children:o.label},d));return e.jsx(C,{sx:{minWidth:120,mt:1,mb:2},children:e.jsxs(T,{fullWidth:!0,children:[e.jsxs(M,{id:"language-label",sx:{display:"flex",alignItems:"center"},children:[e.jsx(D,{sx:{mr:1}}),e.jsx(u,{i18nKey:"language"})]}),e.jsx(R,{labelId:"language-label",id:"language-select",value:t,disabled:a,label:e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsx(u,{i18nKey:"language"})]}),onChange:d=>c(d.target.value),endAdornment:a&&e.jsx(oe,{size:20}),MenuProps:{disableScrollLock:!0,BackdropProps:{invisible:!0},PaperProps:{style:{backdropFilter:"none",WebkitBackdropFilter:"none"}}},children:r})]})})}function Me({trueCondition:n,onChange:s,yesLabel:t,noLabel:l=null,sx:a={}}){const i=l??t;return e.jsx(C,{sx:{display:"flex",justifyContent:"center",my:1,...a},children:e.jsx(ce,{control:e.jsx(N,{checked:n||!1,onChange:s}),label:Y(n?t:i)})})}function V({field:n,formData:s,handleSwitch:t}){return e.jsx(Me,{trueCondition:s[n],onChange:l=>t(l,n),yesLabel:`${n}Enable`,sx:{justifyContent:"left"}})}function Re({formData:n,setFormData:s,boardUpdated:t}){const[l,a]=se(),{t:i}=k(),c={color:i("color"),gray:i("gray"),"metronome.gif":i("hypnoDick"),"pink-spiral.gif":i("pinkSpiral"),custom:i("customURL")};function r(o,h){s({...n,[h]:o.target.checked}),a({...l,[h]:o.target.checked})}function d(o){a({...l,voicePreference:o})}return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{boardUpdated:t}),e.jsx(x,{variant:"h5",children:e.jsx(u,{i18nKey:"dialog"})}),e.jsx(V,{field:"playerDialog",formData:n,handleSwitch:r}),e.jsx(V,{field:"othersDialog",formData:n,handleSwitch:r}),e.jsx(A,{}),e.jsx(x,{variant:"h5",sx:{mt:2},children:e.jsx(u,{i18nKey:"sounds"})}),e.jsx(V,{field:"mySound",formData:n,handleSwitch:r}),e.jsx(V,{field:"otherSound",formData:n,handleSwitch:r}),e.jsx(V,{field:"chatSound",formData:n,handleSwitch:r}),e.jsx(V,{field:"readRoll",formData:n,handleSwitch:r}),n.readRoll&&e.jsx(Ve,{formData:n,setFormData:s,onVoiceChange:d}),e.jsx(A,{}),e.jsx(x,{variant:"h5",sx:{mt:2,textTransform:"capitalize"},children:e.jsx(u,{i18nKey:"misc"})}),e.jsx(V,{field:"hideBoardActions",formData:n,handleSwitch:r}),e.jsx(V,{field:"advancedSettings",formData:n,handleSwitch:r}),e.jsx(te,{formData:n,setFormData:s,backgrounds:c}),e.jsx(A,{})]})}function _({children:n}){return e.jsx(w,{size:{xs:12,md:5},children:n})}const J=j.forwardRef(({value:n,onChange:s,label:t,options:l,defaultValue:a=null,sx:i,helpIcon:c=!1,fullWidth:r=!0,...d},o)=>{const h=j.useMemo(()=>l.map(p=>typeof p=="string"?e.jsx(S,{value:p,children:Y(p)},p):e.jsx(S,{value:p.value,children:p.label},p.value)),[l]);return e.jsxs(T,{fullWidth:r,margin:"normal",sx:i,...d,ref:o,children:[e.jsxs(M,{id:`${t}Label`,children:[e.jsx(u,{i18nKey:t}),!!c&&e.jsx(K,{sx:{ml:1,fontSize:16}})]}),e.jsx(R,{labelId:`${t}Label`,id:t,label:e.jsxs(e.Fragment,{children:[e.jsx(u,{i18nKey:t}),!!c&&e.jsx(K,{sx:{ml:1,fontSize:16}})]}),value:n||a||"",onChange:s,children:h})]})});function H({children:n,title:s,subtitle:t,defaultExpanded:l=!1,...a}){return e.jsxs(de,{defaultExpanded:l,...a,sx:{backgroundColor:"inherit",backgroundImage:"none",boxShadow:"none"},children:[e.jsxs(ue,{expandIcon:e.jsx(be,{}),sx:{px:0},children:[e.jsxs(x,{variant:"h6",sx:{width:"33%"},children:[s,":"]}),e.jsx(x,{sx:{pt:.5},children:t})]}),e.jsx(he,{sx:{px:0},children:e.jsx(w,{container:!0,columnSpacing:2,justifyContent:"space-evenly",className:"columned-grid",children:n})})]})}function Oe({formData:n,setFormData:s}){const t=(a,i)=>{s({...n,finishRange:i,boardUpdated:!0})},l=n?.finishRange||[30,70];return e.jsxs(C,{children:[e.jsx(A,{}),e.jsx(x,{id:"finish-slider",sx:{my:1},children:e.jsx(u,{i18nKey:"finishSlider"})}),e.jsx(xe,{"aria-labelledby":"finish-slider",value:l,onChange:t,valueLabelDisplay:"off"}),e.jsxs(C,{display:"flex",flexDirection:"column",justifyContent:"space-between",textAlign:"center",children:[e.jsxs(x,{whiteSpace:"nowrap",children:[e.jsx(u,{i18nKey:"noCum"})," ",l[0],"%"]}),e.jsxs(x,{whiteSpace:"nowrap",children:[e.jsx(u,{i18nKey:"ruined"})," ",l[1]-l[0],"%"]}),e.jsxs(x,{whiteSpace:"nowrap",children:[e.jsx(u,{i18nKey:"cum"})," ",100-l[1],"%"]})]}),e.jsx(A,{sx:{my:1}})]})}function Ee(){const[n,s]=j.useState(!1);return j.useEffect(()=>{const t=window.matchMedia("(pointer: fine)");s(t.matches);const l=a=>{s(a.matches)};return t.addEventListener("change",l),()=>{t.removeEventListener("change",l)}},[]),n}function Ue({actionsFolder:n,settings:s,option:t,onChange:l,initValue:a=0}){const i=`${t}label`,c=n[t]?.label,r=()=>s.selectedActions?.[t]?.level||a,d=Ee(),[o,h]=j.useState(r()),p=y=>{l(y)},b=y=>{h(y)},g=y=>o>0&&y===0?!1:s.difficulty==="accelerated"?o<=2?o===y:o===y||o-1===y:o>=y;function f(y){return Object.keys(n[y]?.actions||{}).map((m,v)=>e.jsxs(S,{value:v,onMouseOver:()=>b(v),children:[!!d&&e.jsx("span",{className:"menu-item-icon",children:g(v)?e.jsx(ye,{}):e.jsx(fe,{})}),m]},`${y}-${m}`))}return e.jsxs(T,{margin:"normal",fullWidth:!0,children:[e.jsx(M,{id:i,children:c}),e.jsx(R,{labelId:i,id:t,label:c,value:r(),onChange:p,onOpen:()=>h(r()),onClose:()=>h(r()),children:f(t)})]})}function ze({option:n,settings:s,setSettings:t,actionsFolder:l,type:a,showVariation:i=!1,showRole:c=!1}){const{t:r}=k(),d=`${n}label`,o=l[n]?.label;function h(g,f,y){const m=s.selectedActions?.[f];t({...s,selectedActions:{...s.selectedActions,[f]:{...m,type:a,level:m?.level??0,[y]:g?.target?.value}},boardUpdated:!0})}let p=12;(i||c)&&(p=6);let b=["dom","vers","sub"];return l[n]?.dom&&(b=[{label:l[n].dom,value:"dom"},{label:r("vers"),value:"vers"},{label:l[n].sub,value:"sub"}]),e.jsxs(w,{container:!0,justifyContent:"center",children:[e.jsx(w,{size:p,children:e.jsx(Ue,{actionsFolder:l,settings:s,option:n,onChange:g=>h(g,n,"level")})}),!!c&&e.jsx(w,{size:6,children:e.jsx(J,{sx:{ml:1},value:s.selectedActions?.[n]?.role,onChange:g=>h(g,n,"role"),label:`${r("role")}: ${o}`,options:b,defaultValue:s.role||"sub"})}),!!i&&e.jsx(w,{size:6,children:e.jsx(O,{placement:"top",title:e.jsxs(u,{i18nKey:"variationTooltip",children:[e.jsx(x,{variant:"subtitle2",children:"Standalone = Its own tile. "}),e.jsx(x,{variant:"subtitle2",children:"Append Some = 50% chance."}),e.jsx(x,{variant:"subtitle2",children:"Append Most = 90% chance."})]}),arrow:!0,children:e.jsxs(T,{fullWidth:!0,margin:"normal",sx:{ml:1},children:[e.jsxs(M,{id:`${d}Variation`,children:[`${o} ${r("variation")}`,e.jsx(K,{sx:{ml:1,fontSize:16}})]}),e.jsxs(R,{labelId:`${d}Variation`,id:`${n}Variation`,label:e.jsxs(e.Fragment,{children:[o," ",r("variation"),e.jsx(K,{sx:{ml:1,fontSize:16}})]}),value:s.selectedActions?.[n]?.variation||"standalone",onChange:g=>h(g,n,"variation"),children:[e.jsx(S,{value:"standalone",children:e.jsx(u,{i18nKey:"standalone"})}),e.jsx(S,{value:"appendSome",children:e.jsx(u,{i18nKey:"appendSome"})}),e.jsx(S,{value:"appendMost",children:e.jsx(u,{i18nKey:"appendMost"})})]})]})})})]},n)}function Be({formData:n,setFormData:s}){return e.jsxs(X,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{mt:1},children:[e.jsx(x,{children:e.jsx(u,{i18nKey:"solo"})}),e.jsx(O,{title:e.jsx(x,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"soloTooltip"})}),arrow:!0,children:e.jsx(K,{sx:{fontSize:15}})}),e.jsx(N,{id:"gameMode",checked:!B(n.gameMode),onChange:t=>s({...n,gameMode:t.target.checked?"local":"online",boardUpdated:!0}),inputProps:{"aria-label":"Game Type"}}),e.jsx(x,{children:e.jsx(u,{i18nKey:"local"})}),e.jsx(O,{title:e.jsx(x,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"localTooltip"})}),arrow:!0,children:e.jsx(K,{sx:{fontSize:15}})})]})}function Ne({formData:n}){const[s,t]=j.useState(!1);return j.useEffect(()=>{const l=Object.values(n).filter(i=>typeof i=="object"&&i?.type==="consumption"&&i?.level>0).length,a=Object.values(n).filter(i=>typeof i=="object"&&i?.level>0).length;t(l>1&&l>=a-l)},[n]),s?e.jsx(je,{severity:"warning",children:e.jsx(u,{i18nKey:"consumptionWarning"})}):null}function We({formData:n,setFormData:s,actionsList:t}){const{t:l}=k(),a=!I(n?.room)&&!B(n.gameMode);function i(r,d={}){return Object.keys(t).filter(o=>t[o]?.type===r).map(o=>e.jsx(_,{children:e.jsx(ze,{option:o,settings:n,setSettings:s,actionsFolder:t,type:r,...d})},o))}const c=r=>{const d=JSON.parse(JSON.stringify(n));return Object.keys(d).forEach(o=>{d.role=r,o.includes("role")&&(d[o]=r)}),d};return e.jsxs(e.Fragment,{children:[e.jsx(Be,{formData:n,setFormData:s}),I(n?.room)&&!B(n.gameMode)&&e.jsx(w,{container:!0,alignContent:"center",justifyContent:"space-evenly",children:e.jsx(w,{sx:{py:3},children:e.jsx(x,{variant:"h5",children:e.jsx(u,{i18nKey:"privateRequired"})})})}),e.jsxs(w,{container:!0,columnSpacing:2,justifyContent:"space-evenly",children:[e.jsx(_,{children:e.jsx(O,{placement:"top",title:e.jsx(u,{i18nKey:"difficultyTooltip",children:e.jsxs(x,{variant:"body2",children:["Normal = Slow ramp up. ",e.jsx("br",{}),e.jsx("br",{}),"Accelerated = Straight to max level + the level prior to it."]})}),arrow:!0,children:e.jsx(J,{value:n.difficulty,onChange:r=>s({...n,difficulty:r.target.value,boardUpdated:!0}),label:"difficulty",options:["normal","accelerated"],defaultValue:"normal",helpIcon:!0})})}),a&&e.jsx(_,{children:e.jsx(J,{value:n.role,onChange:r=>s({...c(r.target.value),boardUpdated:!0}),label:"mainRole",options:["dom","vers","sub"],defaultValue:"sub"})})]}),a?e.jsxs(e.Fragment,{children:[e.jsx(H,{title:l("consumption"),subtitle:l("consumptionSubtitle"),children:i("consumption",{showVariation:!0})}),e.jsx(H,{title:l("foreplay"),subtitle:l("foreplaySubtitle"),children:i("foreplay",{showRole:a})}),e.jsx(H,{title:l("sex"),subtitle:l("sexSubtitle"),children:i("sex",{showRole:a})})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{container:!0,columnSpacing:2,justifyContent:"space-evenly",children:i("consumption",{showVariation:!0})}),e.jsx(A,{}),e.jsx(w,{container:!0,columnSpacing:2,justifyContent:"center",children:i("solo")})]}),e.jsx(Oe,{setFormData:s,formData:n}),e.jsx(Ne,{formData:n})]})}function $e({formData:n,setFormData:s}){const{t}=k(),l={"1d4":2.5,"1d6":3.5,"2d4":5},a=n?.roomTileCount?Math.floor(n.roomTileCount/l[n.roomDice||"1d6"]):16,i=Array.from({length:7},(c,r)=>(r+2)*10).map(c=>e.jsx(S,{value:c,children:c},c));return e.jsxs(e.Fragment,{children:[e.jsx(x,{children:e.jsx(u,{i18nKey:"gameSpeed"})}),e.jsxs(C,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(T,{sx:{m:1},fullWidth:!0,children:[e.jsx(M,{id:"diceRole-label",children:e.jsx(u,{i18nKey:"roomDice"})}),e.jsxs(R,{labelId:"diceRole-label",id:"diceRole-select",value:n?.roomDice||"1d4",label:t("roomDice"),onChange:c=>s({...n,roomDice:c.target.value,roomUpdated:!0}),children:[e.jsx(S,{value:"1d4",children:"1d4"}),e.jsx(S,{value:"1d6",children:"1d6"}),e.jsx(S,{value:"2d4",children:"2d4"})]})]}),e.jsxs(T,{sx:{m:1},fullWidth:!0,children:[e.jsx(M,{id:"tile-count-label",children:e.jsx(u,{i18nKey:"roomTileCount"})}),e.jsx(R,{labelId:"tile-count-label",id:"tile-count-select",value:String(n?.roomTileCount||40),label:t("roomTileCount"),onChange:c=>s({...n,roomTileCount:Number(c.target.value),roomUpdated:!0}),children:i})]}),e.jsx(T,{fullWidth:!0,children:e.jsxs(x,{children:[e.jsx(u,{i18nKey:"averageRolls"}),a]})})]})]})}function Fe({formData:n,setFormData:s}){const t=j.useCallback(()=>{s({...n,roomRealtime:!n.roomRealtime,roomUpdated:!0})},[n,s]);return e.jsxs(e.Fragment,{children:[e.jsx(x,{children:e.jsx(u,{i18nKey:"playerListOptions"})}),e.jsxs(X,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{width:"100%"},children:[e.jsx(x,{children:e.jsx(u,{i18nKey:"realtime"})}),e.jsx(O,{title:e.jsx(x,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"realtimeTooltip"})}),arrow:!0,children:e.jsx(K,{sx:{fontSize:15}})}),e.jsx(N,{id:"showPrivate",checked:!!n.roomRealtime,onChange:t,inputProps:{"aria-label":Y("playerList")}}),e.jsx(x,{children:e.jsx(u,{i18nKey:"delayed"})}),e.jsx(O,{title:e.jsx(x,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"delayedTooltip"})}),arrow:!0,children:e.jsx(K,{sx:{fontSize:15}})})]})]})}function Ge({formData:n,setFormData:s}){const{id:t}=ge(),{t:l}=k(),a=o=>{let h;o.target.checked&&I(t)?h=we("123456789ABCDEFGHJKLMNPQRSTUVWXYZ",5)():t&&o.target.checked&&!I(t)?h=t:h="PUBLIC",s({...n,room:h.toUpperCase(),gameMode:I(h)?"online":n.gameMode})},i=j.useCallback(o=>{s({...n,room:o.currentTarget.value,boardUpdated:!0})},[n,s]),c=j.useCallback(o=>{o.key==="Enter"&&s({...n,room:o.currentTarget.value,boardUpdated:!0})},[n,s]),r=j.useCallback(o=>{const h=o.target.value.toUpperCase();o.target.value=h},[]),d=!I(n.room);return e.jsxs(e.Fragment,{children:[e.jsxs(X,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{width:"100%"},children:[e.jsx(x,{children:e.jsx(u,{i18nKey:"public"})}),e.jsx(N,{id:"showPrivate",checked:d,onChange:a,slotProps:{input:{"aria-label":l("room")}}}),e.jsx(x,{children:e.jsx(u,{i18nKey:"private"})}),e.jsx(O,{title:e.jsx(x,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"privateOptions"})}),arrow:!0,children:e.jsx(K,{sx:{fontSize:15}})})]}),d&&e.jsx(Q,{fullWidth:!0,id:"privateRoom",label:l("privateRoom"),defaultValue:n.room?.toUpperCase(),margin:"normal",onBlur:i,onKeyDown:c,onChange:r,inputProps:{style:{textTransform:"uppercase"}}})]})}function _e({formData:n,setFormData:s}){const{t}=k(),l={app:t("appBackground"),custom:t("customURL")};return e.jsxs(C,{sx:{margin:"0.5rem"},children:[e.jsx(Ge,{formData:n,setFormData:s}),!I(n.room)&&e.jsxs(e.Fragment,{children:[e.jsx(A,{sx:{my:1}}),e.jsx($e,{formData:n,setFormData:s}),e.jsx(A,{sx:{my:1}}),e.jsx(Fe,{formData:n,setFormData:s}),e.jsx(A,{sx:{my:1}}),e.jsx(te,{formData:n,setFormData:s,backgrounds:l,isRoom:!0})]})]})}function q({children:n,value:s,index:t,style:l,...a}){return e.jsx("div",{role:"tabpanel",hidden:s!==t,id:`simple-tabpanel-${t}`,"aria-labelledby":`simple-tab-${t}`,...a,children:s===t&&e.jsx(C,{sx:{p:3,...l},children:n})})}function He(n){return Object.values(n).some(({level:s})=>s>0)}function qe(n,s){const t=n.selectedActions||{};return Object.entries(t).reduce((l,[a,i])=>(a in s&&(i?.variation?.startsWith("append")?l.withAppend[a]=i:l.withoutAppend[a]=i),l),{withAppend:{},withoutAppend:{}})}function Je(n){return Object.keys(n).length>0&&Object.values(n).some(({level:s})=>s>0)}function Qe(n,s){const{withAppend:t,withoutAppend:l}=qe(n,s);return He(l)?I(n.room)&&!B(n.gameMode)?"privateRequired":null:Je(t)?"appendWithAction":"pickSomething"}function Ye({closeDialog:n,initialTab:s=0,onOpenSetupWizard:t}){const{user:l}=Te(),{t:a}=k(),[i,c]=se(),[r,d]=j.useState(s),[o,h]=j.useState(null),[p,b]=j.useState(!1),[g,f]=Se(),y=Ae(),{isLoading:m,actionsList:v}=Ke(g?.gameMode),L=(P,E)=>{d(E)},U=()=>c({...i,boardUpdated:!0}),W=j.useCallback(async P=>{P.preventDefault();const{displayName:E,...ae}=g,Z=Qe(ae,v);return Z?(h(a(Z)),null):(await y(g,v),typeof n=="function"&&n(),null)},[g,v,a,h,y,n]),le=j.useCallback(P=>{f(E=>({...E,displayName:P.target.value}))},[f]),ie=j.useCallback(P=>{P.key==="Enter"&&(f(E=>({...E,displayName:P.target.value})),W(P))},[W,f]);return!g.room||m?e.jsxs(C,{children:[e.jsxs(x,{variant:"h2",children:[e.jsx(u,{i18nKey:"loading"}),"..."]}),e.jsx(x,{variant:"body1",children:e.jsx(u,{i18nKey:"clearStorage"})})]}):e.jsxs(C,{component:"form",method:"post",onSubmit:W,className:"settings-box",children:[e.jsx(Q,{fullWidth:!0,id:"displayName",label:a("displayName"),defaultValue:l?.displayName||g.displayName||"",required:!0,autoFocus:!0,onBlur:le,onKeyDown:ie,margin:"normal"}),e.jsx(C,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(pe,{value:r,onChange:L,"aria-label":a("gameSettings"),centered:!0,children:[e.jsx($,{label:a("gameboard"),...G(0)}),e.jsx($,{label:a("room"),...G(1)}),e.jsx($,{label:a("application"),...G(2)})]})}),e.jsx(q,{value:r,index:0,style:{p:0},children:e.jsx(We,{formData:g,setFormData:f,actionsList:v})}),e.jsx(q,{value:r,index:1,style:{p:0,pt:1},children:e.jsx(_e,{formData:g,setFormData:f})}),e.jsx(q,{value:r,index:2,style:{p:0,pt:1},children:e.jsx(Re,{formData:g,setFormData:f,boardUpdated:U})}),e.jsxs("div",{className:"flex-buttons",children:[e.jsxs("div",{className:"left-buttons",children:[t&&e.jsx(F,{variant:"outlined",type:"button",onClick:t,children:e.jsx(u,{i18nKey:"setupWizard"})}),r===0&&e.jsx(F,{variant:"outlined",type:"button",onClick:()=>b(!0),children:e.jsx(u,{i18nKey:"customTilesLabel",children:"Game Tiles"})})]}),e.jsx(F,{variant:"contained",type:"submit",children:e.jsx(u,{i18nKey:"update"})})]}),p&&e.jsx(Ce,{open:p,setOpen:b,boardUpdated:U,actionsList:v}),e.jsx(ke,{open:!!o,close:()=>h(null),children:o})]})}const rn=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));export{Ye as G,Ue as I,q as T,Me as Y,rn as i,z as t};
