import{b as de,u as D,a as J,g as pe,U as fe}from"./chunk-E8HqAuJ1.js";import{a as me,i as ge}from"./chunk-Pkb0UFv2.js";import{i as A,az as he,u as j,b,aj as Z,ao as ve}from"./chunk-CVSdvP5Z.js";import{y as K,E as ye,q as Q,F as be,g as _e,x as ee,G as $e,H as we}from"./chunk-B-cyqPC2.js";import{l as Te}from"./chunk-9Rprt94M.js";import{d as te,i as ne,u as Ce,b as Se}from"./chunk-guvQFVv-.js";import{u as G}from"./chunk-CNqt7FHs.js";import{u as Le}from"./chunk-BO6dzI_Q.js";(function(){var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};e.SENTRY_RELEASE={id:"874067a760cfa9079dd7f585e4ceff298b0e879f"}})();try{(function(){var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8da30866-e5e2-4fab-ad8d-804556617d60",e._sentryDebugIdIdentifier="sentry-dbid-8da30866-e5e2-4fab-ad8d-804556617d60")})()}catch(e){}function I(e){for(let t=e.length-1;t>0;t-=1){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}function Ct(e,t){return(e==null?void 0:e.length)!==(t==null?void 0:t.length)?!1:e.every((n,o)=>n===t[o])}var Pe=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});function Ae(e){const{t}=A;let n=`### ${t("roomSettings")}\r
`;return Object.entries(e).forEach(([o,s])=>{if(o!=="room"){if(o==="roomBackgroundURL"&&s!==""){n+=`* ${t(o)}: [${me(s)}:link:](${s})\r
`;return}if(o==="roomRealtime"){n+=`* ${t("playerList")}: ${t(s?"delayed":"realtime")}\r
`;return}s!==""&&(n+=`* ${t(o)}: ${s}\r
`)}}),n}function Ee(e){const t={};return Object.entries(e).forEach(([n,o])=>{n.startsWith("room")&&!["roomUpdated","roomBackground","roomBackgroundURL"].includes(n)&&(t[n]=o)}),e.roomBackgroundURL&&e.roomBackgroundURL.trim()!==""&&(t.roomBackgroundURL=e.roomBackgroundURL),t}function Ue(e,t,n){return Pe(this,null,function*(){let o=e;return t!==void 0&&t.length>0&&(o=yield n(t)),o})}function Ge(e,t){const n=Ee(e);return K({room:e.room,user:t,text:Ae(n),type:"room",settings:JSON.stringify(n)})}var se=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});const N=50,O=100,B=50,R=1,M=10,V=1,x=10,oe=["none","all","default","undefined","null"],Ie=["solo","foreplay","sex","consumption"],Ne=(e,t="en",n="online",o)=>{const s=[],r=[];if(!e||e.trim().length===0)return s.push("Group name is required"),{isValid:!1,errors:s,warnings:r};const c=e.trim();return c.length>N&&s.push(`Group name must be ${N} characters or less`),oe.includes(c.toLowerCase())&&s.push(`"${c}" is a reserved name and cannot be used`),/^[a-zA-Z0-9_-]+$/.test(c)||s.push("Group name can only contain letters, numbers, hyphens, and underscores"),/^[a-zA-Z]/.test(c)||s.push("Group name must start with a letter"),{isValid:s.length===0,errors:s,warnings:r}},Oe=e=>{const t=[],n=[];return!e||e.trim().length===0?(t.push(he("groupLabelRequired")),{isValid:!1,errors:t,warnings:n}):(e.trim().length>O&&t.push(`Group label must be ${O} characters or less`),{isValid:t.length===0,errors:t,warnings:n})},Be=e=>{const t=[],n=[];if(!e||e.length===0)return t.push("At least one intensity level is required"),{isValid:!1,errors:t,warnings:n};e.length<V&&t.push(`At least ${V} intensity level is required`),e.length>x&&t.push(`Maximum ${x} intensity levels allowed`);const o=new Set,s=new Set;for(let l=0;l<e.length;l++){const i=e[l];if((!i.id||i.id.trim().length===0)&&t.push(`Intensity level ${l+1} is missing an ID`),!i.label||i.label.trim().length===0)t.push(`Intensity level ${l+1} is missing a label`);else{const a=i.label.trim();a.length>B&&t.push(`Intensity level ${l+1} label must be ${B} characters or less`),s.has(a.toLowerCase())?t.push(`Intensity label "${a}" is used multiple times`):s.add(a.toLowerCase())}typeof i.value!="number"||!Number.isInteger(i.value)?t.push(`Intensity level ${l+1} must have a valid integer value`):((i.value<R||i.value>M)&&t.push(`Intensity level ${l+1} value must be between ${R} and ${M}`),o.has(i.value)?t.push(`Intensity value ${i.value} is used multiple times`):o.add(i.value))}const r=Array.from(o).sort((l,i)=>l-i);let c=r[0];for(const l of r){if(l!==c){n.push("Intensity values are not sequential. Consider using values like 1, 2, 3, 4 for better user experience");break}c++}return{isValid:t.length===0,errors:t,warnings:n}},St=(e,t)=>se(null,null,function*(){const n=[],o=[],s=Ne(e.name,e.locale||"en",e.gameMode||"online");n.push(...s.errors),o.push(...s.warnings||[]);const r=Oe(e.label);n.push(...r.errors),o.push(...r.warnings||[]);const c=Be(e.intensities);if(n.push(...c.errors),o.push(...c.warnings||[]),s.isValid&&e.name)try{(yield ye(e.name,e.locale||"en",e.gameMode||"online",t))||n.push(`A group with the name "${e.name}" already exists for this locale and game mode`)}catch(l){o.push("Could not verify group name uniqueness"),Te.warn("Failed to check group name uniqueness:",!1,l instanceof Error?l.message:"Unknown error")}return{isValid:n.length===0,errors:n,warnings:o}}),Lt=(e,t="en",n="online")=>se(null,null,function*(){const o=[],s=[];if(!e.group||e.group.trim().length===0)return o.push("Tile must belong to a group"),{isValid:!1,errors:o,warnings:s};try{const r=yield Q(e.group,t,n);if(!r)return o.push(`Group "${e.group}" does not exist for ${t}/${n}`),{isValid:!1,errors:o,warnings:s};const c=r.intensities.map(l=>l.value);c.includes(e.intensity)||o.push(`Intensity ${e.intensity} is not valid for group "${e.group}". Valid intensities: ${c.join(", ")}`),(!e.action||e.action.trim().length===0)&&o.push("Tile action is required")}catch(r){o.push(`Error validating tile: ${r}`)}return{isValid:o.length===0,errors:o,warnings:s}}),Re=()=>({MAX_GROUP_NAME_LENGTH:N,MAX_GROUP_LABEL_LENGTH:O,MAX_INTENSITY_LABEL_LENGTH:B,MIN_INTENSITY_VALUE:R,MAX_INTENSITY_VALUE:M,MIN_INTENSITIES_COUNT:V,MAX_INTENSITIES_COUNT:x,RESERVED_GROUP_NAMES:oe,VALID_GROUP_TYPES:Ie});var re=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});function Me(e,t){return e!==null&&typeof e=="object"&&typeof t=="string"&&t in e}function Ve(e,t,n){const o=e.selectedActions||{},s=Object.entries(n).filter(([c])=>o[c]).reduce((c,[l,i])=>{const a=o[l].levels||[],d=Object.keys(i.actions);return c[l]=a.map(p=>d[p]).filter(Boolean),c},{});return((t==null?void 0:t.filter(c=>{if(!c.isCustom)return!1;const l=s[c.group];return l&&l.length>=Number(c.intensity)}))||[]).length}function xe(e,t,n,o){return re(this,null,function*(){const{t:s}=A;let r=`### ${A.t("gameSettingsHeading")}\r
`;o&&(r+=`##### ${o}\r
`),r+=`--- \r
`;const c=e.selectedActions||{};if(Object.entries(n).forEach(([a,d])=>{if(!c[a])return;const{role:p,variation:f,levels:m}=c[a],u=p||e.role||"sub";if(m&&m.length>0){r+=d==null?void 0:d.label;let h=null;f?h=s(f):te(e.gameMode)||(h=Me(d,u)?d[u]:s(u)),h&&(r+=`: ${h}`),r+=`\r
`;const y=(d==null?void 0:d.intensities)||{};m.forEach(g=>{const v=y[g]||`Level ${g}`;r+=`* ${v}\r
`}),r+=`\r
`}}),e.customGroups&&Array.isArray(e.customGroups)){for(const a of e.customGroups)if(a.groupName&&a.intensity)try{const d=yield Q(a.groupName,e.locale||"en",e.gameMode||"online"),p=(d==null?void 0:d.label)||a.groupName;r+=`* ${p}: Level ${a.intensity} (Custom)\r
`}catch(d){console.error(`Error loading custom group ${a.groupName}:`,d),r+=`* ${a.groupName}: Level ${a.intensity} (Custom)\r
`}}if(r.endsWith(`--- \r
`))return"";const{finishRange:l}=e;if(r+=`--- \r
`,l){const a=l[0],d=l[1]-l[0],p=100-l[1],m=[a>0?{percent:a,text:s("noCum")}:null,d>0?{percent:d,text:s("ruined")}:null,p>0?{percent:p,text:s("cum")}:null].filter(u=>u!==null);m.length===1&&m[0].percent===100?r+=`* ${s("finishSlider")} ${m[0].text.replace(":","")} \r
`:m.length>0&&(r+=`* ${s("finishSlider")} \r
\r
`,m.forEach(u=>{const h=u.percent===100?u.text.replace(":",""):`${u.text} ${u.percent}%`;r+=`  - ${h} \r
`}))}const i=Ve(e,t,n);return i&&(r+=`* ${s("customTilesLabel")}: ${i} \r
`),r})}function je(e){const t={};return Object.entries(e).forEach(([n,o])=>{!["displayName","background","boardUpdated","chatSound","mySound","otherSound","othersDialog","playerDialog","readRoll","hideBoardActions","advancedSettings"].includes(n)&&!n.startsWith("room")&&(t[n]=o)}),t}function ke(e){return re(this,arguments,function*({title:t,formData:n,user:o,actionsList:s,tiles:r,customTiles:c=[],reason:l=""}){const i=JSON.stringify(je(n)),a=yield be({title:t,gameBoard:JSON.stringify(r),settings:i}),d=yield xe(n,c,s,l);if(!(!(a!=null&&a.id)||d===""))return K({room:(n==null?void 0:n.room)||"PUBLIC",user:o,text:d,type:"settings",gameBoardId:a.id,boardSize:r.length,gameMode:n.gameMode})})}var qe=Object.defineProperty,We=(e,t,n)=>t in e?qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,q=(e,t,n)=>We(e,typeof t!="symbol"?t+"":t,n),ie=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});const{t:S}=A;class Fe{constructor(t){q(this,"bags",new Map),q(this,"originalTiles",new Map);const n=new Map;t.forEach(o=>{const s=`${o.group}-${o.intensity}`;n.has(s)||n.set(s,[]),n.get(s).push(o)}),n.forEach((o,s)=>{const r=[...o];I(r),this.bags.set(s,r),this.originalTiles.set(s,[...o])})}getTile(t,n){const o=`${t}-${n}`;let s=this.bags.get(o);if(!s||s.length===0){const r=this.originalTiles.get(o);if(!r||r.length===0)return null;s=[...r],I(s),this.bags.set(o,s)}return s.pop()||null}}function He(e,t,n=[]){return e.filter(o=>{const s=o.action,r=n.find(c=>c.name===o.group);return(r==null?void 0:r.type)==="consumption"||(r==null?void 0:r.type)==="solo"?!0:t==="vers"?s.includes("{sub}")&&s.includes("{dom}")||s.includes("{player}"):!s.match(/{(dom|sub)}/)||s.includes(`{${t}}`)})}const W=new Map;function Ye(e,t,n){const o=`${e}-${t}-${n}`,s=W.get(o);if(s!==void 0)return s;const r=e/t,c=Math.floor(n/r)+1;return W.set(o,c),c}function le(e,t,n,o,s,r){if(!e.length)return{title:"",description:""};const c=e[0],l=n[c.name];if(!l||!l.levels||l.levels.length===0)return{title:"",description:""};if(l.variation){const m=l.variation==="appendSome"?.4:l.variation==="appendMost"?.9:1;if(l.variation!=="standalone"&&Math.random()>m)return{title:"",description:""}}const i=Math.max(...c.intensities.map(m=>m.value)),a=Ye(s,i,o),d=l.levels;let p;d.includes(a)?p=a:p=d.reduce((m,u)=>Math.abs(u-a)<Math.abs(m-a)?u:m);let f=t.getTile(c.name,p);if(!f){const m=d.filter(u=>u!==p);for(const u of m)if(f=t.getTile(c.name,u),f)break;if(!f)return{title:"",description:""}}return{title:c.label,description:f.action,standalone:l.variation==="standalone",role:r.role||"sub"}}function Xe(e,t,n,o,s,r,c){if(e.standalone||!t.length||!e.description)return e.description||"";const l=le(t,n,o,s,r,c);return l.description?`${l.description.trim().replace(/([^.,!?])$/,"$1.")} ${e.description}`:e.description}function ze(e,t,n,o){return ie(this,null,function*(){const s=n.selectedActions||{},r=new Fe(t),c=e.filter(d=>{const p=s[d.name];return p&&p.levels&&p.levels.length>0&&(!p.variation||p.variation==="standalone")}),l=e.filter(d=>{const p=s[d.name];return p&&p.levels&&p.levels.length>0&&(p.variation==="appendSome"||p.variation==="appendMost")});I(c);let i=0;const a=[];for(let d=1;d<=o;d++){const p=c.length>0?[c[i%c.length]]:[];i++;const f=le(p,r,s,d,o,n),m=Xe(f,l,r,s,d,o,n);a.push({title:f.title,description:m.trim(),role:f.role})}return a})}function U(e,t){const n={title:S("start"),description:S("start")},{finishRange:o=[33,66]}=t,s=`${S("noCum")} ${o[0]}%\r
${S("ruined")} ${o[1]-o[0]}%\r
${S("cum")} ${100-o[1]}%`,r={title:S("finish"),description:s};return[n,...e.map(c=>({title:c.title,description:c.description})),r]}function De(e,t,n,o=40){return ie(this,null,function*(){try{const[s,r]=yield Promise.all([_e({locale:t,gameMode:n}),de({locale:t,gameMode:n})]),c=e.selectedActions||{},l=Object.keys(c).filter(g=>{var v;return((v=c[g])==null?void 0:v.levels)&&c[g].levels.length>0}),i=s.filter(g=>l.includes(g.name)),a=s.map(g=>g.name),d=l.filter(g=>!a.includes(g)),p=e.role||"sub",m=He(r,p,s).filter(g=>l.includes(g.group));if(!i.length||!m.length)return{board:U([],e),metadata:{totalTiles:o+2,tilesWithContent:2,selectedGroups:l,missingGroups:d,availableTileCount:m.length}};const u=yield ze(i,m,e,o),h=u.filter(g=>g.description.trim().length>0).length,y=U(u,e);return{board:y,metadata:{totalTiles:y.length,tilesWithContent:h+2,selectedGroups:l,missingGroups:d,availableTileCount:m.length}}}catch(s){return console.error("Error building game board:",s),{board:U([],e),metadata:{totalTiles:2,tilesWithContent:2,selectedGroups:[],missingGroups:[],availableTileCount:0}}}})}var Je=Object.defineProperty,Ze=Object.defineProperties,Ke=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable,H=(e,t,n)=>t in e?Je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P=(e,t)=>{for(var n in t||(t={}))Qe.call(t,n)&&H(e,n,t[n]);if(F)for(var n of F(t))et.call(t,n)&&H(e,n,t[n]);return e},tt=(e,t)=>Ze(e,Ke(t)),nt=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});function st(){const e=G(J),[t,n]=ee(),{i18n:o}=j(),s=b.useCallback(r=>nt(null,null,function*(){var c,l;const i=r!=null&&r.roomUpdate||r!=null&&r.boardUpdated?r:tt(P(P({},t),r),{selectedActions:P(P({},t.selectedActions),r.selectedActions)});let{gameMode:a,boardUpdated:d}=i;const{roomTileCount:p=40,finishRange:f,room:m}=i,u=ne(m||"");if(!r||!f)return{gameMode:a};u&&!te(a||"")&&(a="online",d=!0);const h=a||"online",y=o.resolvedLanguage||"en",g=u?40:p||40,v=yield De(i,y,h,g);return v.metadata.missingGroups.length>0&&console.warn("Missing groups for board building:",v.metadata.missingGroups),v.metadata.tilesWithContent<g/2&&console.warn("Low tile content ratio:",{tilesWithContent:v.metadata.tilesWithContent,totalTiles:v.metadata.totalTiles,availableTileCount:v.metadata.availableTileCount}),(r!=null&&r.boardUpdated||d||((l=(c=e==null?void 0:e.tiles)==null?void 0:c.length)!=null?l:0)!==v.board.length)&&(yield n(i),yield D({title:(e==null?void 0:e.title)||"",tiles:v.board})),{settingsBoardUpdated:d,gameMode:a,newBoard:v.board,metadata:v.metadata}}),[e,o.resolvedLanguage,t,n]);return b.useCallback(r=>s(r),[s])}function ot(){const{id:e}=Z(),t=ve();return n=>{const o=e!==void 0&&(e==null?void 0:e.toUpperCase())!==(n==null?void 0:n.toUpperCase()),s=(n==null?void 0:n.replace(/^\/+/,""))||"PUBLIC";o&&t(`/${s}`)}}var rt=Object.defineProperty,it=Object.defineProperties,lt=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable,X=(e,t,n)=>t in e?rt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ae=(e,t)=>{for(var n in t||(t={}))at.call(t,n)&&X(e,n,t[n]);if(Y)for(var n of Y(t))ct.call(t,n)&&X(e,n,t[n]);return e},ut=(e,t)=>it(e,lt(t)),dt=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});function pt(e){var t;const n=(t=e.roomBackgroundURL)==null?void 0:t.trim();n!==e.roomBackgroundURL&&(e.roomBackgroundURL=n||""),e.roomBackgroundURL&&!ge(e.roomBackgroundURL)&&(e.roomBackgroundURL="")}function ft(e){const t=ae({},e),n={};e.selectedActions&&Object.entries(e.selectedActions).forEach(([s,r])=>{r&&r.levels&&r.levels.length>0&&(n[s]=r)});const o=Re();return Object.keys(t).forEach(s=>{const r=t[s];r&&typeof r=="object"&&r.type&&o.VALID_GROUP_TYPES.includes(r.type)&&delete t[s]}),t.selectedActions=n,t}function Pt(){const{user:e,updateUser:t}=Ce(),{id:n}=Z(),{t:o}=j(),s=st(),[r,c]=ee(),l=G(()=>pe(r==null?void 0:r.gameMode)),i=G(J),a=ot(),{messages:d}=Se(),{createLocalSession:p}=Le(),f=b.useCallback(u=>{var h;const y=(h=n||"")==null?void 0:h.toUpperCase(),g=(u.room||"").toUpperCase(),v=y!==g,_=!!(u.room&&!ne(u.room)),w=_&&u.roomTileCount!==(r==null?void 0:r.roomTileCount);return{roomChanged:v,isPrivateRoom:_,privateBoardSizeChanged:w}},[n,r==null?void 0:r.roomTileCount]),m=b.useCallback((u,h)=>dt(null,null,function*(){const{displayName:y}=u,g=yield Ue(e,y,t);pt(u);const{settingsBoardUpdated:v,gameMode:_,newBoard:w=[]}=yield s(u),{roomChanged:T,isPrivateRoom:E,privateBoardSizeChanged:ce}=f(u);if(!g)return;E&&(u.roomUpdated||!d.find(C=>C.type==="room"))&&(yield Ge(u,g)),(i==null?void 0:i.tiles)!==w&&(yield D({title:o("settingsGenerated"),tiles:w,isActive:1,gameMode:_})),(v||T||ce)&&!d.some(C=>{var k;return C.type==="settings"&&C.uid===g.uid&&Date.now()-(((k=C.timestamp)==null?void 0:k.toMillis())||0)<5e3})&&(yield ke({formData:u,user:g,customTiles:l,actionsList:h,title:"Settings Generated Board",tiles:w}));const L=u;if(L.hasLocalPlayers&&L.localPlayersData&&L.localPlayerSessionSettings)try{yield p(u.room,L.localPlayersData,L.localPlayerSessionSettings)}catch(C){console.error("Error creating local session:",C)}const ue=ft(u);c(ut(ae({},ue),{boardUpdated:!1,roomUpdated:!1,gameMode:_})),a(u.room)}),[e,t,s,f,d,i,o,l,c,a,p]);return b.useCallback((u,h)=>m(u,h),[m])}var mt=(e,t,n)=>new Promise((o,s)=>{var r=i=>{try{l(n.next(i))}catch(a){s(a)}},c=i=>{try{l(n.throw(i))}catch(a){s(a)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,c);l((n=n.apply(e,t)).next())});const $=new Map,z=fe;window.debugActionsCache=()=>{};window.clearActionsCache=()=>{$.clear()};function At(e){const{i18n:t,t:n}=j(),{currentLanguageMigrated:o,isHealthy:s,forceRecovery:r}=$e(),[c,l]=b.useState({}),[i,a]=b.useState(!0),[d,p]=b.useState(!1);b.useEffect(()=>{const u=()=>{e&&Array.from($.keys()).filter(y=>y.endsWith(`-${e}`)).forEach(y=>{$.delete(y)})};return t.on("languageChanged",u),()=>{t.off("languageChanged",u)}},[t,e]);const f=b.useMemo(()=>!e||!t.resolvedLanguage?"":`${t.resolvedLanguage}-${e}`,[t.resolvedLanguage,e]);b.useEffect(()=>{o&&f&&$.get(f)&&$.delete(f)},[o,f]),b.useEffect(()=>{if(f){const u=$.get(f);u&&Date.now()-u.timestamp<z&&(l(u.data),a(!1))}},[f]);const m=b.useCallback(()=>mt(null,null,function*(){if(!e||!f){console.warn("⚠️ useUnifiedActionList: Missing required params",{gameMode:e,cacheKey:f});return}if(!o)return;if(o&&!s&&!d){p(!0);try{yield r();return}catch(h){}}const u=$.get(f);if(u&&Date.now()-u.timestamp<z){l(u.data),a(!1);return}a(!0);try{const h=yield we(t.resolvedLanguage,e),y={};for(const g of h){const v={[n("none")]:[]},_={};g.intensities&&Array.isArray(g.intensities)&&g.intensities.sort((T,E)=>T.value-E.value).forEach(T=>{v[T.label]=[],_[T.value]=T.label});const w=g.type||"action";y[g.name]={label:g.label||g.name,type:w,actions:v,intensities:_}}$.set(f,{data:y,timestamp:Date.now()}),l(y)}catch(h){console.error("❌ useUnifiedActionList: Error loading unified actions",{error:h,locale:t.resolvedLanguage,gameMode:e,cacheKey:f}),l({})}finally{a(!1)}}),[e,t.resolvedLanguage,f,n,o,s,d,r]);return b.useEffect(()=>{f&&o&&m()},[m,f,o,s]),{actionsList:c,isLoading:i}}export{Pt as a,At as b,Ct as c,Oe as d,Lt as e,Ge as f,Re as g,ke as s,st as u,St as v};
//# sourceMappingURL=chunk-U-BuBlCh.js.map
