import{ak as K,r as x,j as e,A as z,aG as R,I as J,W as F,av as G,ar as b,Y as L,am as A,Q as $,T as w,au as o,aA as Q,R as V}from"./chunk-CJVoFoqV.js";import{C as _,A as Y,b as q,c as H}from"./chunk-CxcwKXog.js";import{C as M}from"./chunk-D9_D7Pb0.js";import{Q as O,u as U,e as X,R as Z,S as ee,v as te,s as se,T as ne}from"./chunk-DvmTZbFC.js";import{a9 as ie,a3 as re,aa as oe,F as ae}from"./chunk-CpqhyqeY.js";import{T as le}from"./chunk-DWTSEXP2.js";import{u as ce}from"./chunk-CsdNKD0V.js";import{u as de}from"./chunk-arCWr7CA.js";import"../assets/index-BHUshCQG.js";import"./schedule.tsx-dFnjltiV.js";import"./chunk-CaEDXWoe.js";import"./chunk-CdWLCell.js";import"./theme.tsx-D3MtnY0r.js";import"./chunk-KX2hDaPG.js";import"./chunk-Buz77Oyr.js";(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"8380c411008c81db0d03192c8a87321e8e40e84f"}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},m=new n.Error().stack;m&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[m]="088d4c39-20d9-42af-87a3-b92a95c0d729",n._sentryDebugIdIdentifier="sentry-dbid-088d4c39-20d9-42af-87a3-b92a95c0d729")})()}catch{}function ue({open:n,close:m,setAlert:l,board:r}){const{t:s}=K(),[p,f]=x.useState(""),[c,T]=x.useState(r.title||"");function B(i){try{return c.length?i.map((a,d)=>{const[h,...C]=a.split(`
`).filter(S=>S);if(h===void 0)throw l({message:s("importNoEmpty")});if(!/^\[.+\]$/.test(h))throw l({message:s("importInvalidTitle",{entry:d+1})});if(!C.length)throw l({message:s("importMissingDescription",{entry:d+1})});return{title:h?.replace(/\[|\]/g,""),description:C.join(`
`)}}):(l({message:s("importTitleRequired")}),null)}catch{return null}}const g=async()=>{const i=p.split(/~+/).filter(d=>d),a=B(i);if(!a)return null;try{if(JSON.stringify(r.tiles)===JSON.stringify(a))return l({message:s("importNoChange")}),null}catch{return l({message:s("error"),type:"error"}),null}return O({...r,title:c,tiles:a}),l({message:s("saved"),type:"success"}),m(),null},D=()=>{const i=r?.tiles?.map(a=>{if(!a)return"";const d=a.title||"",h=a.description||"";return`[${d}]
${h}`}).filter(Boolean);f(i?.join(`
~~
`)||"")},I=i=>{T(i.target.value)},E=async i=>{if(!i.target.value.length)return l({message:s("importTitleRequired")}),null;O({...r,title:i.target.value})};return x.useEffect(()=>{n&&D()},[n]),x.useEffect(()=>{T(r.title||"")},[r.title]),e.jsxs(e.Fragment,{children:[e.jsx(z,{fullWidth:!0,label:s("title"),value:c,onChange:I,onBlur:E}),e.jsx(z,{sx:{mt:2},multiline:!0,fullWidth:!0,value:p,onChange:i=>f(i.target.value),InputProps:{endAdornment:e.jsxs("div",{style:{display:"flex",flexDirection:"column",position:"sticky",top:0},children:[e.jsx(R,{title:s("save"),children:e.jsx(J,{size:"small",onClick:g,"aria-label":s("save"),children:e.jsx(ie,{color:"success"})})}),e.jsx(M,{text:p}),e.jsx(M,{text:`${window.location.href}?importBoard=${r.id}`,copiedText:s("copiedLink"),icon:e.jsx(re,{}),tooltip:s("copyShareLink")})]}),sx:{alignItems:"flex-start"}}})]})}function Ie({open:n,close:m,isMobile:l}){const r=ce(ne),[s,p]=x.useState(null),[f,c]=x.useState(0),[T,B]=x.useState(0),g=U()[0],{user:D}=de();if(!r)return null;const I=t=>{if(!t||!t.length)return null;const u=t[t.length-1];return u?.description?u.description.match(/\d+%/g):null},E=t=>{p(t)};async function i({title:t,tiles:u}){const y=u.map(({title:W})=>`* ${W} 
`);y.pop(),y.shift();let j=`### ${o("activated")}: ${t}
`;j+=`---
`,j+=[...new Set(y)].join(" "),j+=`---
`;const v=I(u);v&&v.length===3&&(j+=`* ${o("finishSlider")} ${v[0]}  | ${v[1]} | ${v[2]}`);const N=await te({title:t,gameBoard:JSON.stringify(u),settings:JSON.stringify(g)});N?.id&&await se({room:g?.room||"PUBLIC",user:D,text:j,type:"settings",gameBoardId:N.id,boardSize:u.length,gameMode:g?.gameMode})}const a=async()=>{const t=await X({isActive:0})||0;B(t)},d=t=>{Z(t.id),i(t),p({message:o("boardEnabled"),type:"success"})},h=t=>{t!==0&&c(t)},C=()=>{typeof f=="number"&&ee(f),c(0)},k=t=>(u,y)=>{B(y?t:0)},S=t=>!t.tiles||t.tiles.length!==(g?.roomTileCount||40),P=t=>S(t)?o("boardWrongSize",{size:g?.roomTileCount||40}):t.isActive?o("boardActive"):o("enableBoard");return e.jsxs(e.Fragment,{children:[e.jsxs(F,{fullScreen:l,open:n,onClose:m,PaperProps:{sx:{maxHeight:"100%",height:"100%"}},children:[e.jsxs(G,{children:[e.jsx(b,{i18nKey:"manageGameBoards"}),e.jsx(_,{close:m})]}),e.jsxs(L,{style:{overflowY:"scroll"},children:[e.jsxs(A,{sx:{mb:1},children:[e.jsx($,{variant:"outlined",onClick:a,endIcon:e.jsx(oe,{}),sx:{float:"right"},children:e.jsx(b,{i18nKey:"add"})}),e.jsx(w,{children:e.jsx(b,{i18nKey:"gameBoardDescription"})})]}),r.map(t=>e.jsxs(Y,{expanded:T===t.id,onChange:k(t.id||0),children:[e.jsxs(q,{children:[e.jsxs(A,{children:[e.jsx(w,{variant:"body1",children:t.title}),e.jsx(w,{variant:"body2",children:o("tilesCount",{count:t.tiles?.length||0})})]}),e.jsxs(A,{style:{marginLeft:"auto"},justifyContent:"flex-end",children:[e.jsx(R,{title:P(t),children:e.jsx("div",{style:{display:"inline-block"},children:e.jsx(Q,{checked:!!t.isActive,disabled:!!t.isActive||S(t),onChange:()=>d(t),size:"small"})})}),e.jsx(R,{title:o("delete"),children:e.jsx("span",{style:{display:"inline-block"},children:e.jsx(J,{onClick:()=>h(t.id||0),size:"small",component:"span",children:e.jsx(ae,{color:"error"})})})})]})]}),e.jsx(H,{children:e.jsx(ue,{open:n,close:()=>k(t.id||0)(null,!1),setAlert:E,board:t})})]},t.id))]})]}),e.jsx(le,{open:!!s?.message,type:s?.type||"error",close:()=>p(null),children:s?.message}),e.jsxs(F,{open:!!f,onClose:()=>c(0),children:[e.jsxs(G,{children:[o("deleteBoard"),e.jsx(_,{close:()=>c(0)})]}),e.jsx(L,{children:e.jsx(w,{variant:"body1",children:o("confirmDeleteBoard",{title:r.find(t=>t.id===f)?.title})})}),e.jsxs(V,{children:[e.jsx($,{onClick:()=>c(0),children:o("cancel")}),e.jsx($,{onClick:C,children:o("delete")})]})]})]})}export{Ie as default};
//# sourceMappingURL=index.tsx-7nJl4w5r.js.map
