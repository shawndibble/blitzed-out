import{R,aj as U,b as t,j as v}from"./chunk-DCqCmTw7.js";import{v as w}from"./chunk-5SGEHjMG.js";import{u as E}from"./chunk-BKkrGAF_.js";import"./chunk-rJHcTq4h.js";import"./chunk-BxyRzOKK.js";import"./chunk-DyYP0jr7.js";(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};n.SENTRY_RELEASE={id:"b82d01bea29447e452b49ba3e85b9fac2f7942a4"}})();try{(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="7990515d-4d29-4ce0-8bd8-7e9cba63dfa5",n._sentryDebugIdIdentifier="sentry-dbid-7990515d-4d29-4ce0-8bd8-7e9cba63dfa5")})()}catch(n){}function S(n){if(!n||typeof n!="object")return!1;const e=n;return typeof e.displayName=="string"&&typeof e.uid=="string"&&(e.lastSeen instanceof Date||typeof e.lastSeen=="number"||typeof e.lastSeen=="string")}const h=R.createContext(void 0);function C(n){const{id:e}=U(),{onlineUsers:f,setUsers:l,setRoom:a,clearUsers:o,flushPendingUpdates:d}=E(),i=t.useRef(null),u=t.useRef(e),c=t.useCallback(b=>{if(b===null)o();else{const p={};Object.entries(b).forEach(([y,r])=>{if(S(r)){const m={...r,lastSeen:r.lastSeen instanceof Date?r.lastSeen:new Date(r.lastSeen)};p[y]=m}else console.warn(`Invalid user data for uid ${y}:`,r)}),l(p)}},[l,o]),s=t.useCallback(()=>{i.current&&(i.current(),i.current=null),d()},[d]);t.useEffect(()=>{if(u.current!==e&&(a(e||null),u.current=e),!e){s(),o();return}return s(),w(e,c),i.current=null,s},[e,a,o,c,s]),t.useEffect(()=>s,[s]);const g=t.useMemo(()=>({onlineUsers:f}),[f]);return v.jsx(h.Provider,{value:g,...n})}export{h as UserListContext,C as UserListProvider};
//# sourceMappingURL=userList.tsx-zasqzma4.js.map
