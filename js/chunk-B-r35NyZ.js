const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/chunk-DoS8VIVs.js","js/chunk-B0_VBOvR.js","js/chunk-Bfa-QeNm.js","js/index.tsx-3pb9kQNx.js","js/chunk-C7PvMB7v.js","js/chunk-BFN7SMq0.js","js/chunk-DjfcUfB3.js","js/chunk-DyBi9s21.js","assets/index-BHjYcaRD.js","js/chunk-C8C4XuLE.js","js/chunk-DIZE3aKd.js","js/chunk-DOyVz6k9.js","js/chunk-Cviq917M.js","js/chunk-G27VazTP.js","js/chunk-CH6uyvQ0.js","js/chunk-BASZ8lRo.js","js/chunk-RtjQ02-D.js","js/chunk-B4PEA_xj.js","js/chunk-DC_novU2.js","js/chunk-yLOK5aTh.js","js/index.tsx-S27112q7.js","js/chunk-D3pk38JL.js","js/chunk-Dz42TCZS.js","js/chunk-DVc2iGAc.js","js/index.tsx-Dv8l7DQj.js","js/index.tsx-CTk-UfWr.js","js/chunk-BfvZTPVb.js","js/chunk-B1nIT8MX.js","js/index.tsx-HRBOc63d.js","js/chunk-2jB24Uga.js"])))=>i.map(i=>d[i]);
import{_ as W,p as le,d as te,l as Y,a as xe,s as be,g as ye,b as je,u as ve,c as Se}from"../assets/index-BHjYcaRD.js";import{ae as B,r as i,j as t,aA as Ce,aB as Re,G as Te,aa as O,T as L,ax as P,a1 as se,Q as _,a7 as A,ac as Me,as as De,az as $,O as we,L as ke,P as Ne,aC as Ae,n as Be,M as Ee,W as Oe,aD as Le,Y as Pe,aE as _e,aF as Ie,A as H,C as $e,R as Ge,aG as Fe,ad as Ue,ab as ze}from"./chunk-B0_VBOvR.js";import{u as ue,c as Ve}from"./chunk-Bfa-QeNm.js";import We from"./index.tsx-CTk-UfWr.js";import{C as Ke}from"./chunk-Dz42TCZS.js";import{u as ce,C as He,G as Je,s as Qe}from"./chunk-D3pk38JL.js";import{e as de,a as Ye,i as F,b as me}from"./chunk-C7PvMB7v.js";import{u as z}from"./chunk-DyBi9s21.js";import{t as qe}from"./chunk-BFN7SMq0.js";import{u as K}from"./chunk-RtjQ02-D.js";import{u as q}from"./chunk-DC_novU2.js";import{u as fe,g as Xe,R as Ze}from"./chunk-BfvZTPVb.js";import{T as pe}from"./chunk-Cviq917M.js";import et from"./index.tsx-HRBOc63d.js";import{u as tt}from"./chunk-B1nIT8MX.js";import{e as X,t as Z,v as U,D as ge,F as he,H as st,I as nt}from"./chunk-C8C4XuLE.js";import{l as I}from"./chunk-yLOK5aTh.js";import{u as rt,s as at}from"./chunk-BASZ8lRo.js";import{i as ot}from"./chunk-DIZE3aKd.js";import{u as it}from"./chunk-DOyVz6k9.js";import{N as ne}from"./chunk-2jB24Uga.js";import{A as lt,C as re,c as ut}from"./chunk-DjfcUfB3.js";const ct=e=>({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxWidth:800,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,[e.breakpoints.down("sm")]:{width:"90%"}});function dt({open:e,text:s="",displayName:r="",handleClose:n,stopAutoClose:a=()=>null,nextPlayer:u=null,isMyMessage:l=!1}){const{t:c}=B(),[f,g]=i.useState(!1),y=s?.match(/#\d*:.*(?=\n)/gs),S=de(s)||"",x=Ye(s,c("seconds")),{timeLeft:h,togglePause:v}=ce(20,!1),[m,o]=i.useState(!0),d=u?.displayName,p=i.useCallback(()=>{v(),a(),o(!1)},[v,a,o]),b=i.useCallback(()=>{p(),g(!0)},[p]),w=i.useCallback(()=>{g(!1)},[]);return t.jsxs("div",{children:[t.jsx(Ce,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:e,onClose:n,slots:{backdrop:Re},slotProps:{backdrop:{timeout:500}},children:t.jsx(Te,{in:e,children:t.jsxs(O,{sx:ct,children:[t.jsx(L,{id:"transition-modal-title",variant:"h6",component:"h2",children:`${y} ${c("for")} ${r}`}),t.jsx(Ke,{close:n}),t.jsx(L,{id:"transition-modal-description",variant:"h4",sx:{mt:2},children:S}),t.jsx("br",{}),t.jsx(L,{variant:"caption",children:m?t.jsx(P,{i18nKey:"autoCloseModal",values:{timeLeft:h}}):t.jsx(P,{i18nKey:"autoCloseStopped"})}),t.jsx("br",{}),x?.length&&t.jsxs(t.Fragment,{children:[t.jsx(P,{i18nKey:"timers"}),x.map(j=>t.jsx(He,{textString:j,preventParentClose:p},j))]}),!!u&&t.jsxs(O,{textAlign:"center",children:[t.jsx(se,{style:{margin:"1rem 0 0.5rem"}}),t.jsx(L,{variant:"body1",children:u.isSelf?t.jsx(P,{i18nKey:"yourTurn"}):t.jsx(P,{i18nKey:"nextPlayersTurn",values:{player:d}})})]}),!!l&&s.includes(c("finish"))&&t.jsxs(O,{textAlign:"center",children:[t.jsx(se,{style:{margin:"1rem 0 0.5rem"}}),t.jsx(_,{onClick:b,children:t.jsx(L,{children:c("playAgain")})})]})]})})}),t.jsx(Je,{isOpen:f,close:w})]})}const mt="/audio/roll-dice-DysgIh_A.mp3",ft="/audio/message-CBVROrdp.mp3";function V(){return V=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V.apply(null,arguments)}function pt(e,s){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(s.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function gt(e){i.useEffect(e,[])}var ht=["id","volume","playbackRate","soundEnabled","interrupt","onload"];function ae(e,s){var r={},n=r.volume,a=n===void 0?1:n,u=r.playbackRate,l=u===void 0?1:u,c=r.soundEnabled,f=c===void 0?!0:c,g=r.interrupt,y=g===void 0?!1:g,S=r.onload,x=pt(r,ht),h=A.useRef(null),v=A.useRef(!1),m=A.useState(null),o=m[0],d=m[1],p=A.useState(null),b=p[0],w=p[1],j=function(){typeof S=="function"&&S.call(this),v.current&&d(this.duration()*1e3),w(this)};gt(function(){return W(()=>import("./chunk-DoS8VIVs.js").then(C=>C.h),__vite__mapDeps([0,1,2])).then(function(C){if(!v.current){var E;h.current=(E=C.Howl)!==null&&E!==void 0?E:C.default.Howl,v.current=!0,new h.current(V({src:Array.isArray(e)?e:[e],volume:a,rate:l,onload:j},x))}}),function(){v.current=!1}}),A.useEffect(function(){h.current&&b&&w(new h.current(V({src:Array.isArray(e)?e:[e],volume:a,onload:j},x)))},[JSON.stringify(e)]),A.useEffect(function(){b&&(b.volume(a),x.sprite||b.rate(l))},[b,a,l]);var M=A.useCallback(function(C){typeof C>"u"&&(C={}),!(!b||!f&&!C.forceSoundEnabled)&&(y&&b.stop(),C.playbackRate&&b.rate(C.playbackRate),b.play(C.id))},[b,f,y]),R=A.useCallback(function(C){b&&b.stop(C)},[b]),T=A.useCallback(function(C){b&&b.pause(C)},[b]),k=[M,{sound:b,stop:R,pause:T,duration:o}];return k}async function xt(e,s){try{await qe.speak(e,s,-2)}catch(r){console.error("TTS failed:",r)}}function bt(){const{i18n:e}=B(),{user:s}=K(),{messages:r}=q(),[n,a]=i.useState(!1),[u]=ae(mt),[l]=ae(ft),[c]=z(),{playerDialog:f,othersDialog:g,mySound:y,otherSound:S,chatSound:x,readRoll:h,voicePreference:v}=c||{},m=i.useMemo(()=>[...r].pop(),[r]),o=i.useCallback(async T=>{if(T)try{await xt(T,v)}catch(k){console.error("Failed to speak text:",k)}},[v]),d=i.useMemo(()=>{if(!m?.timestamp)return!1;const T=le(m.timestamp);return T?te(T).diff(te(),"seconds")>=-2:!1},[m]),p=i.useMemo(()=>m?.uid===s?.uid,[m,s]),b=!!(f&&p),w=!!(g&&!p),j=(p&&y||!p&&S)&&m?.type==="actions",M=p&&h&&m?.type==="actions",R=x&&m?.type==="chat";return i.useEffect(()=>{if(Qe(e.resolvedLanguage||e.language),d&&m?.type==="actions"&&(b||w)&&a(m),d&&m){if(j&&u(),M){const T=de(m?.text);o(T)}R&&l()}},[e.resolvedLanguage,e.language,m,p,b,w,j,M,R,u,l,o,d]),{message:n,setMessage:a,isMyMessage:!!p}}const yt=()=>{const{t:e}=B(),{message:s,setMessage:r,isMyMessage:n}=bt(),a=fe(s),u=i.useRef(void 0);i.useEffect(()=>(s&&(u.current=setTimeout(()=>r(!1),21e3)),()=>{u.current&&clearTimeout(u.current)}),[s,r]);const l=i.useCallback(()=>{u.current&&clearTimeout(u.current),r(!1)},[r]),c=i.useCallback(()=>{u.current&&clearTimeout(u.current)},[]);return!s||typeof s!="object"||!s.text||s.text.includes(e("start"))?null:t.jsx(dt,{text:s?.text,displayName:s?.displayName,open:!0,handleClose:l,stopAutoClose:c,nextPlayer:a,isMyMessage:n})};function jt(){const{messages:e}=q(),[s,r]=i.useState(!1),n=Y(e,"actions"),a=xe(e),u=fe(n),{playerDialog:l,othersDialog:c}=z()[0];if(i.useEffect(()=>{!u||a!==n||r(!0)},[u,a,n]),!n||!u)return null;const f=u?.isSelf;return!c&&f||!l&&!f?t.jsx(pe,{open:s,close:()=>r(!1),type:f?"error":"info",vertical:"top",horizontal:"center",disableAutoHide:!0,children:f?t.jsx(P,{i18nKey:"yourTurn"}):t.jsx(P,{i18nKey:"playersTurn",values:{player:u.displayName}})}):null}const{t:vt}=Me;function St(e){return e.replace(/(?:^|\.\s|!\s)(\w)/g,s=>s.toUpperCase())}function Ct(e,s,r){const n=Math.random(),a=e.includes("{dom}")&&e.includes("{sub}"),u=s==="vers";function l(c){if(c==="{player}")return!0;const f=c==="{dom}"||c==="{sub}";if(!u&&c===`{${s}}`||!a&&u&&f)return!0;if(a&&u){const g=c==="{dom}"&&n<.5,y=c==="{sub}"&&n>=.5;return g||y}return!1}return e.replace(/{(player|dom|sub)}/g,c=>l(c)?r:c)}function Rt(e,s,r){let n=Ct(e,s,r);if(!n.includes(r)&&s!=="vers"&&(n.includes("{dom}")||n.includes("{sub}"))){const u=new RegExp(`\\{${s}\\}`);n.match(u)?n=n.replace(u,r):n=n.replace(/{(dom|sub)}/,r)}return n=n.replace(/{(dom|sub)}/g,vt("anotherPlayer")),St(n)}function Tt(e){const s=e.filter(a=>a).map(a=>a.split(": ")),r=[];s.forEach((a,u)=>{if(Number(a[1])===0)return;const l=Array(Number(a[1])).fill(u);r.push(...l)});const n=r[Math.floor(Math.random()*r.length)];return s.map(([a])=>a)[n]?.replace(/(\r\n|\n|\r)/gm,"")||""}function Mt(e,s,r){if(!e)return"";const n=e.split("%");return n.length<=1?Rt(e,s,r||""):Tt(n)}function Dt(e,s,r=[]){const{user:n}=K(),{t:a}=B(),[u]=z(),l=tt(),c=r.length,f=(m,o=0)=>({id:o,title:m.title||"",description:m.description,index:o,players:[],current:null,isTransparent:!1,className:""}),[g,y]=i.useState(r[0]?f(r[0],0):f({title:"",description:""},0)),S=c-1,x=i.useRef(0),h=i.useCallback((m,o,d,p)=>{if(!m){console.error("Tile not found at location:",d);return}let b="";const w=Mt(m.description||"",u.role||"sub",n?.displayName||"");o!==-1&&(b+=`${a("roll")}: ${o}
`),b+=`#${d+1}: ${m.title||a("unknownTile")}
`,b+=`${a("action")}: ${w}`,be({room:e,user:n,text:p?p+b:b,type:"actions"})},[e,n,a,u.role]),v=i.useCallback(m=>{if(m===-1)return{preMessage:`${a("restartingGame")}
`,newLocation:0};const o=l.find(p=>p.isSelf)?.location||0;if(o===S)return{preMessage:`${a("alreadyFinished")}
`,newLocation:m};const d=m+o;return d>=S?{newLocation:S}:{newLocation:d}},[a,l,S]);return i.useEffect(()=>{const m=Array.isArray(s.value)?s.value[0]:s.value,o=s.time;if(m===0||o<=x.current)return;x.current=o;const{preMessage:d,newLocation:p}=v(m);p>=0&&p<r.length&&r[p]?(y(f(r[p],p)),h(r[p],m,p,d)):console.error(`Invalid location or missing tile: ${p}, gameBoard length: ${r.length}`)},[s,r,h,v]),{tile:g,playerList:l}}async function wt({newRoom:e,oldRoom:s,newDisplayName:r,removeOnDisconnect:n=!0}){const u=X().currentUser;if(!u){I.warn("Cannot set presence: user not authenticated");return}const l=Z();try{const c=(s||"").toUpperCase(),f=(e||"").toUpperCase();if(s&&c!==f){const S=U(l,`users/${u.uid}`);await ge(S)}const g=U(l,`users/${u.uid}`),y={displayName:r||"Unknown",isAnonymous:u.isAnonymous,room:f,joinedAt:Date.now(),lastSeen:Date.now()};await he(g,y),n&&st(g).remove()}catch(c){I.error("Error setting user presence:",c)}}async function oe(){const s=X().currentUser;if(!s)return;const r=Z(),n=U(r,`users/${s.uid}`);try{const a=U(r,`users/${s.uid}`),u=await nt(a);if(u.exists()){const c={...u.val(),lastSeen:Date.now()};await he(n,c)}else I.warn("No existing user data found, skipping heartbeat update")}catch(a){I.error("Error updating presence heartbeat:",a)}}async function ie(){const s=X().currentUser;if(!s)return;const r=Z(),n=U(r,`users/${s.uid}`);try{await ge(n)}catch(a){I.error("Error removing user presence:",a)}}function kt(){const e=setInterval(()=>{oe()},6e4);return oe(),()=>{clearInterval(e)}}function Nt(e,s){const{user:{displayName:r}}=K(),[n,a]=i.useState(null),[u,l]=i.useState(r||"");i.useEffect(()=>{(n!==e||r!==u)&&(wt({newRoom:e,oldRoom:n,newDisplayName:r||"",removeOnDisconnect:e?.toUpperCase()==="PUBLIC"}),a(e),l(r||""))},[e,r,n,u,s]),i.useEffect(()=>{let c=null;return e&&(c=kt()),()=>{c&&c()}},[e]),i.useEffect(()=>{const c=()=>{ie()};return window.addEventListener("beforeunload",c),()=>{window.removeEventListener("beforeunload",c),ie()}},[])}function At(e,s){const r=i.useRef(void 0);return i.useCallback((...n)=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>e(...n),s)},[e,s])}function Bt(e,s){const{i18n:n,t:a}=B(),{user:u}=K(),[l,c]=z(),f=ue(()=>ye(l?.gameMode)),{messages:g,isLoading:y}=q(),[S,x]=i.useState("1d6"),[h,v]=i.useState(""),m=rt(),o=i.useRef(!1),d=i.useRef(!0),p=i.useCallback(async(j,M=null)=>{if(!o.current){o.current=!0;try{const{gameMode:R,newBoard:T}=await m(j),k={formData:{...l,...j},user:u,customTiles:f,actionsList:await ot(n.resolvedLanguage,R||"online"),tiles:T,title:a("settingsGenerated")};M&&(k.reason=a("rebuiltBoard",{messageUser:M})),await at(k)}finally{setTimeout(()=>{o.current=!1},500)}}},[l,u,f,n.resolvedLanguage,a,m]),b=i.useCallback(async()=>{l?.room!==e&&(await c({...l,room:e}),await p({...l,roomUpdated:!0,room:e}))},[l,e,c,p]),w=At(b,200);return i.useEffect(()=>{if(!(y||!g.length))try{const j=Y(g,"room");if(j){const M=JSON.parse(j.settings),{roomDice:R,roomBackgroundURL:T,roomTileCount:k}=M;let C="1d6";!F(e)&&R&&(C=R),x(C),v(T||"");const E=le(j.timestamp),N=(E?Date.now()-E.getTime():1/0)<300*1e3;j.uid!==u?.uid&&k&&s?.length&&k!==s?.length&&N&&!o.current&&p(M,j.displayName)}}catch(j){console.error("Error processing room message:",j)}},[g,y,e,u,s,p]),i.useEffect(()=>{if(!y)try{const j=Y(g,"room");if(j||!F(e)&&!j||F(e)&&!me(l?.gameMode||""))return;if(d.current){d.current=!1,l?.roomBackgroundURL?.length&&v(l.roomBackgroundURL);return}const M=e!==l?.room,R=l&&typeof l.room<"u",T=s?.length,k=!o.current;if(R&&M&&T&&k){w();return}l?.roomBackgroundURL?.length&&v(l.roomBackgroundURL)}catch(j){console.error("Error in room change effect:",j)}},[e,l,s,g,y,w]),{roller:S,roomBgUrl:h}}function Et(e,s){const[r,n]=i.useState(null),[a,u]=De(),l=a.get("importBoard"),{t:c}=B(),f=i.useCallback(()=>{n(null)},[]),g=i.useCallback(x=>{try{const h=JSON.parse(x);return Array.isArray(h)?h:null}catch(h){return I.warn("Failed to parse game board JSON:",!1,h),null}},[]),y=i.useCallback(x=>{try{return x?JSON.parse(x):{}}catch(h){return I.warn("Failed to parse settings JSON:",!1,h),{}}},[]),S=i.useCallback(async()=>{if(u({}),!l)return;const x=await je(l);if(!x?.gameBoard)return n(c("failedBoardImport"));const h=g(x.gameBoard);if(!h)return n(c("failedBoardImport"));const v=x?.title!==c("settingsGenerated")?x.title:c("importedBoard");ve({...x,title:v,tiles:h,isActive:1});const m=y(x?.settings);s({...e,...m}),r!==c("updated")&&n(c("updated"))},[l,g,y,e,s,c,r,u]);return i.useEffect(()=>{l&&S()},[l,S]),[r,f]}const Ot=({selectedRoll:e,handleMenuItemClick:s})=>{const[r,n]=i.useState(!1),a=i.useRef(null),u=()=>{n(f=>!f)},l=f=>{f.target instanceof Node&&a.current?.contains(f.target)||n(!1)},c=new Map;return c.set("restart",$("restart")).set("manual",$("manual")).set("30",$("auto30")).set("60",$("auto60")).set("90",$("auto90")).set("custom",$("setTimer")),t.jsxs(t.Fragment,{children:[t.jsx(_,{size:"small","aria-controls":r?"split-button-menu":void 0,"aria-expanded":r?"true":void 0,"aria-label":"select roll options","aria-haspopup":"menu",onClick:u,ref:a,children:t.jsx(lt,{})}),t.jsx(we,{sx:{zIndex:1},open:r,anchorEl:a.current,transition:!0,disablePortal:!0,placement:"top-end",children:({TransitionProps:f})=>t.jsx(ke,{...f,style:{transformOrigin:"right bottom"},children:t.jsx(Ne,{children:t.jsx(Ae,{onClickAway:l,children:t.jsx(Be,{id:"split-button-menu",autoFocusItem:!0,children:Array.from(c).map(([g,y])=>t.jsx(Ee,{selected:g===e,onClick:()=>s(g),children:y},g))})})})})})]})},G=10,Lt=({isOpen:e,onClose:s,onSubmit:r})=>{const{t:n}=B(),[a,u]=i.useState(30),[l,c]=i.useState(!1),[f,g]=i.useState(!1),[y,S]=i.useState(20),[x,h]=i.useState(60),v=()=>{if(f){let o=Number.parseInt(String(y),10),d=Number.parseInt(String(x),10);Number.isNaN(o)?(o=l?1:G,S(o)):!l&&o<G&&(o=G),Number.isNaN(d)||d<o?(d=o,h(d)):d===0&&(d=180,h(d)),l&&(o*=60,d*=60);const p=Math.floor(Math.random()*(d-o+1))+o;r(p,{isRange:!0,min:o,max:d})}else{let o=Number.parseInt(String(a),10);Number.isNaN(o)?(o=l?1:G,u(o)):l?o*=60:o<G&&(o=G),r(o,{isRange:!1})}s()},m=()=>{u(o=>{const d=Number.parseFloat(String(o));return Number.isNaN(d)||d<=0?o:l?(d*60).toString():(d/60).toString()}),S(o=>{const d=Number.parseFloat(String(o));return Number.isNaN(d)||d<=0?o:l?(d*60).toString():(d/60).toString()}),h(o=>{const d=Number.parseFloat(String(o));return Number.isNaN(d)||d<=0?o:l?(d*60).toString():(d/60).toString()}),c(o=>!o)};return t.jsxs(Oe,{open:e,onClose:s,maxWidth:"xs",children:[t.jsx(Le,{children:n("setTimer")}),t.jsxs(Pe,{children:[t.jsx(O,{sx:{mb:2},children:t.jsx(_e,{control:t.jsx(Ie,{checked:f,onChange:o=>g(o.target.checked)}),label:n("useRandomRange")})}),f?t.jsxs(O,{children:[t.jsx(L,{variant:"subtitle2",children:n("randomTimerRange")}),t.jsxs(O,{sx:{display:"flex",gap:2,my:2},children:[t.jsx(H,{label:n("minValue"),type:"number",value:y,onChange:o=>{const d=parseInt(o.target.value,10);S(d)},fullWidth:!0}),t.jsx(L,{variant:"body1",sx:{alignSelf:"center"},children:"-"}),t.jsx(H,{label:n("maxValue"),type:"number",value:x,onChange:o=>{const d=parseInt(o.target.value,10);h(Math.max(Number(y),d))},fullWidth:!0})]}),t.jsxs(_,{onClick:m,variant:"outlined",size:"small",children:[n(l?"minutes":"seconds"),t.jsx(re,{sx:{ml:1}})]})]}):t.jsx(H,{autoFocus:!0,type:"number",value:a,onChange:o=>u(o.target.value),sx:{width:"15rem"},slotProps:{input:{endAdornment:t.jsx($e,{position:"end",children:t.jsxs(_,{onClick:m,variant:"text",children:[n(l?"minutes":"seconds"),t.jsx(re,{sx:{ml:1}})]})})}}})]}),t.jsxs(Ge,{children:[t.jsx(_,{onClick:s,children:n("cancel")}),t.jsx(_,{onClick:v,children:n("set")})]})]})};function Pt(e){return/^-?\d+$/.test(String(e))}function J(e,s,r){let n=0;for(let a=0;a<Number(e);a+=1)n+=Math.floor(Math.random()*Number(s))+1;r(n)}const _t=i.memo(function({setRollValue:s,dice:r,isEndOfBoard:n}){const{t:a}=B(),[u,l]=i.useState(!1),[c,f]=i.useState("manual"),[g,y]=i.useState(0),[S,x]=i.useState(a("roll")),{timeLeft:h,setTimeLeft:v,togglePause:m,isPaused:o}=ce(g),[d,p]=i.useState(!1),[b,w]=i.useState({isRange:!1,min:30,max:120}),j=i.useCallback(D=>{s(D)},[s]),[M,R]=r.split("d"),T=()=>{if(c==="manual"){J(M,R,j),l(!0),setTimeout(()=>l(!1),4e3);return}o&&h===g&&J(M,R,j),m()},k=i.useCallback(D=>{if(D==="restart"){j(-1);return}if(f(String(D)),D==="custom"){p(!0);return}if(Pt(D)){o||m();const N=Number(D);y(N),v(N)}},[o,v,m,j]),C=()=>{p(!1)},E=(D,N={isRange:!1})=>{o||m(),y(D),v(D),w({...b,...N}),f("custom"),p(!1)};return i.useEffect(()=>{n&&m()},[n,m]),i.useEffect(()=>{if(u)x(a("wait"));else if(c==="manual")x(a("roll"));else if(o)x(`${a("play")} (${h})`);else if(h>0)x(`${a("pause")} (${h})`);else if(h===0&&!o&&c!=="manual"){J(M,R,j);let D;if(b.isRange){const{min:N,max:ee}=b;D=Math.floor(Math.random()*(ee-N+1))+N}else D=g;y(D),v(D),x(`${a("pause")} (${D})`)}},[u,c,h,o,g,b,a,M,R,j,v]),t.jsxs(t.Fragment,{children:[t.jsxs(Fe,{variant:"contained",className:"dice-roller",children:[t.jsxs(_,{"aria-label":a("roll"),onClick:T,disabled:u,size:"large",children:[t.jsx(ut,{sx:{mr:1}}),S]}),t.jsx(Ot,{selectedRoll:c,handleMenuItemClick:k})]}),t.jsx(Lt,{isOpen:d,onClose:C,onSubmit:E})]})}),It=i.lazy(()=>W(()=>import("./index.tsx-3pb9kQNx.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),$t=i.lazy(()=>W(()=>import("./index.tsx-S27112q7.js"),__vite__mapDeps([20,1,2,16,8,9,6,18,15,4,7,17,19,10,11,12,13,14,21,22,5,23]))),Gt=i.lazy(()=>W(()=>import("./index.tsx-Dv8l7DQj.js"),__vite__mapDeps([24,1,2,16,8,9,6,23,25,12,19,22,21,11,15,4,7,17,18,5,10,13,14,26,27,28,29])));function Q(){return t.jsx(O,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100px",children:t.jsx(ze,{size:24})})}function Ft(){const e=Ue(),s=e.id||"",r=it(),{t:n}=B(),[a,u]=z();Nt(s);const[l,c]=i.useState({value:0,time:0}),f=ue(Se)?.tiles,g=i.useCallback(C=>{c({value:C,time:Date.now()})},[]),{playerList:y,tile:S}=Dt(s,l,f),{roller:x,roomBgUrl:h}=Bt(s,f),[v,m]=Et(a,u);if(!f||!f.length||!Object.keys(a).length||F(s)&&!me(a.gameMode))return t.jsxs(t.Fragment,{children:[t.jsx(ne,{room:e.id,playerList:y}),t.jsx(et,{open:!0})]});const{isVideo:o,url:d}=Xe(a,s,h),p=o?"video-adjust":"",w=d&&(o||!o&&d)?"":"default-room-background",{background:j,roomBackground:M}=a,R=!F(s)&&M!=="app"||j!=="color",T=t.jsx(i.Suspense,{fallback:t.jsx(Q,{}),children:t.jsx(Gt,{playerList:y,isTransparent:R,gameBoard:f,settings:a})}),k=t.jsx("div",{className:"messages-container",children:t.jsxs(i.Suspense,{fallback:t.jsx(Q,{}),children:[t.jsx($t,{room:s,isTransparent:R,currentGameBoardSize:f.length}),t.jsx(We,{room:s,isTransparent:R})]})});return t.jsxs(t.Fragment,{children:[t.jsx(ne,{room:s,playerList:y}),t.jsx(_t,{setRollValue:g,dice:x,isEndOfBoard:S?.index!==void 0&&S.index>=(f?.length??0)-1}),t.jsx(Ze,{isVideo:o,url:d}),t.jsx(jt,{}),r?t.jsx(i.Suspense,{fallback:t.jsx(Q,{}),children:t.jsx(It,{tab1:T,tab2:k})}):t.jsxs(O,{className:Ve("desktop-container",p,w),children:[T,k]}),t.jsx(yt,{}),t.jsx(pe,{type:v===n("updated")?"success":"error",open:!!v,close:m,children:v})]})}const cs=Object.freeze(Object.defineProperty({__proto__:null,default:Ft},Symbol.toStringTag,{value:"Module"}));export{Rt as a,cs as i};
