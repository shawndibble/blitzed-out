import{u as E,b as u,j as n,au as H,s as Xr,ar as f,aS as Cr,t as x,a6 as z,I as ye,aT as Le,M as I,aU as qe,aV as Te,av as J,Q as B,O as M,ax as W,aW as en,aL as D,a8 as rn,aA as nn,aa as tn,S as ae,aP as ne,a4 as sn,a3 as q,aw as y,aX as ln,aY as an,W as Ir,aZ as on,aE as ce,az as Ee,aF as te,ay as cn,ae as re,a_ as dn,at as L,aI as un,aK as pn,aJ as fn,a$ as ke,aj as hn,ac as mn,ab as xe}from"./chunk-CVSdvP5Z.js";import{n as yn,M as xn,E as Tr,o as gn,V as vn,d as Ve,p as Re,q as Ar,b as Ne,r as jn,H as F,s as Er,t as bn,u as _n,T as Pn,W as wn}from"./chunk-_SwOSjSw.js";import{l as On}from"./chunk-BeueL4UK.js";import{x as kr}from"./chunk-B-cyqPC2.js";import{i as U,d as de,u as Sn,f as ge}from"./chunk-guvQFVv-.js";import{a as $n,u as Cn}from"./chunk-BO6dzI_Q.js";import{u as In,C as Tn}from"./chunk-C9iFBQh5.js";import{b as An}from"./chunk-CNqt7FHs.js";import{T as En}from"./chunk-84IffDWI.js";import{a as kn,b as Vn}from"./chunk-U-BuBlCh.js";(function(){var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};e.SENTRY_RELEASE={id:"874067a760cfa9079dd7f585e4ceff298b0e879f"}})();try{(function(){var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="01cf7bc4-c167-4cfa-8fac-161164322695",e._sentryDebugIdIdentifier="sentry-dbid-01cf7bc4-c167-4cfa-8fac-161164322695")})()}catch(e){}var Vr=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});const Lr=[{id:"tritone",name:"Tri-tone",frequency:1318,type:"sine",duration:400,category:"classic",frequencies:[1318,1568,1175]},{id:"rebound",name:"Rebound",frequency:800,type:"triangle",duration:350,category:"classic"},{id:"chime",name:"Chime",frequency:1e3,type:"sine",duration:500,category:"classic",frequencies:[1e3,1200,1400]},{id:"boop",name:"Boop",frequency:600,type:"sine",duration:150,category:"classic"},{id:"breeze",name:"Breeze",frequency:400,type:"triangle",duration:600,category:"classic",frequencies:[400,500,600,500]},{id:"pong",name:"Pong",frequency:1100,type:"square",duration:200,category:"classic"},{id:"glass",name:"Glass",frequency:1800,type:"sine",duration:300,category:"classic",frequencies:[1800,1600,1400]},{id:"funk",name:"Funk",frequency:220,type:"sawtooth",duration:400,category:"classic"}],qr=[{id:"c4",name:"C Note",frequency:261.63,type:"sine",duration:300,category:"musical"},{id:"d4",name:"D Note",frequency:293.66,type:"sine",duration:300,category:"musical"},{id:"e4",name:"E Note",frequency:329.63,type:"sine",duration:300,category:"musical"},{id:"f4",name:"F Note",frequency:349.23,type:"sine",duration:300,category:"musical"},{id:"g4",name:"G Note",frequency:392,type:"sine",duration:300,category:"musical"},{id:"ascending",name:"Ascending",frequency:261.63,type:"triangle",duration:800,category:"musical",frequencies:[261.63,293.66,329.63,349.23]},{id:"descending",name:"Descending",frequency:523.25,type:"triangle",duration:800,category:"musical",frequencies:[523.25,466.16,415.3,369.99]},{id:"chord",name:"Major Chord",frequency:261.63,type:"sine",duration:600,category:"musical",frequencies:[261.63,329.63,392]},{id:"arpeggio",name:"Arpeggio",frequency:261.63,type:"triangle",duration:1e3,category:"musical",frequencies:[261.63,329.63,392,523.25]}],Rr=[{id:"bell",name:"Bell",frequency:800,type:"sine",duration:200,category:"notification"},{id:"ding",name:"Ding",frequency:1200,type:"square",duration:150,category:"notification"},{id:"chirp",name:"Chirp",frequency:1500,type:"sine",duration:80,category:"notification"},{id:"beep",name:"Beep",frequency:600,type:"sine",duration:100,category:"notification"},{id:"tick",name:"Tick",frequency:2e3,type:"square",duration:50,category:"notification"},{id:"ping",name:"Ping",frequency:1800,type:"triangle",duration:120,category:"notification"},{id:"bubble",name:"Bubble",frequency:800,type:"sine",duration:200,category:"notification",frequencies:[800,1200]},{id:"pop",name:"Pop",frequency:1e3,type:"square",duration:80,category:"notification"}],Nr=[{id:"buzz",name:"Buzz",frequency:400,type:"sawtooth",duration:250,category:"game"},{id:"whoosh",name:"Whoosh",frequency:200,type:"sawtooth",duration:500,category:"game",frequencies:[200,150,100]},{id:"bloop",name:"Bloop",frequency:300,type:"sine",duration:400,category:"game",frequencies:[300,400,350]},{id:"zap",name:"Zap",frequency:1500,type:"square",duration:120,category:"game",frequencies:[1500,1e3,500]},{id:"bounce",name:"Bounce",frequency:500,type:"triangle",duration:300,category:"game",frequencies:[500,700,600,800]},{id:"powerup",name:"Power Up",frequency:440,type:"square",duration:600,category:"game",frequencies:[440,523,659,784]},{id:"coin",name:"Coin",frequency:1046,type:"square",duration:300,category:"game",frequencies:[1046,1318]},{id:"fanfare",name:"Fanfare",frequency:523,type:"triangle",duration:1200,category:"game",frequencies:[523,659,784,1046]}],Ln=[{id:"classic",name:"Classic System Alerts",sounds:Lr},{id:"musical",name:"Musical Notes & Melodies",sounds:qr},{id:"notification",name:"Notification Alerts",sounds:Rr},{id:"game",name:"Game & Action Sounds",sounds:Nr}],Ae=[...Lr,...qr,...Rr,...Nr];function qn(e){return Vr(this,null,function*(){try{if(!e||!e.frequency||!e.type||!e.duration)return!1;const r=window.AudioContext||window.webkitAudioContext;if(!r)return!1;const t=new r;if(e.frequencies&&e.frequencies.length>1)return Rn(t,e);const s=t.createOscillator(),c=t.createGain();return s.connect(c),c.connect(t.destination),s.frequency.value=e.frequency,s.type=e.type,c.gain.setValueAtTime?(c.gain.setValueAtTime(.3,t.currentTime),c.gain.exponentialRampToValueAtTime(.01,t.currentTime+e.duration/1e3)):c.gain.value=.3,s.start(),s.stop(t.currentTime+e.duration/1e3),setTimeout(()=>{t.close()},e.duration+100),!0}catch(r){return console.warn("Sound playback failed:",r),!1}})}function Rn(e,r){return Vr(this,null,function*(){try{const t=r.frequencies,s=r.duration/t.length,c=e.createGain();return c.connect(e.destination),c.gain.setValueAtTime?c.gain.setValueAtTime(.3,e.currentTime):c.gain.value=.3,t.forEach((a,i)=>{const o=e.createOscillator(),l=e.createGain();o.connect(l),l.connect(c),o.frequency.value=a,o.type=r.type;const d=e.currentTime+i*s/1e3,p=d+s/1e3;l.gain.setValueAtTime?(l.gain.setValueAtTime(1,d),l.gain.exponentialRampToValueAtTime(.01,p)):l.gain.value=1,o.start(d),o.stop(p)}),setTimeout(()=>{e.close()},r.duration+100),!0}catch(t){return console.warn("Melody playback failed:",t),!1}})}function oe(){return Ae[Math.floor(Math.random()*Ae.length)]}function Nn(e){return e&&Ae.find(r=>r.id===e)||null}const Kn=Xr(J)(`
  &:last-child {
    padding-bottom: 8px;
  }
`);function zn({player:e,index:r,isActive:t,canEdit:s=!0,canDelete:c=!0,onEdit:a,onDelete:i,onRoleChange:o}){const{t:l}=E(),[d,p]=u.useState(null),[m,v]=u.useState(null),h=b=>{p(b.currentTarget)},j=()=>{p(null)},$=b=>{b.stopPropagation(),v(b.currentTarget)},w=()=>{v(null)},_=()=>{j(),a==null||a(e)},S=()=>{j(),i==null||i(e.id)},P=b=>{w(),o==null||o(e.id,b)},C=b=>b.split(" ").map(O=>O.charAt(0)).join("").toUpperCase().slice(0,2)||"P",g=b=>{switch(b){case"dom":return"primary";case"sub":return"secondary";case"vers":return"default";default:return"default"}};return n.jsxs(H,{sx:{border:t?"2px solid":"1px solid",borderColor:t?"primary.main":"divider",bgcolor:t?"action.selected":"background.paper",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.main",elevation:2}},children:[n.jsx(Kn,{children:n.jsxs(f,{sx:{display:"flex",alignItems:"flex-start",gap:2},children:[n.jsx(Cr,{sx:{bgcolor:t?"primary.main":"grey.500",marginTop:.5,width:24,height:24,fontWeight:"bold"},children:C(e.name)}),n.jsx(f,{sx:{flexGrow:1,minWidth:0},children:n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[n.jsx(x,{variant:"h6",component:"h3",sx:{fontWeight:t?600:500,color:t?"primary.main":"text.primary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flexGrow:1},children:e.name||l("localPlayers.defaultPlayerName",{number:r+1})}),n.jsx(z,{label:l(`roles.${e.role}`),size:"small",variant:"outlined",color:g(e.role),onClick:s?$:void 0,sx:{cursor:s?"pointer":"default","&:hover":s?{bgcolor:"action.hover"}:{}}}),t&&n.jsx(z,{label:l("localPlayers.currentPlayer"),size:"small",color:"primary",icon:n.jsx(yn,{})})]})}),(s||c)&&n.jsx(ye,{size:"small",onClick:h,"aria-label":l("localPlayers.playerActions",{name:e.name}),children:n.jsx(xn,{})})]})}),n.jsxs(Le,{anchorEl:d,open:!!d,onClose:j,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[s&&n.jsxs(I,{onClick:_,children:[n.jsx(qe,{children:n.jsx(Tr,{fontSize:"small"})}),n.jsx(Te,{children:l("localPlayers.editPlayer")})]}),c&&n.jsxs(I,{onClick:S,sx:{color:"error.main"},children:[n.jsx(qe,{children:n.jsx(gn,{fontSize:"small",sx:{color:"error.main"}})}),n.jsx(Te,{children:l("localPlayers.deletePlayer")})]})]}),n.jsx(Le,{anchorEl:m,open:!!m,onClose:w,transformOrigin:{horizontal:"left",vertical:"top"},anchorOrigin:{horizontal:"left",vertical:"bottom"},children:["dom","sub","vers"].map(b=>n.jsx(I,{onClick:()=>P(b),selected:e.role===b,children:n.jsx(z,{label:l(`roles.${b}`),size:"small",variant:e.role===b?"filled":"outlined",color:g(b)})},b))})]})}var Bn=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function Mn({selectedSoundId:e,onSoundChange:r,label:t="Turn Sound"}){const s=()=>Bn(null,null,function*(){if(!e)return;const a=Nn(e);if(a)try{(yield qn(a))||console.error("Failed to play sound")}catch(i){console.error("Failed to play sound:",i)}}),c=a=>{r(a.target.value)};return n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1,py:1},children:[n.jsxs(B,{fullWidth:!0,size:"small",children:[n.jsx(M,{id:"sound-select-label",children:t}),n.jsxs(W,{labelId:"sound-select-label",value:e||"",label:t,onChange:c,children:[n.jsx(I,{value:"",children:n.jsxs(f,{display:"flex",alignItems:"center",gap:1,children:[n.jsx(vn,{fontSize:"small"}),"No sound"]})}),Ln.map(a=>[n.jsx(en,{sx:{fontWeight:"bold"},children:a.name},`header-${a.id}`),...a.sounds.map(i=>n.jsx(I,{value:i.id,sx:{pl:3},children:i.name},i.id))])]})]}),n.jsx(D,{title:"Play sample",children:n.jsx(ye,{onClick:s,color:"primary",disabled:!e,size:"small",children:n.jsx(Ve,{})})})]})}var Wn=Object.defineProperty,Un=Object.defineProperties,Fn=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,Gn=Object.prototype.hasOwnProperty,Dn=Object.prototype.propertyIsEnumerable,ze=(e,r,t)=>r in e?Wn(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,se=(e,r)=>{for(var t in r||(r={}))Gn.call(r,t)&&ze(e,t,r[t]);if(Ke)for(var t of Ke(r))Dn.call(r,t)&&ze(e,t,r[t]);return e},le=(e,r)=>Un(e,Fn(r)),Yn=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function Hn({open:e,player:r,existingPlayers:t,onSubmit:s,onCancel:c}){const{t:a}=E(),[i,o]=u.useState({name:"",role:"vers",sound:oe().id}),[l,d]=u.useState({}),[p,m]=u.useState(!1);u.useEffect(()=>{o(r?{name:r.name,role:r.role,sound:r.sound||oe().id}:{name:"",role:"vers",sound:oe().id}),d({})},[r,e]);const v=u.useCallback(()=>{const g={},b=i.name.trim();return b?b.length<2?g.name=a("localPlayers.form.errors.nameTooShort"):b.length>20?g.name=a("localPlayers.form.errors.nameTooLong"):t.some(A=>A.id!==(r==null?void 0:r.id)&&A.name.toLowerCase()===b.toLowerCase())&&(g.name=a("localPlayers.form.errors.nameDuplicate")):g.name=a("localPlayers.form.errors.nameRequired"),(!i.role||!["dom","sub","vers"].includes(i.role))&&(g.role=a("localPlayers.form.errors.roleRequired")),d(g),Object.keys(g).length===0},[i,t,r,a]),h=u.useCallback(g=>{const b=g.target.value;o(O=>le(se({},O),{name:b})),l.name&&d(O=>le(se({},O),{name:void 0}))},[l.name]),j=u.useCallback(g=>{const b=g.target.value;o(O=>le(se({},O),{role:b})),l.role&&d(O=>le(se({},O),{role:void 0}))},[l.role]),$=u.useCallback(g=>{o(b=>le(se({},b),{sound:g}))},[]),w=u.useCallback(()=>Yn(null,null,function*(){if(v()){m(!0);try{const g={name:i.name.trim(),role:i.role,sound:i.sound};yield s(g)}catch(g){console.error("Error submitting player form:",g)}finally{m(!1)}}}),[i,v,s]),_=u.useCallback(()=>{o({name:"",role:"vers",sound:oe().id}),d({}),c()},[c]),S=u.useCallback(g=>g.split(" ").map(b=>b.charAt(0)).join("").toUpperCase().slice(0,2)||"P",[]),P=g=>{switch(g){case"dom":return"primary";case"sub":return"secondary";case"vers":return"default";default:return"default"}},C=!!r;return n.jsxs(rn,{open:e,onClose:_,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[n.jsx(nn,{children:a(C?"localPlayers.form.editPlayerTitle":"localPlayers.form.addPlayerTitle")}),n.jsxs(tn,{children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,mb:3,p:2,bgcolor:"action.hover",borderRadius:1},children:[n.jsx(Cr,{sx:{bgcolor:"primary.main",width:56,height:56,fontSize:"1.5rem",fontWeight:"bold"},children:S(i.name||"P")}),n.jsxs(f,{sx:{direction:"row"},children:[n.jsx(x,{variant:"h6",children:i.name||a("localPlayers.form.previewName")}),n.jsx(f,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:n.jsx(z,{label:a(`roles.${i.role}`),size:"small",color:P(i.role),variant:"outlined"})})]})]}),n.jsxs(f,{sx:{display:"flex",flexDirection:"column",gap:3},children:[n.jsx(ae,{label:a("localPlayers.form.nameLabel"),value:i.name,onChange:h,error:!!l.name,helperText:l.name||a("localPlayers.form.nameHelper"),placeholder:a("localPlayers.form.namePlaceholder"),fullWidth:!0,autoFocus:!C,inputProps:{maxLength:20}}),n.jsxs(B,{fullWidth:!0,error:!!l.role,children:[n.jsx(M,{children:a("localPlayers.form.roleLabel")}),n.jsxs(W,{value:i.role,onChange:j,label:a("localPlayers.form.roleLabel"),children:[n.jsx(I,{value:"dom",children:n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1},children:[n.jsx(z,{label:a("roles.dom"),size:"small",color:"primary",variant:"outlined"}),n.jsx(x,{variant:"body2",color:"text.secondary",children:a("localPlayers.form.roleDescriptions.dom")})]})}),n.jsx(I,{value:"sub",children:n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1},children:[n.jsx(z,{label:a("roles.sub"),size:"small",color:"secondary",variant:"outlined"}),n.jsx(x,{variant:"body2",color:"text.secondary",children:a("localPlayers.form.roleDescriptions.sub")})]})}),n.jsx(I,{value:"vers",children:n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1},children:[n.jsx(z,{label:a("roles.vers"),size:"small",color:"default",variant:"outlined"}),n.jsx(x,{variant:"body2",color:"text.secondary",children:a("localPlayers.form.roleDescriptions.vers")})]})})]}),l.role&&n.jsx(x,{variant:"caption",color:"error",sx:{mt:1,ml:1.5},children:l.role})]}),n.jsx(Mn,{selectedSoundId:i.sound,onSoundChange:$,label:a("localPlayers.form.soundLabel","Turn Sound")}),n.jsx(ne,{severity:"info",sx:{mt:1},children:n.jsx(x,{variant:"body2",children:a("localPlayers.form.helpText")})})]})]}),n.jsxs(sn,{sx:{p:3,pt:1},children:[n.jsx(q,{onClick:_,disabled:p,children:a("cancel")}),n.jsx(q,{onClick:w,variant:"contained",disabled:p||!i.name.trim(),children:a(p?"localPlayers.form.saving":C?"localPlayers.form.saveChanges":"localPlayers.form.addPlayer")})]})]})}var Jn=Object.defineProperty,Zn=Object.defineProperties,Qn=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,Xn=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable,Me=(e,r,t)=>r in e?Jn(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ve=(e,r)=>{for(var t in r||(r={}))Xn.call(r,t)&&Me(e,t,r[t]);if(Be)for(var t of Be(r))et.call(r,t)&&Me(e,t,r[t]);return e},rt=(e,r)=>Zn(e,Qn(r)),We=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function nt({roomId:e,isPrivateRoom:r,onComplete:t,onCancel:s,initialPlayers:c=[],initialSettings:a}){const{t:i}=E();console.debug("Setting up local players for room:",e);const[o,l]=u.useState(c),[d,p]=u.useState(!1),[m,v]=u.useState(null),[h,j]=u.useState(!1),[$,w]=u.useState(!1),[_,S]=u.useState(null),[P]=u.useState(a||{showTurnTransitions:!0,enableTurnSounds:!0,showPlayerAvatars:!0}),C=u.useCallback(()=>{const T=o.length>=2&&o.length<=4,V=o.every(Z=>Z.name.trim().length>0),Y=new Set(o.map(Z=>Z.name.toLowerCase())).size===o.length,K=T&&V&&Y;return p(K),o.length<2?v(i("localPlayers.errors.minimumPlayers")):o.length>4?v(i("localPlayers.errors.maximumPlayers")):v(V?Y?null:i("localPlayers.errors.duplicateNames"):i("localPlayers.errors.emptyNames")),K},[o,i]);u.useEffect(()=>{c.length>0&&l(c)},[]),u.useEffect(()=>{C()},[C]);const g=u.useCallback(()=>`local_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),b=u.useCallback(()=>i("localPlayers.defaultPlayerName",{number:o.length+1}),[o.length,i]),O=u.useCallback(()=>{o.length>=4||(S(null),w(!0))},[o.length]),A=u.useCallback(T=>{l(V=>V.filter(K=>K.id!==T).map((K,Z)=>rt(ve({},K),{order:Z,isActive:Z===0})))},[]),R=u.useCallback((T,V)=>{l(Y=>Y.map(K=>K.id===T?ve(ve({},K),V):K))},[]),k=u.useCallback((T,V)=>{R(T,{role:V})},[R]),N=u.useCallback(T=>{S(T),w(!0)},[]),Hr=u.useCallback(T=>We(null,null,function*(){if(_)R(_.id,T);else{const V={id:g(),name:T.name||b(),role:T.role||"vers",order:o.length,isActive:o.length===0,deviceId:"current_device",location:0,isFinished:!1,sound:T.sound};l(Y=>[...Y,V])}w(!1),S(null)}),[_,R,g,b,o.length]),Jr=u.useCallback(()=>{w(!1),S(null)},[]),Zr=u.useCallback(()=>We(null,null,function*(){if(C()){j(!0),v(null);try{yield t(o,P)}catch(T){v(T instanceof Error?T.message:i("localPlayers.errors.sessionCreation"))}finally{j(!1)}}}),[o,P,C,t,i]),Qr=u.useCallback(()=>{s()},[s]);return r?n.jsxs(H,{children:[n.jsx(ln,{title:n.jsx(x,{variant:"h5",component:"h2",children:n.jsx(y,{i18nKey:"localPlayers.setupTitle"})}),subheader:n.jsx(x,{variant:"body2",color:"text.secondary",children:n.jsx(y,{i18nKey:"localPlayers.setupSubtitle"})})}),n.jsxs(J,{children:[m&&n.jsx(ne,{severity:"error",sx:{mb:2},children:m}),n.jsxs(f,{sx:{mb:3},children:[n.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[n.jsx(x,{variant:"h6",children:n.jsx(y,{i18nKey:"localPlayers.playersTitle"})}),n.jsx(x,{variant:"body2",color:"text.secondary",children:i("localPlayers.playersCount",{count:o.length})})]}),o.length===0?n.jsxs(f,{sx:{textAlign:"center",py:4,border:"2px dashed",borderColor:"divider",borderRadius:1,bgcolor:"action.hover"},children:[n.jsx(x,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:n.jsx(y,{i18nKey:"localPlayers.noPlayersYet"})}),n.jsx(q,{variant:"contained",startIcon:n.jsx(Re,{}),onClick:O,children:n.jsx(y,{i18nKey:"localPlayers.addFirstPlayer"})})]}):n.jsxs(n.Fragment,{children:[n.jsx(f,{sx:{display:"flex",flexDirection:"column",gap:2},children:o.map((T,V)=>n.jsx(zn,{player:T,index:V,isActive:T.isActive,canEdit:!0,canDelete:o.length>1,onEdit:N,onDelete:A,onRoleChange:k},T.id))}),o.length<4&&n.jsx(f,{sx:{display:"flex",justifyContent:"center",mt:2},children:n.jsx(an,{size:"small",color:"primary",onClick:O,"aria-label":"Add player",children:n.jsx(Re,{})})})]})]}),n.jsxs(f,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[n.jsx(q,{variant:"outlined",onClick:Qr,disabled:h,children:n.jsx(y,{i18nKey:"cancel"})}),n.jsx(q,{variant:"contained",onClick:Zr,disabled:!d||h,children:h?n.jsx(y,{i18nKey:"localPlayers.creatingSession"}):n.jsx(y,{i18nKey:"localPlayers.startSession"})})]})]}),n.jsx(Hn,{open:$,player:_,existingPlayers:o,onSubmit:Hr,onCancel:Jr})]}):n.jsx(H,{children:n.jsx(J,{children:n.jsx(ne,{severity:"warning",children:n.jsx(x,{children:n.jsx(y,{i18nKey:"localPlayers.privateRoomRequired"})})})})})}function tt({actionName:e,actionLabel:r,selectedLevels:t,availableLevels:s,intensityNames:c={},onChange:a,disabled:i=!1,showValueGlow:o=!1}){const{t:l}=E(),d=Ir(),p=`${e}-intensity-label`,m=o&&t.length>0,v=m?{boxShadow:`0 0 8px ${d.palette.primary.main}`}:{},h=m?{backgroundColor:"var(--color-surface)",borderRadius:"8px",padding:"0 8px"}:{},j=_=>{const P=_.target.value.filter(C=>!isNaN(C)).sort((C,g)=>C-g);a(P)},$=_=>{_.stopPropagation(),a([])},w=_=>_.length===0?l("none"):_.map(S=>c[S]||`${l("level")} ${S}`).join(", ");return s.length===0?n.jsx(n.Fragment,{}):n.jsxs(B,{margin:"normal",fullWidth:!0,disabled:i,children:[n.jsx(M,{id:p,sx:h,children:r}),n.jsx(W,{labelId:p,id:e,label:r,multiple:!0,value:t,onChange:j,renderValue:w,sx:v,endAdornment:t.length>0&&n.jsx(ye,{size:"small",onClick:$,sx:{position:"absolute",right:24,top:"50%",transform:"translateY(-50%)",zIndex:1,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:n.jsx(Ar,{fontSize:"small"})}),children:s.map(_=>n.jsxs(I,{value:_,children:[n.jsx(on,{checked:t.includes(_)}),n.jsx(Te,{primary:c[_]||`${l("level")} ${_}`})]},_))})]})}var st=Object.defineProperty,Ue=Object.getOwnPropertySymbols,lt=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,Fe=(e,r,t)=>r in e?st(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ot=(e,r)=>{for(var t in r||(r={}))lt.call(r,t)&&Fe(e,t,r[t]);if(Ue)for(var t of Ue(r))at.call(r,t)&&Fe(e,t,r[t]);return e};function it({trueCondition:e,onChange:r,yesLabel:t,noLabel:s=null,sx:c={}}){const a=s!=null?s:t;return n.jsx(f,{sx:ot({display:"flex",justifyContent:"center",my:1},c),children:n.jsx(ce,{control:n.jsx(te,{checked:e||!1,onChange:r}),label:Ee(e?t:a)})})}var ct=Object.defineProperty,Ge=Object.getOwnPropertySymbols,dt=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable,De=(e,r,t)=>r in e?ct(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,pt=(e,r)=>{for(var t in r||(r={}))dt.call(r,t)&&De(e,t,r[t]);if(Ge)for(var t of Ge(r))ut.call(r,t)&&De(e,t,r[t]);return e};function ft(e,r=!1,t=!1){if(r)return e;const s=pt({},e);return t||delete s.useRoomBackground,s}function ht(e){return e?"roomBackground":"background"}function mt(e){return e?"roomBackgroundURL":"backgroundURL"}var yt=Object.defineProperty,xt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,Ye=Object.getOwnPropertySymbols,vt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable,He=(e,r,t)=>r in e?yt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,je=(e,r)=>{for(var t in r||(r={}))vt.call(r,t)&&He(e,t,r[t]);if(Ye)for(var t of Ye(r))jt.call(r,t)&&He(e,t,r[t]);return e},be=(e,r)=>xt(e,gt(r));function bt({formData:e,setFormData:r,backgrounds:t,isRoom:s=!1,isPrivateRoom:c=!1}){const{t:a}=E(),i=ht(s),o=mt(s),l=u.useMemo(()=>ft(t,s,c),[t,s,c]),d=e==null?void 0:e[i],[p,m]=u.useState(d||""),v=()=>[n.jsx(I,{value:"",children:a(c?"useRoomBackground":"customTiles.color")},"empty"),...Object.entries(l).map(([w,_])=>n.jsx(I,{value:w,children:_},w))],h=$=>{const w=$.target.value,_=be(je({},e),{[i]:w});if(w!=="custom"){const S=be(je({},_),{[o]:""});s&&(S.roomUpdated=!0),r(S),m(w);return}s&&(_.roomUpdated=!0),r(_),m(w)};u.useEffect(()=>{const $=d&&l[d]?d:"";p!==$&&m($)},[p,d,l]);const j=$=>{const w=be(je({},e),{[i]:"custom",[o]:$.target.value});s&&(w.roomUpdated=!0),r(w)};return n.jsxs(n.Fragment,{children:[n.jsxs(B,{fullWidth:!0,margin:"normal",children:[n.jsx(M,{id:"background-label",children:a("background")}),n.jsx(W,{labelId:"background-label",id:"background",label:a("background"),value:p,onChange:h,displayEmpty:!0,children:v()})]}),p==="custom"&&n.jsx(ae,{sx:{mt:2},label:a("url"),value:(e==null?void 0:e[o])||"",fullWidth:!0,onChange:j,helperText:n.jsxs(n.Fragment,{children:[a("supportedSites"),n.jsx("br",{}),a("requiresEmbeddedUrl")]})})]})}var _t=Object.defineProperty,Pt=(e,r,t)=>r in e?_t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,wt=(e,r,t)=>Pt(e,r+"",t),ie=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});class Ot{constructor(){wt(this,"voiceLoadPromise")}waitForVoices(){return ie(this,null,function*(){return this.voiceLoadPromise?this.voiceLoadPromise:(this.voiceLoadPromise=new Promise(r=>{let t=window.speechSynthesis.getVoices();if(t.length>0){r(t);return}const s=()=>{t=window.speechSynthesis.getVoices(),t.length>0&&(window.speechSynthesis.removeEventListener("voiceschanged",s),r(t))};window.speechSynthesis.addEventListener("voiceschanged",s),setTimeout(()=>{window.speechSynthesis.removeEventListener("voiceschanged",s),r(window.speechSynthesis.getVoices())},3e3)}),this.voiceLoadPromise)})}getAvailableVoicesAsync(){return ie(this,null,function*(){return(yield this.waitForVoices()).map(t=>({name:t.name,displayName:`${t.name} (${t.lang})`}))})}getPreferredVoiceAsync(){return ie(this,null,function*(){const r=yield this.getAvailableVoicesAsync();return r.length>0?r[0].name:null})}speak(r,t,s=0){return ie(this,null,function*(){return new Promise((c,a)=>{if(!("speechSynthesis"in window)){a(new Error("Speech synthesis not supported"));return}const i=new SpeechSynthesisUtterance(r);if(i.pitch=s,t){const l=window.speechSynthesis.getVoices().find(d=>d.name===t);l&&(i.voice=l)}i.onend=()=>c(),i.onerror=o=>a(new Error(`Speech failed: ${o.error}`)),window.speechSynthesis.speak(i)})})}stop(){var r;(r=window.speechSynthesis)!=null&&r.speaking&&window.speechSynthesis.cancel()}isAvailable(){return"speechSynthesis"in window}}const ue=new Ot;var St=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});const $t=()=>{const[e,r]=u.useState(!1),[t,s]=u.useState(!1),[c,a]=u.useState(null),i=u.useCallback(()=>{ue.stop(),r(!1),s(!1)},[]),o=u.useCallback((l,...d)=>St(null,[l,...d],function*(p,m={}){try{s(!0),a(null),i(),r(!0),yield ue.speak(p,m.voice,m.pitch),s(!1),r(!1)}catch(v){const h=v instanceof Error?v.message:"TTS failed";a(h),r(!1),s(!1),console.error("TTS Error:",v)}}),[i]);return u.useEffect(()=>()=>{i()},[i]),{speak:o,stop:i,isPlaying:e,error:c,isLoading:t}};var Ct=Object.defineProperty,It=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,Je=Object.getOwnPropertySymbols,At=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable,Ze=(e,r,t)=>r in e?Ct(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,kt=(e,r)=>{for(var t in r||(r={}))At.call(r,t)&&Ze(e,t,r[t]);if(Je)for(var t of Je(r))Et.call(r,t)&&Ze(e,t,r[t]);return e},Vt=(e,r)=>It(e,Tt(r)),Qe=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function Lt({formData:e,setFormData:r,onVoiceChange:t}){const{t:s}=E(),[c,a]=u.useState([]),[i,o]=u.useState(!0),{speak:l}=$t(),d=e.voicePreference||"",p=u.useCallback(j=>{const $=Vt(kt({},e),{voicePreference:j});r($),t==null||t(j)},[e,r,t]);u.useEffect(()=>{let j=!0;return Qe(null,null,function*(){try{if(j){o(!0);const w=yield ue.getAvailableVoicesAsync();if(j){const _=w.filter(S=>S.displayName.includes("Google")||S.name.includes("Google"));if(a(_),!d&&_.length>0){const S=yield ue.getPreferredVoiceAsync();S&&_.some(P=>P.name===S)&&j?p(S):j&&p(_[0].name)}o(!1)}}}catch(w){console.error("Failed to load voices:",w),j&&o(!1)}}),()=>{j=!1}},[d,p]);const m=j=>{p(j.target.value)},v=()=>Qe(null,null,function*(){const j=d||(c.length>0?c[0].name:"");if(!j)return;const $=s("tts.sampleText","Take a drink and enjoy the game.");try{yield l($,{voice:j,pitch:-2})}catch(w){console.error("Failed to play sample:",w)}}),h=j=>j.displayName.replace(/^Google\s+/i,"");return i?n.jsx(f,{sx:{py:1},children:n.jsx(x,{variant:"body2",color:"text.secondary",children:s("loadingVoices","Loading voices...")})}):c.length===0?n.jsx(f,{sx:{py:1},children:n.jsx(x,{variant:"body2",color:"text.secondary",children:s("noVoicesAvailable","No voices available for this language")})}):n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:1,py:1},children:[n.jsxs(B,{fullWidth:!0,size:"small",children:[n.jsx(M,{id:"voice-select-label",children:s("voiceSelection","Voice")}),n.jsx(W,{labelId:"voice-select-label",value:d,label:s("voiceSelection","Voice"),onChange:m,children:c.map(j=>n.jsx(I,{value:j.name,children:h(j)},j.name))})]}),n.jsx(D,{title:s("playSample","Play sample"),children:n.jsx(ye,{onClick:v,color:"primary",disabled:!d,size:"small",children:n.jsx(Ve,{})})})]})}var qt=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function Rt({boardUpdated:e}){const{i18n:r}=E(),[t,s]=u.useState(r.resolvedLanguage||"en"),[c,a]=u.useState(!1);function i(l){return qt(this,null,function*(){a(!0),s(l);try{yield r.changeLanguage(l),e()}catch(d){console.error("Error changing language:",d),yield r.changeLanguage(l),e()}finally{a(!1)}})}const o=Object.entries(On).map(([l,d])=>n.jsx(I,{value:l,children:d.label},l));return n.jsx(f,{sx:{minWidth:120,mt:1,mb:2},children:n.jsxs(B,{fullWidth:!0,children:[n.jsxs(M,{id:"language-label",sx:{display:"flex",alignItems:"center"},children:[n.jsx(Ne,{sx:{mr:1}}),n.jsx(y,{i18nKey:"language"})]}),n.jsx(W,{labelId:"language-label",id:"language-select",value:t,disabled:c,label:n.jsxs(n.Fragment,{children:[n.jsx(Ne,{}),n.jsx(y,{i18nKey:"language"})]}),onChange:l=>i(l.target.value),endAdornment:c&&n.jsx(cn,{size:20}),MenuProps:{disableScrollLock:!0,BackdropProps:{invisible:!0},PaperProps:{style:{backdropFilter:"none",WebkitBackdropFilter:"none"}}},children:o})]})})}function G({field:e,formData:r,handleSwitch:t}){return n.jsx(it,{trueCondition:r[e],onChange:s=>t(s,e),yesLabel:e,sx:{justifyContent:"left"}})}var Nt=Object.defineProperty,Kt=Object.defineProperties,zt=Object.getOwnPropertyDescriptors,Xe=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,er=(e,r,t)=>r in e?Nt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,_e=(e,r)=>{for(var t in r||(r={}))Bt.call(r,t)&&er(e,t,r[t]);if(Xe)for(var t of Xe(r))Mt.call(r,t)&&er(e,t,r[t]);return e},Pe=(e,r)=>Kt(e,zt(r));function Wt({formData:e,setFormData:r,boardUpdated:t}){const[s,c]=kr(),a=!!(e.room&&!U(e.room)),{t:i}=E(),o={useRoomBackground:i("useRoomBackground"),color:i("color"),gray:i("gray"),"metronome.gif":i("hypnoDick"),"pink-spiral.gif":i("pinkSpiral"),custom:i("customURL")};function l(p,m){r(Pe(_e({},e),{[m]:p.target.checked})),c(Pe(_e({},s),{[m]:p.target.checked}))}function d(p){c(Pe(_e({},s),{voicePreference:p}))}return n.jsxs(n.Fragment,{children:[n.jsx(Rt,{boardUpdated:t}),n.jsx(x,{variant:"h5",children:n.jsx(y,{i18nKey:"dialog"})}),n.jsx(G,{field:"playerDialog",formData:e,handleSwitch:l}),n.jsx(G,{field:"othersDialog",formData:e,handleSwitch:l}),n.jsx(re,{}),n.jsx(x,{variant:"h5",sx:{mt:2},children:n.jsx(y,{i18nKey:"sounds"})}),n.jsx(G,{field:"mySound",formData:e,handleSwitch:l}),n.jsx(G,{field:"otherSound",formData:e,handleSwitch:l}),n.jsx(G,{field:"chatSound",formData:e,handleSwitch:l}),n.jsx(G,{field:"readRoll",formData:e,handleSwitch:l}),e.readRoll&&n.jsx(Lt,{formData:e,setFormData:r,onVoiceChange:d}),n.jsx(re,{}),n.jsx(x,{variant:"h5",sx:{mt:2,textTransform:"capitalize"},children:n.jsx(y,{i18nKey:"misc"})}),n.jsx(G,{field:"hideBoardActions",formData:e,handleSwitch:l}),n.jsx(G,{field:"advancedSettings",formData:e,handleSwitch:l}),n.jsx(bt,{formData:e,setFormData:r,backgrounds:o,isPrivateRoom:a}),n.jsx(re,{})]})}var Ut=Object.defineProperty,Ft=Object.defineProperties,Gt=Object.getOwnPropertyDescriptors,rr=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,Yt=Object.prototype.propertyIsEnumerable,nr=(e,r,t)=>r in e?Ut(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Ht=(e,r)=>{for(var t in r||(r={}))Dt.call(r,t)&&nr(e,t,r[t]);if(rr)for(var t of rr(r))Yt.call(r,t)&&nr(e,t,r[t]);return e},Jt=(e,r)=>Ft(e,Gt(r));function Zt({formData:e,setFormData:r}){const t=(c,a)=>{r(Jt(Ht({},e),{finishRange:a,boardUpdated:!0}))},s=(e==null?void 0:e.finishRange)||[30,70];return n.jsxs(f,{children:[n.jsx(re,{}),n.jsx(x,{id:"finish-slider",sx:{my:1},children:n.jsx(y,{i18nKey:"finishSlider"})}),n.jsx(dn,{"aria-labelledby":"finish-slider",value:s,onChange:t,valueLabelDisplay:"off"}),n.jsxs(f,{display:"flex",flexDirection:"column",justifyContent:"space-between",textAlign:"center",children:[n.jsxs(x,{whiteSpace:"nowrap",children:[n.jsx(y,{i18nKey:"noCum"})," ",s[0],"%"]}),n.jsxs(x,{whiteSpace:"nowrap",children:[n.jsx(y,{i18nKey:"ruined"})," ",s[1]-s[0],"%"]}),n.jsxs(x,{whiteSpace:"nowrap",children:[n.jsx(y,{i18nKey:"cum"})," ",100-s[1],"%"]})]}),n.jsx(re,{sx:{my:1}})]})}function tr({children:e}){return n.jsx(L,{size:{xs:12,md:5},children:e})}var Qt=Object.defineProperty,Xt=Object.defineProperties,es=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertySymbols,Kr=Object.prototype.hasOwnProperty,zr=Object.prototype.propertyIsEnumerable,sr=(e,r,t)=>r in e?Qt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,rs=(e,r)=>{for(var t in r||(r={}))Kr.call(r,t)&&sr(e,t,r[t]);if(pe)for(var t of pe(r))zr.call(r,t)&&sr(e,t,r[t]);return e},ns=(e,r)=>Xt(e,es(r)),ts=(e,r)=>{var t={};for(var s in e)Kr.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&pe)for(var s of pe(e))r.indexOf(s)<0&&zr.call(e,s)&&(t[s]=e[s]);return t};function we(e){var r=e,{children:t,title:s,subtitle:c,defaultExpanded:a=!1,hasSelectedOptions:i=!1}=r,o=ts(r,["children","title","subtitle","defaultExpanded","hasSelectedOptions"]);const l=Ir();return n.jsxs(un,ns(rs({defaultExpanded:a},o),{sx:{backgroundColor:"inherit",backgroundImage:"none",boxShadow:"none"},children:[n.jsx(pn,{expandIcon:n.jsx(jn,{}),sx:{px:0},children:n.jsxs(f,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[n.jsxs(x,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1,minWidth:"fit-content"},children:[s,":",i&&n.jsx(f,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:l.palette.primary.main,flexShrink:0}})]}),n.jsx(x,{sx:{pt:.5,ml:2,flex:1},children:c})]})}),n.jsx(fn,{sx:{px:0},children:n.jsx(L,{container:!0,columnSpacing:2,justifyContent:"space-evenly",className:"columned-grid",children:t})})]}))}var ss=Object.defineProperty,ls=Object.defineProperties,as=Object.getOwnPropertyDescriptors,fe=Object.getOwnPropertySymbols,Br=Object.prototype.hasOwnProperty,Mr=Object.prototype.propertyIsEnumerable,lr=(e,r,t)=>r in e?ss(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,os=(e,r)=>{for(var t in r||(r={}))Br.call(r,t)&&lr(e,t,r[t]);if(fe)for(var t of fe(r))Mr.call(r,t)&&lr(e,t,r[t]);return e},is=(e,r)=>ls(e,as(r)),cs=(e,r)=>{var t={};for(var s in e)Br.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&fe)for(var s of fe(e))r.indexOf(s)<0&&Mr.call(e,s)&&(t[s]=e[s]);return t};const Wr=u.forwardRef((e,r)=>{var t=e,{value:s,onChange:c,label:a,options:i,defaultValue:o=null,sx:l,helpIcon:d=!1,fullWidth:p=!0}=t,m=cs(t,["value","onChange","label","options","defaultValue","sx","helpIcon","fullWidth"]);const v=u.useMemo(()=>i.map(h=>typeof h=="string"?n.jsx(I,{value:h,children:Ee(h)},h):n.jsx(I,{value:h.value,children:h.label},h.value)),[i]);return n.jsxs(B,is(os({fullWidth:p,margin:"normal",sx:l},m),{ref:r,children:[n.jsxs(M,{id:`${a}Label`,children:[n.jsx(y,{i18nKey:a}),!!d&&n.jsx(F,{sx:{ml:1,fontSize:16}})]}),n.jsx(W,{labelId:`${a}Label`,id:a,label:n.jsxs(n.Fragment,{children:[n.jsx(y,{i18nKey:a}),!!d&&n.jsx(F,{sx:{ml:1,fontSize:16}})]}),value:s||o||"",onChange:c,children:v})]}))});var ds=Object.defineProperty,us=Object.defineProperties,ps=Object.getOwnPropertyDescriptors,ar=Object.getOwnPropertySymbols,fs=Object.prototype.hasOwnProperty,hs=Object.prototype.propertyIsEnumerable,or=(e,r,t)=>r in e?ds(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Q=(e,r)=>{for(var t in r||(r={}))fs.call(r,t)&&or(e,t,r[t]);if(ar)for(var t of ar(r))hs.call(r,t)&&or(e,t,r[t]);return e},X=(e,r)=>us(e,ps(r));function ms({option:e,settings:r,setSettings:t,actionsFolder:s,type:c,showVariation:a=!1,showRole:i=!1}){var o,l,d,p,m,v;const{t:h}=E(),j=`${e}label`,$=(o=s[e])==null?void 0:o.label;function w(g,b,O){var A,R,k;const N=(A=r.selectedActions)==null?void 0:A[b];t(X(Q({},r),{selectedActions:X(Q({},r.selectedActions),{[b]:X(Q({},N),{type:c,levels:(R=N==null?void 0:N.levels)!=null?R:[],[O]:(k=g==null?void 0:g.target)==null?void 0:k.value})}),boardUpdated:!0}))}function _(g,b){var O;const A=(O=r.selectedActions)==null?void 0:O[b];t(X(Q({},r),{selectedActions:X(Q({},r.selectedActions),{[b]:X(Q({},A),{type:c,levels:g})}),boardUpdated:!0}))}let S=12;(a||i)&&(S=6);let P=["dom","vers","sub"];(l=s[e])!=null&&l.dom&&(P=[{label:s[e].dom,value:"dom"},{label:h("vers"),value:"vers"},{label:s[e].sub,value:"sub"}]);const C=()=>{var g,b;const O=s[e],A=O!=null&&O.intensities?Object.keys(O.intensities).map(Number).filter(k=>k>0).sort((k,N)=>k-N):[1,2,3,4],R=((b=(g=r.selectedActions)==null?void 0:g[e])==null?void 0:b.levels)||[];return n.jsx(tt,{actionName:e,actionLabel:(O==null?void 0:O.label)||e,selectedLevels:R,availableLevels:A,intensityNames:(O==null?void 0:O.intensities)||{},onChange:k=>_(k,e),showValueGlow:!0})};return n.jsxs(L,{container:!0,justifyContent:"center",children:[n.jsx(L,{size:S,children:C()}),!!i&&n.jsx(L,{size:6,children:n.jsx(Wr,{sx:{ml:1},value:(p=(d=r.selectedActions)==null?void 0:d[e])==null?void 0:p.role,onChange:g=>w(g,e,"role"),label:`${h("role")}: ${$}`,options:P,defaultValue:r.role||"sub"})}),!!a&&n.jsx(L,{size:6,children:n.jsx(D,{placement:"top",title:n.jsxs(y,{i18nKey:"variationTooltip",children:[n.jsx(x,{variant:"subtitle2",children:"Standalone = Its own tile. "}),n.jsx(x,{variant:"subtitle2",children:"Append Some = 50% chance."}),n.jsx(x,{variant:"subtitle2",children:"Append Most = 90% chance."})]}),arrow:!0,children:n.jsxs(B,{fullWidth:!0,margin:"normal",sx:{ml:1},children:[n.jsxs(M,{id:`${j}Variation`,children:[`${$} ${h("variation")}`,n.jsx(F,{sx:{ml:1,fontSize:16}})]}),n.jsxs(W,{labelId:`${j}Variation`,id:`${e}Variation`,label:n.jsxs(n.Fragment,{children:[$," ",h("variation"),n.jsx(F,{sx:{ml:1,fontSize:16}})]}),value:((v=(m=r.selectedActions)==null?void 0:m[e])==null?void 0:v.variation)||"standalone",onChange:g=>w(g,e,"variation"),children:[n.jsx(I,{value:"standalone",children:n.jsx(y,{i18nKey:"standalone"})}),n.jsx(I,{value:"appendSome",children:n.jsx(y,{i18nKey:"appendSome"})}),n.jsx(I,{value:"appendMost",children:n.jsx(y,{i18nKey:"appendMost"})})]})]})})})]},e)}var ys=Object.defineProperty,xs=Object.defineProperties,gs=Object.getOwnPropertyDescriptors,ir=Object.getOwnPropertySymbols,vs=Object.prototype.hasOwnProperty,js=Object.prototype.propertyIsEnumerable,cr=(e,r,t)=>r in e?ys(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,bs=(e,r)=>{for(var t in r||(r={}))vs.call(r,t)&&cr(e,t,r[t]);if(ir)for(var t of ir(r))js.call(r,t)&&cr(e,t,r[t]);return e},_s=(e,r)=>xs(e,gs(r));function Ps({formData:e,setFormData:r}){return n.jsxs(ke,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{mt:1},children:[n.jsx(x,{children:n.jsx(y,{i18nKey:"solo"})}),n.jsx(D,{title:n.jsx(x,{variant:"subtitle2",children:n.jsx(y,{i18nKey:"soloTooltip"})}),arrow:!0,children:n.jsx(F,{sx:{fontSize:15}})}),n.jsx(te,{id:"gameMode",checked:!de(e.gameMode),onChange:t=>r(_s(bs({},e),{gameMode:t.target.checked?"local":"online",boardUpdated:!0})),inputProps:{"aria-label":"Game Type"}}),n.jsx(x,{children:n.jsx(y,{i18nKey:"local"})}),n.jsx(D,{title:n.jsx(x,{variant:"subtitle2",children:n.jsx(y,{i18nKey:"localTooltip"})}),arrow:!0,children:n.jsx(F,{sx:{fontSize:15}})})]})}function ws({formData:e}){const[r,t]=u.useState(!1);return u.useEffect(()=>{const s=Object.values(e).filter(a=>typeof a=="object"&&(a==null?void 0:a.type)==="consumption"&&(a==null?void 0:a.levels)&&a.levels.length>0).length,c=Object.values(e).filter(a=>typeof a=="object"&&(a==null?void 0:a.levels)&&a.levels.length>0).length;t(s>1&&s>=c-s)},[e]),r?n.jsx(ne,{severity:"warning",children:n.jsx(y,{i18nKey:"consumptionWarning"})}):null}var Os=Object.defineProperty,Ss=Object.defineProperties,$s=Object.getOwnPropertyDescriptors,dr=Object.getOwnPropertySymbols,Cs=Object.prototype.hasOwnProperty,Is=Object.prototype.propertyIsEnumerable,ur=(e,r,t)=>r in e?Os(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,pr=(e,r)=>{for(var t in r||(r={}))Cs.call(r,t)&&ur(e,t,r[t]);if(dr)for(var t of dr(r))Is.call(r,t)&&ur(e,t,r[t]);return e},Ts=(e,r)=>Ss(e,$s(r));function As({formData:e,setFormData:r,actionsList:t}){const{t:s}=E(),{hasLocalPlayers:c}=$n(),a=!de(e.gameMode),i=!c();function o(p){return Object.keys(t).filter(m=>{var v;return((v=t[m])==null?void 0:v.type)===p}).some(m=>{var v;const h=(v=e.selectedActions)==null?void 0:v[m];return(h==null?void 0:h.levels)&&h.levels.length>0})}function l(p,m={}){return Object.keys(t).filter(v=>{var h;return((h=t[v])==null?void 0:h.type)===p}).map(v=>n.jsx(tr,{children:n.jsx(ms,pr({option:v,settings:e,setSettings:r,actionsFolder:t,type:p},m))},v))}const d=p=>{const m=JSON.parse(JSON.stringify(e));return Object.keys(m).forEach(v=>{m.role=p,v.includes("role")&&(m[v]=p)}),m};return n.jsxs(n.Fragment,{children:[n.jsx(Ps,{formData:e,setFormData:r}),U(e==null?void 0:e.room)&&!de(e.gameMode)&&n.jsx(L,{container:!0,alignContent:"center",justifyContent:"space-evenly",children:n.jsx(L,{sx:{py:3},children:n.jsx(x,{variant:"h5",children:n.jsx(y,{i18nKey:"privateRequired"})})})}),a?n.jsxs(n.Fragment,{children:[n.jsx(L,{container:!0,columnSpacing:2,justifyContent:"space-evenly",children:i&&n.jsx(tr,{children:n.jsx(Wr,{value:e.role,onChange:p=>r(Ts(pr({},d(p.target.value)),{boardUpdated:!0})),label:"mainRole",options:["dom","vers","sub"],defaultValue:"sub"})})}),n.jsx(we,{title:s("consumption"),subtitle:s("consumptionSubtitle"),hasSelectedOptions:o("consumption"),children:l("consumption",{showVariation:!0})}),n.jsx(we,{title:s("foreplay"),subtitle:s("foreplaySubtitle"),hasSelectedOptions:o("foreplay"),children:l("foreplay",{showRole:i})}),n.jsx(we,{title:s("sex"),subtitle:s("sexSubtitle"),hasSelectedOptions:o("sex"),children:l("sex",{showRole:i})})]}):n.jsxs(n.Fragment,{children:[n.jsx(L,{container:!0,columnSpacing:2,justifyContent:"space-evenly",children:l("consumption",{showVariation:!0})}),n.jsx(re,{}),n.jsx(L,{container:!0,columnSpacing:2,justifyContent:"center",children:l("solo")})]}),n.jsx(Zt,{setFormData:r,formData:e}),n.jsx(ws,{formData:e})]})}var Es=Object.defineProperty,ks=Object.defineProperties,Vs=Object.getOwnPropertyDescriptors,fr=Object.getOwnPropertySymbols,Ls=Object.prototype.hasOwnProperty,qs=Object.prototype.propertyIsEnumerable,hr=(e,r,t)=>r in e?Es(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Rs=(e,r)=>{for(var t in r||(r={}))Ls.call(r,t)&&hr(e,t,r[t]);if(fr)for(var t of fr(r))qs.call(r,t)&&hr(e,t,r[t]);return e},Ns=(e,r)=>ks(e,Vs(r));function Ks({formData:e,setFormData:r}){const{t}=E(),s=c=>{const a=c.target.value.trim();r(Ns(Rs({},e),{roomBackgroundURL:a,roomUpdated:!0}))};return n.jsx(ae,{sx:{mt:2},label:t("roomBackgroundURL"),value:(e==null?void 0:e.roomBackgroundURL)||"",fullWidth:!0,onChange:s,helperText:t("supportedSites"),placeholder:t("roomBackgroundPlaceholder"),type:"url",inputMode:"url",autoComplete:"off",spellCheck:!1,autoCapitalize:"none"})}var zs=Object.defineProperty,Bs=Object.defineProperties,Ms=Object.getOwnPropertyDescriptors,mr=Object.getOwnPropertySymbols,Ws=Object.prototype.hasOwnProperty,Us=Object.prototype.propertyIsEnumerable,yr=(e,r,t)=>r in e?zs(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,xr=(e,r)=>{for(var t in r||(r={}))Ws.call(r,t)&&yr(e,t,r[t]);if(mr)for(var t of mr(r))Us.call(r,t)&&yr(e,t,r[t]);return e},gr=(e,r)=>Bs(e,Ms(r));function Fs({formData:e,setFormData:r}){const{t}=E(),s={"1d4":2.5,"1d6":3.5,"2d4":5},c=e!=null&&e.roomTileCount?Math.floor(e.roomTileCount/s[e.roomDice||"1d6"]):16,a=Array.from({length:7},(i,o)=>(o+2)*10).map(i=>n.jsx(I,{value:i,children:i},i));return n.jsxs(f,{children:[n.jsx(x,{variant:"subtitle1",sx:{mb:2,fontWeight:"medium"},children:n.jsx(y,{i18nKey:"gameSpeed"})}),n.jsxs(f,{sx:{display:"flex",gap:2,alignItems:"flex-end",flexWrap:"wrap"},children:[n.jsxs(B,{sx:{minWidth:120,flex:1},children:[n.jsx(M,{id:"diceRole-label",children:n.jsx(y,{i18nKey:"roomDice"})}),n.jsxs(W,{labelId:"diceRole-label",id:"diceRole-select",value:(e==null?void 0:e.roomDice)||"1d4",label:t("roomDice"),onChange:i=>r(gr(xr({},e),{roomDice:i.target.value,roomUpdated:!0})),children:[n.jsx(I,{value:"1d4",children:"1d4"}),n.jsx(I,{value:"1d6",children:"1d6"}),n.jsx(I,{value:"2d4",children:"2d4"})]})]}),n.jsxs(B,{sx:{minWidth:120,flex:1},children:[n.jsx(M,{id:"tile-count-label",children:n.jsx(y,{i18nKey:"roomTileCount"})}),n.jsx(W,{labelId:"tile-count-label",id:"tile-count-select",value:String((e==null?void 0:e.roomTileCount)||40),label:t("roomTileCount"),onChange:i=>r(gr(xr({},e),{roomTileCount:Number(i.target.value),roomUpdated:!0})),children:a})]}),n.jsxs(f,{sx:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:120},children:[n.jsx(x,{variant:"body2",color:"text.secondary",sx:{mb:1},children:n.jsx(y,{i18nKey:"averageRolls"})}),n.jsx(z,{label:c,color:"primary",variant:"outlined",sx:{minWidth:50,fontWeight:"bold"}})]})]})]})}var Gs=Object.defineProperty,Ds=Object.defineProperties,Ys=Object.getOwnPropertyDescriptors,vr=Object.getOwnPropertySymbols,Hs=Object.prototype.hasOwnProperty,Js=Object.prototype.propertyIsEnumerable,jr=(e,r,t)=>r in e?Gs(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Zs=(e,r)=>{for(var t in r||(r={}))Hs.call(r,t)&&jr(e,t,r[t]);if(vr)for(var t of vr(r))Js.call(r,t)&&jr(e,t,r[t]);return e},Qs=(e,r)=>Ds(e,Ys(r));function Xs({formData:e,setFormData:r}){const t=u.useCallback(()=>{r(Qs(Zs({},e),{roomRealtime:!e.roomRealtime,roomUpdated:!0}))},[e,r]);return n.jsxs(f,{children:[n.jsx(x,{variant:"subtitle1",sx:{mb:2,fontWeight:"medium"},children:n.jsx(y,{i18nKey:"playerListOptions"})}),n.jsx(f,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsxs(ke,{direction:"row",spacing:2,alignItems:"center",children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:.5},children:[n.jsx(x,{variant:"body2",color:"text.secondary",children:n.jsx(y,{i18nKey:"realtime"})}),n.jsx(D,{title:n.jsx(x,{variant:"subtitle2",children:n.jsx(y,{i18nKey:"realtimeTooltip"})}),arrow:!0,children:n.jsx(F,{sx:{fontSize:16,color:"text.secondary"}})})]}),n.jsx(ce,{control:n.jsx(te,{checked:!!e.roomRealtime,onChange:t,inputProps:{"aria-label":Ee("playerList")}}),label:"",sx:{margin:0}}),n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:.5},children:[n.jsx(x,{variant:"body2",color:"text.secondary",children:n.jsx(y,{i18nKey:"delayed"})}),n.jsx(D,{title:n.jsx(x,{variant:"subtitle2",children:n.jsx(y,{i18nKey:"delayedTooltip"})}),arrow:!0,children:n.jsx(F,{sx:{fontSize:16,color:"text.secondary"}})})]})]})})]})}var el=Object.defineProperty,rl=Object.defineProperties,nl=Object.getOwnPropertyDescriptors,br=Object.getOwnPropertySymbols,tl=Object.prototype.hasOwnProperty,sl=Object.prototype.propertyIsEnumerable,_r=(e,r,t)=>r in e?el(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Oe=(e,r)=>{for(var t in r||(r={}))tl.call(r,t)&&_r(e,t,r[t]);if(br)for(var t of br(r))sl.call(r,t)&&_r(e,t,r[t]);return e},Se=(e,r)=>rl(e,nl(r));function ll({formData:e,setFormData:r}){var t;const{id:s}=hn(),{t:c}=E(),a=p=>{let m;p.target.checked&&U(s)?m=An("123456789ABCDEFGHJKLMNPQRSTUVWXYZ",5)():s&&p.target.checked&&!U(s)?m=s:m="PUBLIC",r(Se(Oe({},e),{room:m.toUpperCase(),gameMode:U(m)?"online":e.gameMode}))},i=u.useCallback(p=>{r(Se(Oe({},e),{room:p.currentTarget.value,boardUpdated:!0}))},[e,r]),o=u.useCallback(p=>{p.key==="Enter"&&r(Se(Oe({},e),{room:p.currentTarget.value,boardUpdated:!0}))},[e,r]),l=u.useCallback(p=>{const m=p.target.value.toUpperCase();p.target.value=m},[]),d=!U(e.room);return n.jsxs(n.Fragment,{children:[n.jsxs(ke,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{width:"100%"},children:[n.jsx(x,{children:n.jsx(y,{i18nKey:"public"})}),n.jsx(te,{id:"showPrivate",checked:d,onChange:a,slotProps:{input:{"aria-label":c("room")}}}),n.jsx(x,{children:n.jsx(y,{i18nKey:"private"})}),n.jsx(D,{title:n.jsx(x,{variant:"subtitle2",children:n.jsx(y,{i18nKey:"privateOptions"})}),arrow:!0,children:n.jsx(F,{sx:{fontSize:15}})})]}),d&&n.jsx(ae,{fullWidth:!0,id:"privateRoom",label:c("privateRoom"),defaultValue:(t=e.room)==null?void 0:t.toUpperCase(),margin:"normal",onBlur:i,onKeyDown:o,onChange:l,inputProps:{style:{textTransform:"uppercase"}}})]})}var al=Object.defineProperty,ol=Object.defineProperties,il=Object.getOwnPropertyDescriptors,Pr=Object.getOwnPropertySymbols,cl=Object.prototype.hasOwnProperty,dl=Object.prototype.propertyIsEnumerable,wr=(e,r,t)=>r in e?al(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ul=(e,r)=>{for(var t in r||(r={}))cl.call(r,t)&&wr(e,t,r[t]);if(Pr)for(var t of Pr(r))dl.call(r,t)&&wr(e,t,r[t]);return e},pl=(e,r)=>ol(e,il(r)),$e=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function fl({roomId:e="PRIVATE",isPrivateRoom:r=!0}){const{t}=E(),{localPlayers:s,hasLocalPlayers:c,session:a,sessionSettings:i,clearLocalSession:o,updateSettings:l,createLocalSession:d}=Cn(),[p,m]=u.useState(!1),[v,h]=u.useState(null),j=u.useCallback(()=>{m(!0),h(null)},[]),$=u.useCallback(()=>{m(!1),h(null)},[]),w=u.useCallback((P,C)=>$e(null,null,function*(){try{yield d(e,P,C),m(!1),h(null)}catch(g){h(g instanceof Error?g.message:"Failed to save local player configuration")}}),[e,d]),_=u.useCallback(()=>$e(null,null,function*(){try{yield o(),h(null)}catch(P){h(P instanceof Error?P.message:"Failed to clear local session")}}),[o]),S=u.useCallback((P,C)=>$e(null,null,function*(){if(i)try{const g=pl(ul({},i),{[P]:C});yield l(g),h(null)}catch(g){h(g instanceof Error?g.message:"Failed to update settings")}}),[i,l]);return p?n.jsxs(f,{children:[v&&n.jsx(ne,{severity:"error",sx:{mb:2},children:v}),n.jsx(nt,{roomId:e,isPrivateRoom:r,onComplete:w,onCancel:$,initialPlayers:s,initialSettings:i})]}):n.jsxs(f,{children:[v&&n.jsx(ne,{severity:"error",sx:{mb:2},children:v}),c?n.jsxs(f,{children:[n.jsxs(f,{sx:{mb:3},children:[n.jsx(f,{sx:{display:"flex",flexDirection:"column",gap:1,mb:2},children:s.map(P=>n.jsxs(f,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,borderRadius:1,bgcolor:P.isActive?"primary.50":"background.default",border:P.isActive?"1px solid":"1px solid transparent",borderColor:P.isActive?"primary.main":"transparent"},children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsxs(x,{variant:"body2",color:"text.secondary",children:["#",P.order+1]}),n.jsx(x,{variant:"body1",fontWeight:P.isActive?"bold":"normal",children:P.name}),n.jsx(z,{label:t(`roles.${P.role}`),size:"small",variant:"outlined"})]}),P.isActive&&n.jsx(z,{label:t("localPlayerSettings.players.currentTurn"),color:"primary",size:"small"})]},P.id))}),n.jsxs(f,{sx:{display:"flex",gap:1},children:[n.jsx(q,{variant:"outlined",startIcon:n.jsx(Tr,{}),onClick:j,size:"small",children:n.jsx(y,{i18nKey:"localPlayerSettings.session.editButton"})}),n.jsx(q,{variant:"outlined",color:"error",startIcon:n.jsx(Ar,{}),onClick:_,size:"small",children:n.jsx(y,{i18nKey:"localPlayerSettings.session.clearButton"})})]})]}),(a==null?void 0:a.settings)&&n.jsxs(f,{sx:{mt:3,p:2,borderRadius:1,bgcolor:"action.hover"},children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(bn,{sx:{color:"text.secondary"}}),n.jsx(x,{variant:"subtitle1",component:"h4",children:n.jsx(y,{i18nKey:"localPlayerSettings.settings.title"})})]}),n.jsxs(f,{sx:{display:"flex",flexDirection:"column",gap:2},children:[n.jsx(ce,{control:n.jsx(te,{checked:a.settings.showTurnTransitions,onChange:P=>S("showTurnTransitions",P.target.checked)}),label:t("localPlayerSettings.settings.showTurnTransitions")}),n.jsx(ce,{control:n.jsx(te,{checked:a.settings.enableTurnSounds,onChange:P=>S("enableTurnSounds",P.target.checked)}),label:t("localPlayerSettings.settings.playTurnSounds")})]})]})]}):n.jsxs(f,{sx:{textAlign:"center",py:2},children:[n.jsx(Er,{sx:{fontSize:48,color:"text.secondary",mb:2}}),n.jsx(x,{variant:"body1",color:"text.secondary",paragraph:!0,children:n.jsx(y,{i18nKey:"localPlayerSettings.noPlayers.description"})}),n.jsx(q,{variant:"contained",startIcon:n.jsx(Ve,{}),onClick:j,size:"large",children:n.jsx(y,{i18nKey:"localPlayerSettings.noPlayers.setupButton"})})]})]})}function hl({formData:e,setFormData:r}){const{t}=E();return n.jsxs(f,{sx:{p:2},children:[n.jsx(H,{variant:"outlined",sx:{mb:3},children:n.jsxs(J,{children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(_n,{sx:{color:"primary.main"}}),n.jsx(x,{variant:"h6",component:"h3",children:t("roomType")})]}),n.jsx(ll,{formData:e,setFormData:r})]})}),!U(e.room)&&n.jsxs(n.Fragment,{children:[n.jsx(H,{variant:"outlined",sx:{mb:3},children:n.jsxs(J,{children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(Er,{sx:{color:"primary.main"}}),n.jsx(x,{variant:"h6",component:"h3",children:t("localPlayerSettings.title")})]}),n.jsx(fl,{roomId:e.room,isPrivateRoom:!U(e.room)})]})}),n.jsx(H,{variant:"outlined",sx:{mb:3},children:n.jsxs(J,{children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(Pn,{sx:{color:"primary.main"}}),n.jsx(x,{variant:"h6",component:"h3",children:t("gameConfiguration")})]}),n.jsx(f,{sx:{mb:3},children:n.jsx(Fs,{formData:e,setFormData:r})}),n.jsx(f,{sx:{p:2,borderRadius:1,bgcolor:"action.hover"},children:n.jsx(Xs,{formData:e,setFormData:r})})]})}),n.jsx(H,{variant:"outlined",sx:{mb:3},children:n.jsxs(J,{children:[n.jsxs(f,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(wn,{sx:{color:"primary.main"}}),n.jsx(x,{variant:"h6",component:"h3",children:t("visualSettings")})]}),n.jsx(Ks,{formData:e,setFormData:r})]})})]})]})}var ml=Object.defineProperty,yl=Object.defineProperties,xl=Object.getOwnPropertyDescriptors,he=Object.getOwnPropertySymbols,Ur=Object.prototype.hasOwnProperty,Fr=Object.prototype.propertyIsEnumerable,Or=(e,r,t)=>r in e?ml(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Sr=(e,r)=>{for(var t in r||(r={}))Ur.call(r,t)&&Or(e,t,r[t]);if(he)for(var t of he(r))Fr.call(r,t)&&Or(e,t,r[t]);return e},gl=(e,r)=>yl(e,xl(r)),vl=(e,r)=>{var t={};for(var s in e)Ur.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&he)for(var s of he(e))r.indexOf(s)<0&&Fr.call(e,s)&&(t[s]=e[s]);return t};function Ce(e){var r=e,{children:t,value:s,index:c,style:a}=r,i=vl(r,["children","value","index","style"]);return n.jsx("div",gl(Sr({role:"tabpanel",hidden:s!==c,id:`simple-tabpanel-${c}`,"aria-labelledby":`simple-tab-${c}`},i),{children:s===c&&n.jsx(f,{sx:Sr({p:3},a),children:t})}))}const Gr=({levels:e})=>!!(e!=null&&e.length)&&e.some(r=>r>0);function jl(e){return Object.values(e).some(Gr)}function bl(e,r){const t=e.selectedActions||{};return Object.entries(t).reduce((s,[c,a])=>{var i;if(c in r){const o=(i=a==null?void 0:a.variation)!=null&&i.startsWith("append")?"withAppend":"withoutAppend";s[o][c]=a}return s},{withAppend:{},withoutAppend:{}})}function _l(e){return Object.keys(e).length>0&&Object.values(e).some(Gr)}function Pl(e,r){const{withAppend:t,withoutAppend:s}=bl(e,r);return jl(s)?U(e.room)&&!de(e.gameMode)?"privateRequired":null:_l(t)?"appendWithAction":"pickSomething"}var wl=Object.defineProperty,Ol=Object.defineProperties,Sl=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,Dr=Object.prototype.hasOwnProperty,Yr=Object.prototype.propertyIsEnumerable,$r=(e,r,t)=>r in e?wl(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,ee=(e,r)=>{for(var t in r||(r={}))Dr.call(r,t)&&$r(e,t,r[t]);if(me)for(var t of me(r))Yr.call(r,t)&&$r(e,t,r[t]);return e},Ie=(e,r)=>Ol(e,Sl(r)),$l=(e,r)=>{var t={};for(var s in e)Dr.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&me)for(var s of me(e))r.indexOf(s)<0&&Yr.call(e,s)&&(t[s]=e[s]);return t},Cl=(e,r,t)=>new Promise((s,c)=>{var a=l=>{try{o(t.next(l))}catch(d){c(d)}},i=l=>{try{o(t.throw(l))}catch(d){c(d)}},o=l=>l.done?s(l.value):Promise.resolve(l.value).then(a,i);o((t=t.apply(e,r)).next())});function Il({closeDialog:e,initialTab:r=0,onOpenSetupWizard:t}){const{user:s}=Sn(),{t:c}=E(),[a,i]=kr(),[o,l]=u.useState(r),[d,p]=u.useState(null),[m,v]=u.useState(!1),[h,j]=In(),$=kn(),{isLoading:w,actionsList:_}=Vn(h==null?void 0:h.gameMode),S=(O,A)=>{l(A)},P=()=>i(Ie(ee({},a),{boardUpdated:!0})),C=u.useCallback(O=>Cl(null,null,function*(){O.preventDefault();const A=h,{displayName:R}=A,k=$l(A,["displayName"]),N=Pl(k,_);return N?(p(c(N)),null):(yield $(h,_),typeof e=="function"&&e(),null)}),[h,_,c,p,$,e]),g=u.useCallback(O=>{j(A=>Ie(ee({},A),{displayName:O.target.value}))},[j]),b=u.useCallback(O=>{O.key==="Enter"&&(j(A=>Ie(ee({},A),{displayName:O.target.value})),C(O))},[C,j]);return!h.room||w?n.jsxs(f,{children:[n.jsxs(x,{variant:"h2",children:[n.jsx(y,{i18nKey:"loading"}),"..."]}),n.jsx(x,{variant:"body1",children:n.jsx(y,{i18nKey:"clearStorage"})})]}):n.jsxs(f,{component:"form",method:"post",onSubmit:C,className:"settings-box",children:[n.jsx(ae,{fullWidth:!0,id:"displayName",label:c("displayName"),defaultValue:(s==null?void 0:s.displayName)||h.displayName||"",required:!0,autoFocus:!0,onBlur:g,onKeyDown:b,margin:"normal"}),n.jsx(f,{sx:{borderBottom:1,borderColor:"divider"},children:n.jsxs(mn,{value:o,onChange:S,"aria-label":c("gameSettings"),centered:!0,children:[n.jsx(xe,ee({label:c("gameboard")},ge(0))),n.jsx(xe,ee({label:c("room")},ge(1))),n.jsx(xe,ee({label:c("application")},ge(2)))]})}),n.jsx(Ce,{value:o,index:0,style:{p:0},children:n.jsx(As,{formData:h,setFormData:j,actionsList:_})}),n.jsx(Ce,{value:o,index:1,style:{p:0,pt:1},children:n.jsx(hl,{formData:h,setFormData:j})}),n.jsx(Ce,{value:o,index:2,style:{p:0,pt:1},children:n.jsx(Wt,{formData:h,setFormData:j,boardUpdated:P})}),n.jsxs("div",{className:"flex-buttons",children:[n.jsxs("div",{className:"left-buttons",children:[t&&n.jsx(q,{variant:"outlined",type:"button",onClick:t,children:n.jsx(y,{i18nKey:"setupWizard"})}),o===0&&n.jsx(q,{variant:"outlined",type:"button",onClick:()=>v(!0),children:n.jsx(y,{i18nKey:"customTilesLabel",children:"Game Tiles"})})]}),n.jsx(q,{variant:"contained",type:"submit",children:n.jsx(y,{i18nKey:"update"})})]}),m&&n.jsx(Tn,{open:m,setOpen:v,boardUpdated:P,actionsList:_}),n.jsx(En,{open:!!d,close:()=>p(null),children:d})]})}const zl=Object.freeze({__proto__:null,default:Il});export{Il as G,nt as L,tt as M,Ce as T,it as Y,Nn as g,zl as i,qn as p,ue as t};
//# sourceMappingURL=chunk-DLsc9B5u.js.map
