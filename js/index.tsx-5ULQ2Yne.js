import{ak as K,r as x,j as e,A as z,aG as R,I as J,W as G,av as L,ar as k,Y as _,am as A,Q as $,T as w,au as a,aA as Q,R as V}from"./chunk-DzAIPjqH.js";import{C as F,A as Y,b as q,c as H}from"./chunk-ePhi2-8W.js";import{C as M}from"./chunk-CcNW6xaX.js";import{Q as O,u as U,e as Z,R as X,S as ee,x as te,s as se,T as ne}from"./chunk-BmjRqaQ3.js";import{a9 as ie,Z as re,aa as ae,v as oe}from"./chunk-DzzEA-5n.js";import{T as le}from"./chunk-B9Y_S9Mk.js";import{u as ce}from"./chunk-BfMAFFX0.js";import{u as de}from"./chunk-ETJJgZWW.js";import"../assets/index-BHv73vX6.js";import"./schedule.tsx-BNzepckN.js";import"./chunk-SagsL35F.js";import"./chunk-D4nXmTaT.js";import"./theme.tsx-kKI91Odf.js";import"./chunk-D0auT6rg.js";import"./chunk-BjQhdd70.js";(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"b0aec1b7336667c3da787da9b7139ec106644213"}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},m=new n.Error().stack;m&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[m]="26ca7ac9-6466-4876-af17-5a1e9f19b865",n._sentryDebugIdIdentifier="sentry-dbid-26ca7ac9-6466-4876-af17-5a1e9f19b865")})()}catch{}function ue({open:n,close:m,setAlert:l,board:r}){const{t:s}=K(),[p,f]=x.useState(""),[c,T]=x.useState(r.title||"");function B(i){try{return c.length?i.map((o,d)=>{const[h,...C]=o.split(`
`).filter(S=>S);if(h===void 0)throw l({message:s("importNoEmpty")});if(!/^\[.+\]$/.test(h))throw l({message:s("importInvalidTitle",{entry:d+1})});if(!C.length)throw l({message:s("importMissingDescription",{entry:d+1})});return{title:h?.replace(/\[|\]/g,""),description:C.join(`
`)}}):(l({message:s("importTitleRequired")}),null)}catch{return null}}const g=async()=>{const i=p.split(/~+/).filter(d=>d),o=B(i);if(!o)return null;try{if(JSON.stringify(r.tiles)===JSON.stringify(o))return l({message:s("importNoChange")}),null}catch{return l({message:s("error"),type:"error"}),null}return O({...r,title:c,tiles:o}),l({message:s("saved"),type:"success"}),m(),null},D=()=>{const i=r?.tiles?.map(o=>{if(!o)return"";const d=o.title||"",h=o.description||"";return`[${d}]
${h}`}).filter(Boolean);f(i?.join(`
~~
`)||"")},I=i=>{T(i.target.value)},b=async i=>{if(!i.target.value.length)return l({message:s("importTitleRequired")}),null;O({...r,title:i.target.value})};return x.useEffect(()=>{n&&D()},[n]),x.useEffect(()=>{T(r.title||"")},[r.title]),e.jsxs(e.Fragment,{children:[e.jsx(z,{fullWidth:!0,label:s("title"),value:c,onChange:I,onBlur:b}),e.jsx(z,{sx:{mt:2},multiline:!0,fullWidth:!0,value:p,onChange:i=>f(i.target.value),InputProps:{endAdornment:e.jsxs("div",{style:{display:"flex",flexDirection:"column",position:"sticky",top:0},children:[e.jsx(R,{title:s("save"),children:e.jsx(J,{size:"small",onClick:g,"aria-label":s("save"),children:e.jsx(ie,{color:"success"})})}),e.jsx(M,{text:p}),e.jsx(M,{text:`${window.location.href}?importBoard=${r.id}`,copiedText:s("copiedLink"),icon:e.jsx(re,{}),tooltip:s("copyShareLink")})]}),sx:{alignItems:"flex-start"}}})]})}function Ie({open:n,close:m,isMobile:l}){const r=ce(ne),[s,p]=x.useState(null),[f,c]=x.useState(0),[T,B]=x.useState(0),g=U()[0],{user:D}=de();if(!r)return null;const I=t=>{if(!t||!t.length)return null;const u=t[t.length-1];return u?.description?u.description.match(/\d+%/g):null},b=t=>{p(t)};async function i({title:t,tiles:u}){const y=u.map(({title:W})=>`* ${W} 
`);y.pop(),y.shift();let j=`### ${a("activated")}: ${t}
`;j+=`---
`,j+=[...new Set(y)].join(" "),j+=`---
`;const v=I(u);v&&v.length===3&&(j+=`* ${a("finishSlider")} ${v[0]}  | ${v[1]} | ${v[2]}`);const N=await te({title:t,gameBoard:JSON.stringify(u),settings:JSON.stringify(g)});N?.id&&await se({room:g?.room||"PUBLIC",user:D,text:j,type:"settings",gameBoardId:N.id,boardSize:u.length,gameMode:g?.gameMode})}const o=async()=>{const t=await Z({isActive:0})||0;B(t)},d=t=>{X(t.id),i(t),p({message:a("boardEnabled"),type:"success"})},h=t=>{t!==0&&c(t)},C=()=>{typeof f=="number"&&ee(f),c(0)},E=t=>(u,y)=>{B(y?t:0)},S=t=>!t.tiles||t.tiles.length!==(g?.roomTileCount||40),P=t=>S(t)?a("boardWrongSize",{size:g?.roomTileCount||40}):t.isActive?a("boardActive"):a("enableBoard");return e.jsxs(e.Fragment,{children:[e.jsxs(G,{fullScreen:l,open:n,onClose:m,PaperProps:{sx:{maxHeight:"100%",height:"100%"}},children:[e.jsxs(L,{children:[e.jsx(k,{i18nKey:"manageGameBoards"}),e.jsx(F,{close:m})]}),e.jsxs(_,{style:{overflowY:"scroll"},children:[e.jsxs(A,{sx:{mb:1},children:[e.jsx($,{variant:"outlined",onClick:o,endIcon:e.jsx(ae,{}),sx:{float:"right"},children:e.jsx(k,{i18nKey:"add"})}),e.jsx(w,{children:e.jsx(k,{i18nKey:"gameBoardDescription"})})]}),r.map(t=>e.jsxs(Y,{expanded:T===t.id,onChange:E(t.id||0),children:[e.jsxs(q,{children:[e.jsxs(A,{children:[e.jsx(w,{variant:"body1",children:t.title}),e.jsx(w,{variant:"body2",children:a("tilesCount",{count:t.tiles?.length||0})})]}),e.jsxs(A,{style:{marginLeft:"auto"},justifyContent:"flex-end",children:[e.jsx(R,{title:P(t),children:e.jsx("div",{style:{display:"inline-block"},children:e.jsx(Q,{checked:!!t.isActive,disabled:!!t.isActive||S(t),onChange:()=>d(t),size:"small"})})}),e.jsx(R,{title:a("delete"),children:e.jsx("span",{style:{display:"inline-block"},children:e.jsx(J,{onClick:()=>h(t.id||0),size:"small",component:"span",children:e.jsx(oe,{color:"error"})})})})]})]}),e.jsx(H,{children:e.jsx(ue,{open:n,close:()=>E(t.id||0)(null,!1),setAlert:b,board:t})})]},t.id))]})]}),e.jsx(le,{open:!!s?.message,type:s?.type||"error",close:()=>p(null),children:s?.message}),e.jsxs(G,{open:!!f,onClose:()=>c(0),children:[e.jsxs(L,{children:[a("deleteBoard"),e.jsx(F,{close:()=>c(0)})]}),e.jsx(_,{children:e.jsx(w,{variant:"body1",children:a("confirmDeleteBoard",{title:r.find(t=>t.id===f)?.title})})}),e.jsxs(V,{children:[e.jsx($,{onClick:()=>c(0),children:a("cancel")}),e.jsx($,{onClick:C,children:a("delete")})]})]})]})}export{Ie as default};
//# sourceMappingURL=index.tsx-5ULQ2Yne.js.map
