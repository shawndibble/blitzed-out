import{R as U,aj as v,b as t,j as E}from"./chunk-DEpGQMoM.js";import{v as w}from"./chunk-C0b6J2Rd.js";import{u as S}from"./chunk-CoGo4D6A.js";import"./chunk-Bb4N9MXk.js";import"./chunk-BxyRzOKK.js";import"./chunk-B9w7spwz.js";(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};n.SENTRY_RELEASE={id:"b82d01bea29447e452b49ba3e85b9fac2f7942a4"}})();try{(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="f7ddd486-8d2e-4375-a5c1-cee49c04e653",n._sentryDebugIdIdentifier="sentry-dbid-f7ddd486-8d2e-4375-a5c1-cee49c04e653")})()}catch(n){}function h(n){if(!n||typeof n!="object")return!1;const e=n;return typeof e.displayName=="string"&&typeof e.uid=="string"&&(e.lastSeen instanceof Date||typeof e.lastSeen=="number"||typeof e.lastSeen=="string")}const _=U.createContext(void 0);function P(n){const{id:e}=v(),{onlineUsers:a,setUsers:d,setRoom:c,clearUsers:f,flushPendingUpdates:p}=S(),l=t.useRef(null),b=t.useRef(e),u=t.useRef(()=>{});t.useEffect(()=>{u.current=r=>{if(r===null)f();else{const i={};Object.entries(r).forEach(([g,o])=>{if(h(o)){const R={...o,lastSeen:o.lastSeen instanceof Date?o.lastSeen:new Date(o.lastSeen)};i[g]=R}else console.warn(`Invalid user data for uid ${g}:`,o)}),d(i)}}},[d,f]);const y=t.useCallback(r=>{var i;(i=u.current)==null||i.call(u,r)},[]),s=t.useCallback(()=>{l.current&&(l.current(),l.current=null),p()},[p]);t.useEffect(()=>{if(b.current!==e&&(c(e||null),b.current=e),!e){s(),f();return}s();const r=w(e,y,a);return l.current=r||null,s},[e,c,f,y,s]),t.useEffect(()=>s,[s]);const m=t.useMemo(()=>({onlineUsers:a}),[a]);return E.jsx(_.Provider,{value:m,...n})}export{_ as UserListContext,P as UserListProvider};
//# sourceMappingURL=userList.tsx-WW2hodBh.js.map
