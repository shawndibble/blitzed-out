const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/getUniqueImportRecords.ts-BA1gG1Vv.js","js/chunk-CVSdvP5Z.js","js/chunk-CNqt7FHs.js","js/chunk-E8HqAuJ1.js","js/chunk-B-cyqPC2.js","js/chunk-BVO8KFPS.js","js/chunk-_SwOSjSw.js","assets/index-CZH-e7F_.js","js/chunk-BeueL4UK.js","js/chunk-guvQFVv-.js","js/chunk-BUoOus3c.js","js/chunk-AkXvan0D.js","js/chunk-84IffDWI.js","js/chunk-BmM2eEZX.js","js/chunk-U-BuBlCh.js","js/chunk-Pkb0UFv2.js","js/chunk-9Rprt94M.js","js/chunk-BO6dzI_Q.js"])))=>i.map(i=>d[i]);
import{b as m,u as ae,j as e,t as C,aw as L,ar as S,Q as X,O as H,ax as J,M as k,S as oe,aP as xt,a3 as ne,ay as ke,a6 as Ce,a8 as Ie,aA as Se,ac as Dt,ab as We,aa as Ge,a7 as we,R as Ot,a5 as Ee,aV as Pe,b4 as Lt,I as le,ae as ve,a4 as Ke,b5 as At,aU as ze,b6 as Be,au as $t,aX as Nt,aF as kt,b7 as Mt,X as Ft,b8 as Rt,at as je}from"./chunk-CVSdvP5Z.js";import{n as _e,u as Vt}from"./chunk-CNqt7FHs.js";import{D as Wt,b as he,c as Me,d as yt,e as Kt,f as zt,h as Bt,j as Ue,k as Ut,t as qt,i as Xt}from"./chunk-E8HqAuJ1.js";import{A as pe,a as me,b as fe,u as De}from"./chunk-BeueL4UK.js";import{T as Ht}from"./chunk-84IffDWI.js";import{q as ye,g as Oe,I as vt,s as bt,_ as jt,J as Fe,K as _t,H as Re,L as Jt,M as Yt,B as Te,x as Qt}from"./chunk-B-cyqPC2.js";import{C as Zt}from"./chunk-BmM2eEZX.js";import{g as es,b as ts}from"./chunk-guvQFVv-.js";import{v as Tt,g as ss,d as rs,e as qe}from"./chunk-U-BuBlCh.js";import{E as Ct,o as Le,p as ns,x as Xe,y as He,r as Je,z as is,t as os,B as ls,F as as,I as cs,J as us,K as ds,g as ps}from"./chunk-_SwOSjSw.js";import{l as ms}from"./chunk-BUoOus3c.js";(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};n.SENTRY_RELEASE={id:"874067a760cfa9079dd7f585e4ceff298b0e879f"}})();try{(function(){var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},r=new n.Error().stack;r&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[r]="9a672b5d-7066-4544-b4fc-0f1c006b95ce",n._sentryDebugIdIdentifier="sentry-dbid-9a672b5d-7066-4544-b4fc-0f1c006b95ce")})()}catch(n){}function It(n){return Object.entries(n).flatMap(([r,{label:s,actions:u}])=>u?Object.keys(u).filter(p=>p!==Wt).map((p,d)=>({group:es(r),groupLabel:s,value:r,intensity:Number(d+1),translatedIntensity:p,label:`${s} - ${p}`})):[])}var de=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});const Ae="2.0.0",fs=2,St=0;function $e(){return de(this,arguments,function*(n="en",r={}){try{let s;if(r.exportScope==="single"&&r.singleGroup){const o=yield ye(r.singleGroup,n);s=o&&!o.isDefault?[o]:[]}else r.exportScope==="default"?s=[]:s=(yield Oe({locale:n})).filter(h=>!h.isDefault);const u=yield Oe({locale:n}),c=new Set(u.filter(o=>o.isDefault).map(o=>o.name)),d=(yield he({isCustom:1})).filter(o=>{const h=!o.locale||o.locale===n;return r.exportScope==="single"&&r.singleGroup?h&&o.group===r.singleGroup:r.exportScope==="default"?h&&c.has(o.group):h}),i={};for(const o of s){const h=o.intensities.sort((E,D)=>E.value-D.value).map(E=>E.label),_=o.intensities.find(E=>E.value===St),T=h.filter(E=>E!==(_==null?void 0:_.label)),F=_?[_.label,...T]:h;i[o.name]={label:o.label,type:o.type||"sex",intensities:F}}const t={};for(const o of d)t[o.group]||(t[o.group]={}),t[o.group][o.intensity]||(t[o.group][o.intensity]=[]),o.tags&&o.tags.length>0?t[o.group][o.intensity].push({action:o.action,tags:o.tags}):t[o.group][o.intensity].push(o.action);const a={};Object.keys(i).sort().forEach(o=>{a[o]=i[o]});const y={};return Object.keys(t).sort().forEach(o=>{y[o]={},Object.keys(t[o]).sort((h,_)=>Number.parseInt(h,10)-Number.parseInt(_,10)).forEach(h=>{y[o][Number.parseInt(h,10)]=t[o][Number.parseInt(h,10)]})}),JSON.stringify({version:Ae,locale:n,groups:a,customTiles:y},(o,h)=>(Array.isArray(h)&&h.length>0&&typeof h[0]=="string",h),fs)}catch(s){throw console.error("Error exporting clean data:",s),new Error(`Export failed: ${s}`)}})}function hs(n){return de(this,arguments,function*(r,s={}){const u={success:!1,importedGroups:0,importedTiles:0,errors:[],warnings:[]};try{let c;try{c=JSON.parse(r)}catch(i){return u.errors.push("Invalid JSON format"),console.warn("Failed to parse import data JSON:",i),u}if(!c.version||!c.groups||!c.customTiles)return u.errors.push("Invalid export format - missing version, groups, or customTiles"),u;c.version!==Ae&&u.warnings.push(`Format version mismatch: expected ${Ae}, got ${c.version}`);const p=s.locale||c.locale||"en",d=s.mergeStrategy||"skip";for(const[i,t]of Object.entries(c.groups))try{const a=yield ye(i,p);let y=i;if(a)switch(d){case"skip":u.warnings.push(`Skipped existing group: ${i}`);continue;case"overwrite":u.warnings.push(`Will update existing group: ${i}`);break;case"rename":{let _=1;for(y=`${i}_imported`;yield ye(y,p);)y=`${i}_imported_${_}`,_++;u.warnings.push(`Renamed group from ${i} to ${y}`);break}}const l=t.intensities.map((_,T)=>({id:`intensity-${T}`,label:_,value:T,isDefault:T===St})),o={name:y,label:t.label,intensities:l,type:t.type,locale:p,isDefault:!1},h=yield Tt(o);if(!h.isValid){u.errors.push(`Invalid group ${y}: ${h.errors.join(", ")}`);continue}a&&d==="overwrite"?yield vt(a.id,o):yield bt(o),u.importedGroups++}catch(a){u.errors.push(`Error importing group ${i}: ${a}`)}for(const[i,t]of Object.entries(c.customTiles))try{const a=yield ye(i,p);if(!a){u.warnings.push(`Group ${i} not found for custom tiles, skipping tiles`);continue}for(const[y,l]of Object.entries(t)){const o=Number.parseInt(y,10);if(!a.intensities.find(_=>_.value===o)){u.warnings.push(`Intensity ${o} not valid for group ${i}, skipping tiles`);continue}for(const _ of l)try{let T,F=[];if(typeof _=="string")T=_;else if(_&&typeof _=="object"&&"action"in _)T=_.action,F=_.tags||[];else{u.warnings.push(`Invalid tile data format in group ${i}, skipping`);continue}if((yield he()).find(O=>O.group===i&&O.intensity===o&&O.action===T&&(!O.locale||O.locale===p))&&d==="skip"){u.warnings.push(`Skipped existing tile: ${T.substring(0,50)}...`);continue}yield Me({group:i,intensity:o,action:T,tags:F,isCustom:1,locale:p}),u.importedTiles++}catch(T){u.errors.push(`Error importing tile "${typeof _=="string"?_.substring(0,30):"object"}...": ${T}`)}}}catch(a){u.errors.push(`Error importing tiles for group ${i}: ${a}`)}return u.success=u.errors.length===0,u}catch(c){return u.errors.push(`Import failed: ${c}`),u}})}function gs(n,r,s="en",u="online"){return de(this,null,function*(){const c={success:!1,importedGroups:0,importedTiles:0,errors:[],warnings:[]};try{const{default:p}=yield jt(()=>import("./getUniqueImportRecords.ts-BA1gG1Vv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])),d=yield he(),{newUniqueRecords:i,changedTagRecords:t}=p(n,d,r);for(const a of i)try{yield Me(a),c.importedTiles++}catch(y){c.errors.push(`Error importing tile: ${y}`)}for(const a of t)try{a.id&&(yield yt(a.id,a))}catch(y){c.errors.push(`Error updating tile: ${y}`)}return c.success=c.errors.length===0,c.warnings.push("Imported using legacy format. Consider exporting in clean v2.0 format for better compatibility."),c}catch(p){return c.errors.push(`Legacy import failed: ${p}`),c}})}function xs(n,r="en"){return de(this,null,function*(){return $e(r,{singleGroup:n,exportScope:"single"})})}function ys(n,r){return de(this,arguments,function*(s,u,c={}){const p=s.trim();try{const d=JSON.parse(p);if(d.version&&d.groups)return hs(p,c);if(d.version&&d.customGroups!==void 0)return{success:!1,importedGroups:0,importedTiles:0,errors:["Old enhanced format no longer supported. Please use clean v2.0 format."],warnings:[]}}catch(d){}return gs(p,u,c.locale||"en",c.gameMode||"online")})}function vs(n="en"){return de(this,null,function*(){try{const s=(yield Oe({locale:n})).filter(c=>!c.isDefault),u=yield he({isCustom:1});return s.map(c=>{const p=u.filter(d=>d.group===c.name&&(!d.locale||d.locale===n));return{name:c.name,label:c.label,tileCount:p.length}})}catch(r){return console.error("Error getting available groups for export:",r),[]}})}var ge=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});function bs({expanded:n,handleChange:r,customTiles:s,mappedGroups:u,setSubmitMessage:c,bulkImport:p}){const d=m.useRef(null),{t:i}=ae(),{settings:t}=Fe(),[a,y]=m.useState(""),[l,o]=m.useState(null),[h,_]=m.useState("clean"),[T,F]=m.useState("all"),[E,D]=m.useState(""),[O,$]=m.useState([]),[g,N]=m.useState("skip"),K=m.useCallback(()=>ge(null,null,function*(){try{if(h==="clean"){let f;switch(T){case"single":if(!E){c({message:i("errors.selectGroupToExport"),type:"error"});return}f=yield xs(E,t.locale||"en");break;case"default":f=yield $e(t.locale||"en",{exportScope:"default"});break;default:f=yield $e(t.locale||"en",{exportScope:"all"});break}y(f)}else{const x=s.filter(j=>j.isCustom).map(({group:j,intensity:G,action:B,tags:R,gameMode:z="online"})=>{const V=It(u[z]||{}).find(P=>(P==null?void 0:P.intensity)===Number(G)&&(P==null?void 0:P.value)===j);let b="";return b+=`[${(V==null?void 0:V.group)||j} - ${(V==null?void 0:V.translatedIntensity)||G}]
`,b+=B,b+=R!=null&&R.length?`
Tags: `+(R==null?void 0:R.join(", ")):"",b+=`
GameMode: ${z}`,b});y(x.join(`
---
`))}}catch(f){console.error("Error exporting data:",f),c({message:i("errors.exportFailed",{error:f}),type:"error"})}}),[s,u,y,h,T,E,t.locale,c,i]);function A(f){return ge(this,null,function*(){if(!f.current)return;const j=f.current.importData.value;if(!j.trim())return c({type:"error",message:i("enterDataToImport")});try{c({type:"info",message:i("importMessages.importing")});const G=yield ys(j,u,{locale:t.locale||"en",mergeStrategy:g});if(o(G),G.success){G.importedTiles>0&&(yield jt(()=>import("./chunk-E8HqAuJ1.js").then(function(z){return z.p}),__vite__mapDeps([3,4,1,2,5,6,7])).then(z=>z.getTiles({isCustom:1}))).slice(-G.importedTiles).forEach(z=>ge(null,null,function*(){_t(`${z.group} - ${z.intensity}`,z.action)}));let B=i("importMessages.importSuccess");G.importedGroups>0&&(B+=` ${i("importMessages.importedGroups",{count:G.importedGroups})}`),G.importedTiles>0&&(B+=` ${i("importMessages.importedTiles",{count:G.importedTiles})}`),c({type:"success",message:B}),yield K()}else c({type:"error",message:i("errors.importFailed",{errors:G.errors.join(", ")})})}catch(G){console.error("Import error:",G),c({type:"error",message:i("errors.importFailed",{errors:G.message||G})}),o(null)}})}const w=m.useCallback(()=>ge(null,null,function*(){try{const f=yield vs(t.locale||"en");$(f)}catch(f){console.error("Error loading available groups:",f)}}),[t.locale]);return m.useEffect(()=>{n==="ctImport"&&(w(),K())},[n,s,K,w]),e.jsxs(pe,{expanded:n==="ctImport",onChange:r("ctImport"),className:"about-accordion",children:[e.jsx(me,{"aria-controls":"ctImport-content",id:"ctImport-header",children:e.jsx(C,{className:"accordion-title",children:e.jsx(L,{i18nKey:"importExport"})})}),e.jsxs(fe,{children:[e.jsx(C,{variant:"body1",sx:{mb:2},children:e.jsx(L,{i18nKey:"ctImportDescription"})}),e.jsxs(S,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:2,"& .MuiFormControl-root":{minWidth:150,flex:"1 1 auto"}},children:[e.jsxs(X,{size:"small",children:[e.jsx(H,{children:i("labels.exportFormat")}),e.jsxs(J,{value:h,onChange:f=>_(f.target.value),label:i("labels.exportFormat"),children:[e.jsx(k,{value:"clean",children:i("exportFormat.clean")}),e.jsx(k,{value:"legacy",children:i("exportFormat.legacy")})]})]}),h==="clean"&&e.jsxs(X,{size:"small",children:[e.jsx(H,{children:i("labels.exportScope")}),e.jsxs(J,{value:T,onChange:f=>{F(f.target.value),D("")},label:i("labels.exportScope"),children:[e.jsx(k,{value:"all",children:i("exportScope.all")}),e.jsx(k,{value:"default",children:i("exportScope.default")}),e.jsx(k,{value:"single",children:i("exportScope.single")})]})]}),e.jsxs(X,{size:"small",children:[e.jsx(H,{children:i("labels.importStrategy")}),e.jsxs(J,{value:g,onChange:f=>N(f.target.value),label:i("labels.importStrategy"),children:[e.jsx(k,{value:"skip",children:i("importStrategy.skip")}),e.jsx(k,{value:"overwrite",children:i("importStrategy.overwrite")}),e.jsx(k,{value:"rename",children:i("importStrategy.rename")})]})]})]}),h==="clean"&&T==="single"&&e.jsx(S,{sx:{mb:2},children:e.jsxs(X,{size:"small",fullWidth:!0,children:[e.jsx(H,{children:i("labels.selectGroup")}),e.jsx(J,{value:E,onChange:f=>D(f.target.value),label:i("labels.selectGroup"),children:O.map(f=>e.jsxs(k,{value:f.name,children:[f.label," (",f.tileCount," tiles)"]},f.name))})]})}),e.jsxs(S,{component:"form",method:"post",ref:d,children:[e.jsx(oe,{id:"importData",name:"importData",multiline:!0,required:!0,fullWidth:!0,rows:6,sx:{pb:2},value:a,onChange:f=>y(f.target.value),placeholder:i(h==="clean"?"placeholder.cleanFormat":"placeholder.legacyFormat"),InputProps:{endAdornment:e.jsx(Zt,{text:a}),sx:{alignItems:"flex-start"}}}),l&&e.jsxs(xt,{severity:l.success?"success":"error",sx:{mb:2},onClose:()=>o(null),children:[e.jsx(C,{variant:"body2",children:e.jsx("strong",{children:e.jsx(L,{i18nKey:"importResults.title"})})}),l.importedGroups>0&&e.jsxs(C,{variant:"body2",children:["â€¢"," ",e.jsx(L,{i18nKey:"importResults.groupsImported",values:{count:l.importedGroups}})]}),l.importedTiles>0&&e.jsxs(C,{variant:"body2",children:["â€¢"," ",e.jsx(L,{i18nKey:"importResults.tilesImported",values:{count:l.importedTiles}})]}),l.warnings.length>0&&e.jsxs(S,{sx:{mt:1},children:[e.jsx(C,{variant:"body2",color:"warning.main",children:e.jsx("strong",{children:e.jsx(L,{i18nKey:"importResults.warnings"})})}),l.warnings.map((f,x)=>e.jsxs(C,{variant:"body2",color:"warning.main",children:["â€¢ ",f]},x))]}),l.errors.length>0&&e.jsxs(S,{sx:{mt:1},children:[e.jsx(C,{variant:"body2",color:"error.main",children:e.jsx("strong",{children:e.jsx(L,{i18nKey:"importResults.errors"})})}),l.errors.map((f,x)=>e.jsxs(C,{variant:"body2",color:"error.main",children:["â€¢ ",f]},x))]})]}),e.jsx(ne,{fullWidth:!0,variant:"contained",type:"button",onClick:()=>A(d),children:e.jsx(L,{i18nKey:"import"})})]}),h==="clean"&&e.jsxs(pe,{sx:{mt:2},className:"about-accordion",children:[e.jsx(me,{children:e.jsx(C,{variant:"subtitle2",className:"accordion-title",children:e.jsx(L,{i18nKey:"formatGuide.title"})})}),e.jsxs(fe,{children:[e.jsx(C,{variant:"body2",sx:{mb:2},children:e.jsx(L,{i18nKey:"formatGuide.description"})}),e.jsx(C,{variant:"body2",sx:{mb:1,fontWeight:"bold"},children:e.jsx(L,{i18nKey:"formatGuide.keySections"})}),e.jsx(C,{variant:"body2",component:"div",sx:{mb:2,ml:2},children:e.jsx(L,{i18nKey:"formatGuide.keySectionsContent",components:{strong1:e.jsx("strong",{}),strong2:e.jsx("strong",{}),br:e.jsx("br",{})}})}),e.jsx(C,{variant:"body2",sx:{mb:1,fontWeight:"bold"},children:e.jsx(L,{i18nKey:"formatGuide.manualEditing"})}),e.jsx(C,{variant:"body2",component:"div",sx:{mb:2,ml:2},children:e.jsx(L,{i18nKey:"formatGuide.manualEditingContent",components:{br:e.jsx("br",{})}})}),e.jsx(C,{variant:"body2",sx:{mb:1,fontWeight:"bold"},children:e.jsx(L,{i18nKey:"formatGuide.customTilesFormat"})}),e.jsx(C,{variant:"body2",component:"div",sx:{ml:2},children:e.jsx(L,{i18nKey:"formatGuide.customTilesFormatContent",components:{br:e.jsx("br",{}),code1:e.jsx("code",{}),code2:e.jsx("code",{})}})})]})]})]})]})}var js=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});function _s({value:n,onChange:r,locale:s,gameMode:u,includeDefault:c=!0,disabled:p=!1,refreshTrigger:d=0}){const{t:i}=ae(),[t,a]=m.useState([]),[y,l]=m.useState(!0);return m.useEffect(()=>{js(null,null,function*(){l(!0);try{const h=yield Re(s,u),_=c?h:h.filter(T=>!T.isDefault);a(_)}catch(h){console.error("Error loading custom groups:",h),a([])}finally{l(!1)}})},[s,u,c,d]),y?e.jsxs(X,{fullWidth:!0,disabled:!0,children:[e.jsx(H,{children:i("customGroups.loadingGroups")}),e.jsx(J,{value:"",children:e.jsx(k,{value:"",children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ke,{size:16}),e.jsx("span",{children:i("customGroups.loadingGroups")})]})})})]}):e.jsx(S,{children:e.jsxs(X,{fullWidth:!0,disabled:p,children:[e.jsx(H,{id:"group-label",children:i("group")}),e.jsx(J,{labelId:"group-label",value:n,onChange:o=>r(o.target.value),label:i("group"),children:t.length===0?e.jsx(k,{value:"",disabled:!0,children:e.jsx(C,{color:"text.secondary",children:i("customGroups.noGroupsAvailable",{locale:s,gameMode:u})})}):t.map(o=>e.jsx(k,{value:o.name,children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:o.label}),o.isDefault&&e.jsx(Ce,{label:i("default"),size:"small",variant:"outlined"})]})},o.id))})]})})}var Ts=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});function Cs({groupName:n,value:r,onChange:s,locale:u,gameMode:c,disabled:p=!1}){const{t:d}=ae(),[i,t]=m.useState([]),[a,y]=m.useState(!1);m.useEffect(()=>{Ts(null,null,function*(){if(!n){t([]);return}y(!0);try{const h=yield Jt(n,u,c);t(h)}catch(h){console.error("Error loading group intensities:",h),t([])}finally{y(!1)}})},[n,u,c]);const l=m.useMemo(()=>i.sort((o,h)=>o.value-h.value),[i]);return m.useEffect(()=>{if(i.length>0&&r&&!i.some(o=>o.value===r)){const o=l[0];o&&s(o.value)}},[i,r,s,l]),n?a?e.jsxs(X,{fullWidth:!0,disabled:!0,children:[e.jsx(H,{children:d("customGroups.loadingIntensities")}),e.jsx(J,{value:"",children:e.jsx(k,{value:"",children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ke,{size:16}),e.jsx("span",{children:d("customGroups.loadingIntensities")})]})})})]}):i.length===0?e.jsxs(X,{fullWidth:!0,disabled:!0,children:[e.jsx(H,{children:d("intensity")}),e.jsx(J,{value:"",children:e.jsx(k,{value:"",disabled:!0,children:e.jsx(C,{color:"text.secondary",children:d("customGroups.noIntensitiesAvailable",{groupName:n})})})})]}):e.jsx(S,{children:e.jsxs(X,{fullWidth:!0,disabled:p,children:[e.jsx(H,{children:d("intensity")}),e.jsx(J,{value:r||"",onChange:o=>s(Number(o.target.value)),label:d("intensity"),children:l.map(o=>e.jsx(k,{value:o.value,children:o.label},o.id))})]})}):e.jsxs(X,{fullWidth:!0,disabled:!0,children:[e.jsx(H,{children:d("intensity")}),e.jsx(J,{value:"",children:e.jsx(k,{value:"",disabled:!0,children:e.jsx(C,{color:"text.secondary",children:d("customGroups.selectGroupFirst")})})})]})}const Ne=[{name:"Basic (1-4)",intensities:[{label:"intensityLabels.light",value:1,isDefault:!0},{label:"intensityLabels.medium",value:2,isDefault:!0},{label:"intensityLabels.intense",value:3,isDefault:!0},{label:"intensityLabels.extreme",value:4,isDefault:!0}]},{name:"Simple (1-3)",intensities:[{label:"intensityLabels.beginner",value:1,isDefault:!0},{label:"intensityLabels.intermediate",value:2,isDefault:!0},{label:"intensityLabels.advanced",value:3,isDefault:!0}]},{name:"Extended (1-5)",intensities:[{label:"intensityLabels.veryLight",value:1,isDefault:!0},{label:"intensityLabels.light",value:2,isDefault:!0},{label:"intensityLabels.medium",value:3,isDefault:!0},{label:"intensityLabels.intense",value:4,isDefault:!0},{label:"intensityLabels.veryIntense",value:5,isDefault:!0}]}];var Is=Object.defineProperty,Ss=Object.defineProperties,Gs=Object.getOwnPropertyDescriptors,Ye=Object.getOwnPropertySymbols,ws=Object.prototype.hasOwnProperty,Es=Object.prototype.propertyIsEnumerable,Qe=(n,r,s)=>r in n?Is(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,Ps=(n,r)=>{for(var s in r||(r={}))ws.call(r,s)&&Qe(n,s,r[s]);if(Ye)for(var s of Ye(r))Es.call(r,s)&&Qe(n,s,r[s]);return n},Ds=(n,r)=>Ss(n,Gs(r)),ue=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});const Ze=n=>{const r=Ne.findIndex(s=>s.intensities.length===n.length);return r>=0?r:1};function Os({open:n,onClose:r,onGroupCreated:s,onGroupUpdated:u,editingGroup:c,locale:p,gameMode:d}){var i;const{t}=ae(),[a,y]=m.useState(0),[l,o]=m.useState([]),[h,_]=m.useState(!0),[T,F]=m.useState({}),E=ss(),[D,O]=m.useState(""),[$,g]=m.useState(""),[N,K]=m.useState(1),[A,w]=m.useState([t("intensityLabels.beginner"),t("intensityLabels.intermediate"),t("intensityLabels.advanced")]),[f,x]=m.useState(null),[j,G]=m.useState(!1),[B,R]=m.useState({isValid:!0,errors:[]}),[z,Y]=m.useState(!1),[V,b]=m.useState(null),P=m.useCallback(()=>ue(null,null,function*(){try{const I=(yield Re(p,d)).filter(q=>!q.isDefault);o(I);const M={};yield Promise.all(I.map(q=>ue(null,null,function*(){M[q.id]=yield Kt(q.name,p,d)}))),F(M)}catch(v){console.error("Error reloading groups:",v)}}),[p,d]);m.useEffect(()=>{ue(null,null,function*(){if(n){_(!0);try{yield P()}catch(I){console.error("Error loading groups:",I)}finally{_(!1)}}})},[n,p,d,P]);const W=v=>v.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").substring(0,20)||`group_${_e(6).toLowerCase()}`;m.useEffect(()=>{c?(x(c),O(c.label),g(c.type||""),w(c.intensities.map(v=>v.label)),K(Ze(c.intensities))):f?(O(f.label),g(f.type||""),w(f.intensities.map(v=>v.label)),K(Ze(f.intensities))):(x(null),O(""),g(""),K(1),w([t("intensityLabels.beginner"),t("intensityLabels.intermediate"),t("intensityLabels.advanced")])),R({isValid:!0,errors:[]})},[c,f,n,t]);const ee=v=>{const I=Ne[v];K(v),w(I.intensities.map(M=>t(M.label)))},te=(v,I)=>{const M=[...A];M[v]=I,w(M)},se=()=>{A.length>=E.MAX_INTENSITIES_COUNT||w([...A,t("customGroups.levelLabel",{level:A.length+1})])},ie=v=>{if(A.length<=E.MIN_INTENSITIES_COUNT)return;const I=A.filter((M,q)=>q!==v);w(I)};m.useEffect(()=>{ue(null,null,function*(){if(!D.trim()&&!$&&A.length===0){R({isValid:!0,errors:[]});return}const I=[];if($&&!E.VALID_GROUP_TYPES.includes($)&&I.push(t("typeValidationError",{types:E.VALID_GROUP_TYPES.join(", ")})),D.trim()&&!$&&I.push(t("typeRequiredError")),I.length>0){R({isValid:!1,errors:I});return}const M=A.map((Et,Pt)=>({id:_e(),label:Et,value:Pt+1,isDefault:!1})),q={name:f?f.name:W(D),label:D.trim(),intensities:M,type:$||void 0,locale:p,gameMode:d,isDefault:!1},wt=yield Tt(q,f==null?void 0:f.id);R(wt)})},[D,$,A,p,d,f,t,E.VALID_GROUP_TYPES]);const U=v=>{x(v),O(v.label),w(v.intensities.map(I=>I.label)),y(1)},ce=v=>ue(null,null,function*(){const I=l.find(q=>q.id===v);if(!I)return;const M=T[v]||0;b({id:v,name:I.label,tileCount:M}),Y(!0)}),be=()=>ue(null,null,function*(){if(!V)return;const{id:v,tileCount:I}=V,M=l.find(q=>q.id===v);if(M)try{I>0&&(yield zt(M.name,p,d)),yield Yt(v),yield P(),u==null||u(null)}catch(q){console.error("Error deleting group:",q)}finally{Y(!1),b(null)}}),Gt=()=>ue(null,null,function*(){if(!(!B.isValid||j)){G(!0);try{const v=A.map((M,q)=>({id:_e(),label:M,value:q+1,isDefault:!1})),I={name:f?f.name:W(D),label:D.trim(),intensities:v,type:$||void 0,locale:p,gameMode:d,isDefault:!1};if(f)yield vt(f.id,I),u==null||u(f);else{const M=yield bt(I);M&&(s==null||s(Ds(Ps({},I),{id:M,createdAt:new Date,updatedAt:new Date,isDefault:!1,locale:p,gameMode:d})))}Ve(),r()}catch(v){console.error("Error saving custom group:",v),R({isValid:!1,errors:[t("failedToSaveGroup",{error:v})]})}finally{G(!1)}}}),Ve=()=>{x(null),O(""),g(""),K(1),w([t("intensityLabels.beginner"),t("intensityLabels.intermediate"),t("intensityLabels.advanced")]),R({isValid:!0,errors:[]})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{open:n,onClose:r,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"600px"}},children:[e.jsxs(Se,{children:[t("customGroups.manageCustomGroups"),e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t("customGroups.createNewGroupsDescription")}),e.jsxs(Dt,{value:a,onChange:(v,I)=>{y(I),I===1&&!f&&Ve()},sx:{mt:2,borderBottom:1,borderColor:"divider"},children:[e.jsx(We,{label:t("customGroups.existingGroups")}),e.jsx(We,{label:t(f?"customGroups.editGroup":"customGroups.createNew")})]})]}),e.jsxs(Ge,{dividers:!0,children:[a===0&&e.jsx(S,{children:h?e.jsx(C,{children:t("Loading groups...")}):l.length===0?e.jsx(C,{color:"text.secondary",sx:{textAlign:"center",py:4},children:t("customGroups.noCustomGroupsFound")}):e.jsx(we,{children:l.map((v,I)=>e.jsxs(Ot.Fragment,{children:[e.jsxs(Ee,{children:[e.jsx(Pe,{primary:v.label,secondary:e.jsxs(S,{component:"span",sx:{display:"block"},children:[e.jsxs(C,{variant:"body2",color:"text.secondary",component:"span",sx:{display:"block"},children:[t("customGroups.intensityLevelsCount",{count:v.intensities.length}),": ",v.intensities.map(M=>M.label).join(", ")]}),e.jsx(C,{variant:"body2",color:"text.secondary",component:"span",sx:{display:"block",mt:.5},children:t("customGroups.customTilesCount",{count:T[v.id]||0})})]})}),e.jsxs(Lt,{children:[e.jsx(le,{edge:"end","aria-label":"edit",onClick:()=>U(v),sx:{mr:1},children:e.jsx(Ct,{})}),e.jsx(le,{edge:"end","aria-label":"delete",onClick:()=>ce(v.id),color:"error",children:e.jsx(Le,{})})]})]}),I<l.length-1&&e.jsx(ve,{})]},v.id))})}),a===1&&e.jsxs(S,{sx:{display:"flex",flexDirection:"column",gap:3},children:[!B.isValid&&e.jsx(xt,{severity:"error",children:B.errors.map((v,I)=>e.jsx("div",{children:v},I))}),e.jsxs(S,{sx:{p:2,bgcolor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[e.jsx(C,{variant:"h6",sx:{mb:2},children:t("customGroups.groupInformation")}),e.jsx(oe,{label:t("customGroups.groupLabel"),value:D,onChange:v=>O(v.target.value),placeholder:"e.g., My Custom Group",helperText:t("customGroups.groupLabelHelp",{maxLength:E.MAX_GROUP_LABEL_LENGTH}),fullWidth:!0,required:!0,error:D.trim().length>0&&!rs(D).isValid,sx:{mb:2}}),e.jsxs(oe,{select:!0,label:t("customGroups.groupType"),value:$,onChange:v=>g(v.target.value),helperText:t("customGroups.groupTypeHelp"),fullWidth:!0,required:!0,error:D.trim().length>0&&!$,sx:{mb:2},children:[e.jsx(k,{value:"",children:e.jsx("em",{children:t("groupTypes.selectType")})}),e.jsx(k,{value:"solo",children:t("groupTypes.solo")}),e.jsx(k,{value:"foreplay",children:t("groupTypes.foreplay")}),e.jsx(k,{value:"sex",children:t("groupTypes.sex")}),e.jsx(k,{value:"consumption",children:t("groupTypes.consumption")})]}),e.jsxs(S,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(C,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:t("customGroups.locale")})," ",p," |"," ",e.jsx("strong",{children:t("customGroups.gameMode")})," ",d]}),f?e.jsxs(C,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:t("customGroups.internalId")})," ",f.name," ","(locked)"]}):e.jsxs(C,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:t("customGroups.internalId")})," ",D?W(D):t("customGroups.autoGenerated")]})]})]}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:2,p:2,bgcolor:"action.hover",borderRadius:1},children:[e.jsx(C,{variant:"body2",sx:{fontWeight:"medium",minWidth:"auto"},children:t("customGroups.quickStart")}),e.jsx(oe,{select:!0,value:N,onChange:v=>ee(Number(v.target.value)),size:"small",sx:{minWidth:200},label:t("customGroups.chooseTemplate"),children:Ne.map((v,I)=>e.jsx(k,{value:I,children:v.name==="Basic (1-4)"?t("templateBasic"):v.name==="Simple (1-3)"?t("templateSimple"):v.name==="Extended (1-5)"?t("templateExtended"):v.name},I))}),e.jsx(C,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.75rem"},children:t("customGroups.selectTemplateDescription")})]}),e.jsxs(S,{children:[e.jsxs(C,{variant:"h6",sx:{mb:2},children:[t("customGroups.intensityLabels")," (",A.length,"/",E.MAX_INTENSITIES_COUNT,")"]}),e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t("customGroups.customizeIntensityDescription")}),e.jsxs(S,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[A.map((v,I)=>e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(C,{variant:"body2",sx:{minWidth:"30px",fontWeight:"bold",color:"primary.main"},children:I+1}),e.jsx(oe,{label:t("customGroups.levelInputLabel",{level:I+1}),value:v,onChange:M=>te(I,M.target.value),size:"small",sx:{flex:1},inputProps:{maxLength:E.MAX_INTENSITY_LABEL_LENGTH}}),e.jsx(le,{onClick:()=>ie(I),disabled:A.length<=E.MIN_INTENSITIES_COUNT,color:"error",size:"small",children:e.jsx(Le,{})})]},I)),e.jsx(ne,{startIcon:e.jsx(ns,{}),onClick:se,disabled:A.length>=E.MAX_INTENSITIES_COUNT,variant:"outlined",size:"small",sx:{alignSelf:"flex-start",mt:1},children:t("customGroups.addIntensityLevel")})]})]})]})]}),e.jsxs(Ke,{children:[e.jsx(ne,{onClick:r,disabled:j,children:t("cancel")}),e.jsx(ne,{onClick:Gt,variant:"contained",disabled:!B.isValid||j,children:t(j?"customGroups.saving":f?"customGroups.updateGroup":"customGroups.createGroup")})]})]}),e.jsxs(Ie,{open:z,onClose:()=>Y(!1),children:[e.jsx(Se,{children:t("customGroups.confirmDelete")}),e.jsx(Ge,{children:e.jsx(C,{children:((i=V==null?void 0:V.tileCount)!=null?i:0)>0?t("customGroups.deleteGroupWithTiles",{name:V==null?void 0:V.name,count:V==null?void 0:V.tileCount}):t("customGroups.deleteGroupConfirm",{name:V==null?void 0:V.name})})}),e.jsxs(Ke,{children:[e.jsx(ne,{onClick:()=>Y(!1),children:t("cancel")}),e.jsx(ne,{onClick:be,color:"error",variant:"contained",children:t("delete")})]})]})]})}var Ls=Object.defineProperty,As=Object.defineProperties,$s=Object.getOwnPropertyDescriptors,et=Object.getOwnPropertySymbols,Ns=Object.prototype.hasOwnProperty,ks=Object.prototype.propertyIsEnumerable,tt=(n,r,s)=>r in n?Ls(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,Q=(n,r)=>{for(var s in r||(r={}))Ns.call(r,s)&&tt(n,s,r[s]);if(et)for(var s of et(r))ks.call(r,s)&&tt(n,s,r[s]);return n},Z=(n,r)=>As(n,$s(r)),st=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});function Ms({setSubmitMessage:n,boardUpdated:r,customTiles:s,mappedGroups:u,expanded:c,handleChange:p,tagList:d,updateTileId:i,setUpdateTileId:t}){const{t:a}=ae(),{settings:y}=Fe(),[l,o]=m.useState({gameMode:y.gameMode||"online",group:"",intensity:"",action:"",tags:[a("custom")]}),[h,_]=m.useState(!1),[T,F]=m.useState(""),[E,D]=m.useState(0);m.useEffect(()=>{const j=setTimeout(()=>st(null,null,function*(){if(!l.group||!l.intensity||!l.action){F("");return}try{const G=yield qe({group:l.group,intensity:Number(l.intensity),action:l.action,tags:l.tags,gameMode:l.gameMode,isCustom:1},y.locale||"en",l.gameMode);G.isValid?F(""):F(G.errors.join(", "))}catch(G){console.error("Error validating tile:",G),F("")}}),300);return()=>clearTimeout(j)},[l.group,l.intensity,l.action,l.gameMode,l.tags,y.locale]),m.useEffect(()=>{const j=(Array.isArray(s)?s:[]).find(({id:G})=>G===i);if(j){const G=j.gameMode||y.gameMode;o({gameMode:G,group:j.group||"",intensity:j.intensity||"",action:j.action||"",tags:j.tags||[a("custom")]})}else o(G=>Z(Q({},G),{gameMode:y.gameMode}))},[i,y.gameMode,s,a]);function O(x,j,G){return(Array.isArray(s)?s:[]).find(R=>R.group===x&&R.intensity===j&&R.action===G)}function $(){t(null),o({gameMode:y.gameMode,group:"",intensity:"",action:"",tags:[a("custom")]}),F("")}const g=x=>{o(j=>Z(Q({},j),{group:x.name,intensity:""})),_(!1),D(j=>j+1)},N=()=>{D(x=>x+1)},K=m.useCallback(x=>{o(j=>Z(Q({},j),{intensity:x.toString()}))},[]);function A(){return st(this,null,function*(){const x=document.querySelector('input[name="tags"]'),j=[...l.tags];x&&x.value.trim()&&(j.push(x.value.trim()),x.value="");const{gameMode:G,group:B,intensity:R,action:z}=l;if(!G||!B||!R||!z)return n({message:a("allFieldsRequired","All fields are required"),type:"error"});if(T)return n({message:T,type:"error"});if(i==null&&O(B,R,z))return n({message:a("actionExists"),type:"error"});const Y={group:B,intensity:Number(R),action:z,tags:j,gameMode:G,isCustom:1};try{const V=yield qe(Y,y.locale||"en",G);if(!V.isValid)return n({message:V.errors.join(", "),type:"error"});if(i===null){const b=`${B} - Level ${R}`;_t(b,z),yield Me(Y)}else yield yt(i,Y);return r(),o(b=>Z(Q({},b),{action:"",tags:[a("custom")]})),n({message:a(i?"customUpdated":"customAdded"),type:"success"})}catch(V){return console.error("Error saving custom tile:",V),n({message:a("errorSavingTile"),type:"error"})}})}const w=x=>{switch(x.key){case",":case"Enter":{x.preventDefault(),x.stopPropagation(),x.currentTarget.value.length>0&&(o(j=>Z(Q({},j),{tags:[...j.tags,x.currentTarget.value]})),x.currentTarget.value="");break}}},f=x=>{x.target.value.length>0&&(o(j=>Z(Q({},j),{tags:[...j.tags,x.target.value]})),x.target.value=""),setTimeout(()=>{const j=document.querySelector(".MuiAutocomplete-popper");j&&(j.style.display="none")},150)};return e.jsxs(e.Fragment,{children:[e.jsxs(pe,{expanded:c==="ctAdd",onChange:p("ctAdd"),className:"about-accordion",children:[e.jsx(me,{"aria-controls":"ctAdd-content",id:"ctAdd-header",children:e.jsx(C,{className:"accordion-title",children:e.jsx(L,{i18nKey:i?"ctUpdate":"ctAdd"})})}),e.jsx(fe,{children:e.jsxs(S,{component:"form",method:"post",className:"settings-box",children:[e.jsxs(oe,{select:!0,label:a("customTiles.gameMode"),value:l.gameMode,onChange:x=>{o(j=>Z(Q({},j),{gameMode:x.target.value,group:"",intensity:""}))},fullWidth:!0,sx:{mb:2},children:[e.jsx("option",{value:"online",children:a("online")}),e.jsx("option",{value:"local",children:a("local")}),e.jsx("option",{value:"solo",children:a("solo")})]}),e.jsx(_s,{value:l.group,onChange:x=>{o(j=>Z(Q({},j),{group:x,intensity:""}))},locale:y.locale||"en",gameMode:l.gameMode,refreshTrigger:E}),e.jsx(S,{sx:{mt:2},children:e.jsx(Cs,{groupName:l.group,value:Number(l.intensity)||0,onChange:K,locale:y.locale||"en",gameMode:l.gameMode})}),T&&e.jsx(S,{sx:{mt:1,mb:2},children:e.jsx(C,{color:"error",variant:"body2",children:T})}),e.jsx(oe,{id:"action",name:"action",required:!0,fullWidth:!0,label:a("action"),sx:{mt:2,pb:2},value:l.action,onChange:x=>{o(Z(Q({},l),{action:x.target.value}))}}),e.jsx(At,{id:"tags",disableCloseOnSelect:!0,multiple:!0,freeSolo:!0,options:d,value:l.tags,onChange:(x,j)=>{o(Z(Q({},l),{tags:j}))},renderInput:x=>(x.inputProps.onKeyDown=w,x.inputProps.onBlur=f,e.jsx(oe,Z(Q({},x),{label:a("tags")}))),sx:{pb:2},clearOnBlur:!0,blurOnSelect:!0,openOnFocus:!0,disablePortal:!1,componentsProps:{popper:{modifiers:[{name:"preventOverflow",options:{altAxis:!0,altBoundary:!0,padding:8}}]}}}),e.jsxs(S,{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:{xs:"stretch",sm:"space-evenly"},gap:1,children:[e.jsx(ne,{variant:"outlined",type:"button",onClick:()=>_(!0),children:a("manageGroups")}),e.jsx(ne,{variant:"contained",type:"button",onClick:()=>$(),children:e.jsx(L,{i18nKey:"clear"})}),e.jsx(ne,{variant:"contained",type:"button",onClick:A,children:e.jsx(L,{i18nKey:i?"ctUpdate":"ctAdd"})})]})]})})]}),e.jsx(Os,{open:h,onClose:()=>_(!1),onGroupCreated:g,onGroupUpdated:N,locale:y.locale||"en",gameMode:l.gameMode})]})}var Fs=Object.defineProperty,Rs=Object.defineProperties,Vs=Object.getOwnPropertyDescriptors,rt=Object.getOwnPropertySymbols,Ws=Object.prototype.hasOwnProperty,Ks=Object.prototype.propertyIsEnumerable,nt=(n,r,s)=>r in n?Fs(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,it=(n,r)=>{for(var s in r||(r={}))Ws.call(r,s)&&nt(n,s,r[s]);if(rt)for(var s of rt(r))Ks.call(r,s)&&nt(n,s,r[s]);return n},ot=(n,r)=>Rs(n,Vs(r));function zs({expanded:n,handleChange:r}){const s=De(),[u,c]=m.useState({}),[p,d]=m.useState({}),i=l=>{c(o=>ot(it({},o),{[l]:!o[l]}))},t=l=>{d(o=>ot(it({},o),{[l]:!o[l]}))},a=[{id:"custom-actions",icon:e.jsx(Xe,{}),title:"Custom Actions",description:"Add your own personalized activities to the game",tip:"Think of custom tiles as your personal touch - add activities that match your style and preferences perfectly.",color:"primary"},{id:"category-intensity",icon:e.jsx(os,{}),title:"Category & Intensity Rules",description:"Tiles appear based on your game settings",tip:"Your tiles only show up when you select their category and intensity level (or higher) in game settings.",color:"secondary"}],y=[{id:"new-activities",icon:e.jsx(ls,{}),title:"New Activities",description:"Create unique actions not in the default list",tips:["Think outside the box - what creative activities would make your game more exciting?",'Add themed tiles like "Movie Night Actions" or "Kitchen Adventures"',"Create seasonal tiles for holidays or special occasions","Design role-play scenarios with specific character actions"],color:"primary"},{id:"intensity-boost",icon:e.jsx(as,{}),title:"Early Intensity Boost",description:"Add advanced tiles to beginner levels",tips:["Pro tip: Add exciting advanced tiles to lower intensities to start games with more energy.","Copy your favorite advanced tiles and add them to beginner categories",'Create "gateway" tiles that introduce advanced concepts gradually',"Mix easy and challenging elements in the same tile for variety"],color:"secondary"},{id:"mix-match",icon:e.jsx(cs,{}),title:"Mix & Match",description:"Combine different activities into one tile",tips:["Mix activities that don't usually go together for unexpected combinations.","Combine physical actions with mental challenges or games","Create multi-step tiles that build on each other","Blend different intensity levels within a single creative tile"],color:"success"},{id:"custom-groups",icon:e.jsx(us,{}),title:"Custom Groups",description:"Create your own tile categories with unique intensities",tips:['Design completely custom groups like "Couples Yoga" or "Adventure Challenges"',"Set your own intensity progression from gentle to wild","Create themed collections that tell a story or follow a theme","Build niche categories that perfectly match your interests"],color:"warning"},{id:"share-creations",icon:e.jsx(ds,{}),title:"Share & Discover",description:"Import/export tiles to share with others",tips:["Export your best tile collections to share with friends or partners","Import creative tiles from others to expand your game options","Create themed tile packs and share them in communities","Backup your custom tiles by exporting them regularly"],color:"info"}];return e.jsxs(e.Fragment,{children:[e.jsxs(pe,{expanded:n==="help1",onChange:r("help1"),className:"about-accordion",children:[e.jsx(me,{"aria-controls":"help1-content",id:"help1-header",children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(Xe,{color:"primary"}),e.jsx(C,{className:"accordion-title",children:e.jsx(L,{i18nKey:"ctExplained"})})]})}),e.jsx(fe,{sx:{p:0},children:e.jsx(we,{dense:!0,children:a.map((l,o)=>e.jsxs(S,{children:[e.jsxs(Ee,{sx:{cursor:"pointer",borderRadius:1,"&:hover":{bgcolor:"action.hover",transform:"translateX(4px)",transition:"all 0.2s ease-in-out"},transition:"all 0.2s ease-in-out"},onClick:()=>t(l.id),children:[e.jsx(ze,{sx:{minWidth:s?36:40},children:e.jsx(S,{sx:{color:`${l.color}.main`,display:"flex",alignItems:"center"},children:l.icon})}),e.jsx(Pe,{primary:e.jsx(C,{variant:"subtitle2",sx:{fontWeight:500,fontSize:s?"0.9rem":"1rem"},children:l.title}),secondary:e.jsx(C,{variant:"body2",sx:{fontSize:s?"0.8rem":"0.85rem",color:"text.secondary"},children:l.description})}),e.jsx(le,{size:"small",sx:{ml:1},children:p[l.id]?e.jsx(He,{}):e.jsx(Je,{})})]}),e.jsx(Be,{in:p[l.id],timeout:"auto",unmountOnExit:!0,children:e.jsx(S,{sx:{ml:s?4:6,mr:2,mb:1,p:1.5,bgcolor:"action.selected",borderRadius:1,borderLeft:3,borderLeftColor:`${l.color}.main`},children:e.jsxs(C,{variant:"body2",sx:{fontSize:s?"0.8rem":"0.85rem",fontStyle:"italic",color:"text.secondary"},children:["ðŸ’¡ ",l.tip]})})}),o<a.length-1&&e.jsx(ve,{variant:"inset",sx:{ml:s?4:6}})]},l.id))})})]}),e.jsxs(pe,{expanded:n==="help2",onChange:r("help2"),className:"about-accordion",children:[e.jsx(me,{"aria-controls":"help2-content",id:"help2-header",children:e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(is,{color:"primary"}),e.jsx(C,{className:"accordion-title",children:e.jsx(L,{i18nKey:"ctIdeas"})})]})}),e.jsx(fe,{sx:{p:0},children:e.jsx(we,{dense:!0,children:y.map((l,o)=>e.jsxs(S,{children:[e.jsxs(Ee,{sx:{cursor:"pointer",borderRadius:1,"&:hover":{bgcolor:"action.hover",transform:"translateX(4px)",transition:"all 0.2s ease-in-out"},transition:"all 0.2s ease-in-out"},onClick:()=>i(l.id),children:[e.jsx(ze,{sx:{minWidth:s?36:40},children:e.jsx(S,{sx:{color:`${l.color}.main`,display:"flex",alignItems:"center"},children:l.icon})}),e.jsx(Pe,{primary:e.jsx(C,{variant:"subtitle2",sx:{fontWeight:500,fontSize:s?"0.9rem":"1rem"},children:l.title}),secondary:e.jsx(C,{variant:"body2",sx:{fontSize:s?"0.8rem":"0.85rem",color:"text.secondary"},children:l.description})}),e.jsx(le,{size:"small",sx:{ml:1},children:u[l.id]?e.jsx(He,{}):e.jsx(Je,{})})]}),e.jsx(Be,{in:u[l.id],timeout:"auto",unmountOnExit:!0,children:e.jsx(S,{sx:{ml:s?4:6,mr:2,mb:1,p:1.5,bgcolor:"action.selected",borderRadius:1,borderLeft:3,borderLeftColor:`${l.color}.main`},children:l.tips.map((h,_)=>e.jsx(C,{variant:"body2",sx:{fontSize:s?"0.8rem":"0.85rem",fontStyle:_===0?"italic":"normal",color:"text.secondary",mb:_<l.tips.length-1?1:0,"&:before":_===0?{content:'"ðŸ’¡ "'}:{content:'"â€¢ "'}},children:h},_))})}),o<y.length-1&&e.jsx(ve,{variant:"inset",sx:{ml:s?4:6}})]},l.id))})})]})]})}var Bs=Object.defineProperty,lt=Object.getOwnPropertySymbols,Us=Object.prototype.hasOwnProperty,qs=Object.prototype.propertyIsEnumerable,at=(n,r,s)=>r in n?Bs(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,Xs=(n,r)=>{for(var s in r||(r={}))Us.call(r,s)&&at(n,s,r[s]);if(lt)for(var s of lt(r))qs.call(r,s)&&at(n,s,r[s]);return n};function Hs({gameMode:n,groupFilter:r,intensityFilter:s,groups:u,mappedGroups:c,dexieGroups:p,onGameModeChange:d,onGroupChange:i,onIntensityChange:t,hideAll:a=!1,sx:y={}}){const{t:l}=ae(),[o,h]=m.useState([]),_=a?1:"all",T=m.useMemo(()=>{if(!(c!=null&&c[n]))return[];const g=It(c[n]);return Array.isArray(g)?g:[]},[c,n]),F=m.useCallback(g=>{if(p!=null&&p[g])return p[g].label||g;const N=T.find(K=>K.value===g);return N!=null&&N.groupLabel?N.groupLabel:g},[p,T]),E=m.useCallback((g,N)=>{if(p!=null&&p[g]){const A=p[g].intensities.find(w=>w.value===Number(N));if(A!=null&&A.label)return A.label}const K=T.find(A=>A.value===g&&A.intensity===Number(N));return K!=null&&K.translatedIntensity?K.translatedIntensity:`Level ${Number(N)+1}`},[p,T]);m.useEffect(()=>{if(u){const g=Object.keys(u);h(g)}},[u,n]);function D(g){const N=g.target.value;i(N),t(_)}if(!(o!=null&&o.length))return null;const O=o.length===0||o.includes(r)?r:"",$=s==="all"?"all":s;return e.jsxs(S,{sx:Xs({display:"flex",flexWrap:"wrap",gap:2},y),children:[e.jsxs(X,{sx:{width:125,flexShrink:0},children:[e.jsx(H,{id:"game-mode-filter-label",children:e.jsx(L,{i18nKey:"customTiles.gameMode"})}),e.jsxs(J,{labelId:"game-mode-filter-label",id:"game-mode-filter",value:n,label:l("customTiles.gameMode","Game Mode"),onChange:g=>{d(g.target.value)},slotProps:{input:{"aria-label":l("customTiles.gameMode","Game Mode")}},children:[e.jsx(k,{value:"online",children:e.jsx(L,{i18nKey:"online"})}),e.jsx(k,{value:"local",children:e.jsx(L,{i18nKey:"local"})})]})]}),e.jsxs(X,{sx:{minWidth:150,flex:1},children:[e.jsx(H,{id:"group-filter-label",children:e.jsx(L,{i18nKey:"group"})}),e.jsx(J,{labelId:"group-filter-label",id:"group-filter",value:O,label:l("group"),onChange:D,slotProps:{input:{"aria-label":l("group")}},children:o.map(g=>e.jsxs(k,{value:g,children:[F(g),!a&&u[g]&&` (${u[g].count})`]},g))})]}),e.jsxs(X,{sx:{minWidth:200,flex:1},disabled:!O,children:[e.jsx(H,{id:"intensity-filter-label",children:e.jsx(L,{i18nKey:"customTiles.intensityLevel",children:"Intensity Level"})}),e.jsxs(J,{labelId:"intensity-filter-label",id:"intensity-filter",value:$,label:l("customTiles.intensityLevel","Intensity Level"),onChange:g=>t(g.target.value),slotProps:{input:{"aria-label":l("customTiles.intensityLevel","Intensity Level")}},children:[!a&&e.jsx(k,{value:"all",children:e.jsx(L,{i18nKey:"all",children:"All"})},"all"),O&&u&&u[O]&&Object.entries(u[O].intensities||{}).sort(([g],[N])=>Number(g)-Number(N)).map(([g,N])=>e.jsxs(k,{value:Number(g),children:[E(O,g),!a&&N!==void 0?` (${N})`:""]},g))]})]})]})}var Js=Object.defineProperty,Ys=Object.defineProperties,Qs=Object.getOwnPropertyDescriptors,ct=Object.getOwnPropertySymbols,Zs=Object.prototype.hasOwnProperty,er=Object.prototype.propertyIsEnumerable,ut=(n,r,s)=>r in n?Js(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,dt=(n,r)=>{for(var s in r||(r={}))Zs.call(r,s)&&ut(n,s,r[s]);if(ct)for(var s of ct(r))er.call(r,s)&&ut(n,s,r[s]);return n},pt=(n,r)=>Ys(n,Qs(r)),xe=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});function tr({tagList:n,boardUpdated:r,mappedGroups:s,updateTile:u,refreshTrigger:c}){var p;const{t:d,i18n:i}=ae(),{settings:t}=Fe(),[a,y]=m.useState(null),[l,o]=m.useState(t.gameMode||"online"),[h,_]=m.useState(""),[T,F]=m.useState(""),[E,D]=m.useState(1),[O,$]=m.useState(!0),[g,N]=m.useState({items:[],total:0,totalPages:1}),[K,A]=m.useState({}),[w,f]=m.useState({}),x=10;m.useEffect(()=>{function b(){return xe(this,null,function*(){try{$(!0);const[P,W]=yield Promise.all([Re(i.resolvedLanguage,l),Bt(i.resolvedLanguage,l,a)]),ee={};P.forEach(U=>{ee[U.name]=U}),f(ee);const te={};P.forEach(U=>{const ce=W[U.name]||{count:0,intensities:{}};te[U.name]={label:U.label||U.name,count:ce.count,intensities:ce.intensities}}),A(te);const se=P.map(U=>U.name),ie=se.includes(h);if((!h||!ie)&&se.length>0)_(se[0]),F("all");else if(ie&&T!=="all"){const U=P.find(ce=>ce.name===h);U&&(U.intensities.map(be=>be.value).includes(Number(T))||F("all"))}}catch(P){console.error("Error loading groups and counts:",P)}finally{$(!1)}})}b()},[l,i.resolvedLanguage,a,h,T]),m.useEffect(()=>{let b=!0;function P(){return xe(this,null,function*(){try{$(!0);const W={group:h,intensity:T==="all"?null:Number(T),tag:a,gameMode:l,locale:t.locale,page:E,limit:x,paginated:!0},ee=yield Ue(W);b&&(N(ee),setTimeout(()=>{b&&$(!1)},300))}catch(W){console.error("Error loading tiles:",W),b&&$(!1)}})}return h?P():$(!1),()=>{b=!1}},[h,T,a,l,E,x,c,t.locale]);function j(b){$(!0),y(a===b?null:b)}function G(b,P){$(!0),D(P)}function B(b){return xe(this,null,function*(){yield Ut(b),r();const P={group:h,intensity:T==="all"?null:T,tag:a,gameMode:l,locale:t.locale,page:E,limit:x,paginated:!0},W=yield Ue(P);N(W)})}function R(b){return xe(this,null,function*(){yield qt(b),r(),N(P=>pt(dt({},P),{items:P.items.map(W=>W.id===b?pt(dt({},W),{isEnabled:!W.isEnabled}):W)}))})}function z(b){u(b);const P=document.querySelector(".MuiDialogContent-root");P&&(P.scrollTop=0)}function Y(b,P){const W=w[b];if(W){const ee=W.label||b,te=W.intensities.find(ie=>ie.value===Number(P)),se=(te==null?void 0:te.label)||`Level ${Number(P)+1}`;return`${ee} - ${se}`}return`${b} - Level ${Number(P)+1}`}const V=(p=g.items)==null?void 0:p.map(({id:b,group:P,intensity:W,action:ee,tags:te,isEnabled:se=!0,isCustom:ie=!0})=>e.jsxs($t,{sx:{my:2},children:[e.jsx(Nt,{title:ee,slotProps:{title:{variant:"body1"},subheader:{variant:"body2"},action:{"aria-label":d("customTiles.actions")}},subheader:Y(P,W),action:e.jsxs(e.Fragment,{children:[e.jsx(kt,{checked:!!se,onChange:()=>b!==void 0&&R(b),slotProps:{input:{"aria-label":d("customTiles.toggleTile")}}}),!!ie&&e.jsxs(e.Fragment,{children:[e.jsx(le,{onClick:()=>b!==void 0&&z(b),"aria-label":d("customTiles.update"),children:e.jsx(Ct,{})}),e.jsx(le,{onClick:()=>b!==void 0&&B(b),"aria-label":d("customTiles.delete"),children:e.jsx(Le,{})})]})]}),sx:{pb:0}}),e.jsx(Mt,{children:te==null?void 0:te.map(U=>e.jsx(Ce,{label:U==="default"?d("default"):U,sx:{m:.5}},U))})]},b));return e.jsxs(S,{children:[e.jsx(S,{children:n==null?void 0:n.map(b=>e.jsx(Ce,{label:b,sx:{m:.5},color:a===b?"primary":"default",onClick:()=>j(b)},b))}),e.jsx(S,{sx:{display:"flex",flexDirection:"column",gap:2,my:2,transition:"all 0.3s ease-in-out"},children:e.jsx(Hs,{gameMode:l,groupFilter:h,intensityFilter:T,groups:K,mappedGroups:s,dexieGroups:w,onGameModeChange:b=>{o(b),_(""),F(""),D(1)},onGroupChange:b=>{_(b),D(1)},onIntensityChange:b=>{F(b),D(1)}})}),e.jsxs(S,{sx:{position:"relative",minHeight:"200px"},children:[e.jsx(Ft,{in:O,timeout:300,children:e.jsx(S,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0)",zIndex:1,borderRadius:1},children:e.jsx(ke,{})})}),e.jsx(S,{sx:{opacity:O?.3:1,transition:"opacity 0.3s ease-in-out",pointerEvents:O?"none":"auto"},children:g.items.length===0?e.jsx(C,{variant:"body1",sx:{textAlign:"center",my:4},children:e.jsx(L,{i18nKey:"customTiles.noTilesFound",children:"No tiles found with the selected filters."})}):e.jsxs(e.Fragment,{children:[V,g.totalPages>1&&e.jsx(S,{sx:{display:"flex",justifyContent:"center",mt:3,mb:2},children:e.jsx(Rt,{count:g.totalPages,page:E,onChange:G,color:"primary"})}),e.jsx(C,{variant:"body2",sx:{textAlign:"center",mt:2,color:"text.secondary"},children:e.jsxs(L,{i18nKey:"customTiles.showingTiles",values:{shown:g.items.length,total:g.total},children:["Showing ",{shown:g.items.length}," of ",{total:g.total}," tiles"]})})]})})]})]})}var mt=(n,r,s)=>new Promise((u,c)=>{var p=t=>{try{i(s.next(t))}catch(a){c(a)}},d=t=>{try{i(s.throw(t))}catch(a){c(a)}},i=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,d);i((s=s.apply(n,r)).next())});function yr({boardUpdated:n,setOpen:r,open:s=!1}){const{t:u,i18n:c}=ae(),p=De(),d=De("md"),[i,t]=m.useState({message:"",type:"info"}),[a,y]=m.useState("ctAdd"),[l,o]=m.useState(null),[h,_]=m.useState(0),[T,F]=m.useState({online:{},local:{},solo:{}}),[E,D]=m.useState(!0),O=m.useCallback(()=>{_(w=>w+1)},[]),$=w=>(f,x)=>{y(x?w:"")};m.useEffect(()=>{function w(){return mt(this,null,function*(){D(!0);try{const[f,x,j]=yield Promise.all([Te(c.resolvedLanguage,"online"),Te(c.resolvedLanguage,"local"),Te(c.resolvedLanguage,"solo")]);F({online:f,local:x,solo:j})}catch(f){console.error("Error loading game mode actions:",f)}finally{D(!1)}})}w()},[c.resolvedLanguage]);const g=Vt(()=>he({locale:c.resolvedLanguage})),N=m.useMemo(()=>g?Array.isArray(g)?g.map(({tags:w})=>w).flat().filter((w,f,x)=>w&&x.indexOf(w)===f).sort():[]:[],[g]),K=m.useCallback(w=>mt(null,null,function*(){yield Xt(w),n(),O()}),[n,O]);if(!g||E)return null;const A=()=>{const w=e.jsxs(e.Fragment,{children:[e.jsx(zs,{expanded:a,handleChange:$}),e.jsx(Ms,{setSubmitMessage:t,boardUpdated:()=>{n(),O()},customTiles:g,mappedGroups:T,expanded:a,handleChange:$,tagList:N,updateTileId:l,setUpdateTileId:o}),e.jsx(bs,{expanded:a,handleChange:$,customTiles:g,mappedGroups:T,setSubmitMessage:t,bulkImport:K})]}),f=Array.isArray(g)&&g.length>0&&e.jsx(S,{children:e.jsx(tr,{tagList:N,boardUpdated:()=>{n(),O()},mappedGroups:T,updateTile:x=>{o(x),y("ctAdd")},refreshTrigger:h})});return d?e.jsxs(e.Fragment,{children:[w,f&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{sx:{my:2}}),f]})]}):e.jsxs(je,{container:!0,spacing:2,children:[e.jsx(je,{size:{xs:12,md:6},children:w}),e.jsx(je,{size:{xs:12,md:6},children:f})]})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ie,{fullScreen:p,open:s,onClose:()=>r(!1),maxWidth:d?"sm":"lg",fullWidth:!0,children:[e.jsxs(Se,{children:[e.jsx(L,{i18nKey:"manageTiles"}),e.jsx(le,{"aria-label":u("close"),onClick:()=>r(!1),sx:{position:"absolute",right:8,top:8,color:w=>w.palette.grey[500]},children:e.jsx(ps,{})})]}),e.jsx(Ge,{children:A()})]}),e.jsx(Ht,{open:!!i.message,close:()=>t({message:"",type:"info"}),type:i.type,children:i.message})]})}var sr=Object.defineProperty,rr=Object.defineProperties,nr=Object.getOwnPropertyDescriptors,ft=Object.getOwnPropertySymbols,ir=Object.prototype.hasOwnProperty,or=Object.prototype.propertyIsEnumerable,ht=(n,r,s)=>r in n?sr(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,re=(n,r)=>{for(var s in r||(r={}))ir.call(r,s)&&ht(n,s,r[s]);if(ft)for(var s of ft(r))or.call(r,s)&&ht(n,s,r[s]);return n},gt=(n,r)=>rr(n,nr(r));function vr(n={},r={}){const[s]=Qt(),u=re(gt(re(re({},n),s),{selectedActions:(s==null?void 0:s.selectedActions)||{},finishRange:(s==null?void 0:s.finishRange)||[30,70]}),r),[c,p]=m.useState(u),{messages:d}=ts(),[i,t]=m.useState(!1);return m.useEffect(()=>{const a=ms(d,"room");if(a!=null&&a.settings)try{const y=JSON.parse(a.settings);p(l=>i?l.selectedActions&&Object.keys(l.selectedActions).length>0?gt(re(re({},l),y),{selectedActions:l.selectedActions}):re(re({},l),y):(t(!0),re(re({},l),y)))}catch(y){console.error("Error parsing message settings:",y)}else i||t(!0)},[d,i]),[c,p]}export{yr as C,It as g,vr as u};
//# sourceMappingURL=chunk-C9iFBQh5.js.map
