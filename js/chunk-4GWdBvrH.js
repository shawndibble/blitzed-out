import{r as a,j as e,q as D,u as B,t as f}from"./chunk-DDoLnHI0.js";import{C as y}from"./chunk-bqvoNmJe.js";import{h as v,a8 as w,a9 as I,B as G,T as g,G as T,k as P,aa as A,l as K,D as E,x as k,z as S,y as L}from"./chunk-D59Sa5ya.js";import{u as M}from"./chunk-BICGdz9x.js";import{u as $,G as O}from"./chunk-8ZYOspRI.js";import{u as R}from"./chunk-BmcVylZL.js";import{s as U}from"../assets/index-BodytYbc.js";import{u as z}from"./chunk-CXIw3Iqt.js";function F(i,t=!0){const[s,r]=a.useState(i),[o,n]=a.useState(t),d=a.useCallback(()=>n(l=>!l),[]);return a.useEffect(()=>{if(s===-1&&r(0),s<=0||o)return;const l=setInterval(()=>{r(c=>c-1)},1e3);return()=>clearInterval(l)},[s,o]),{timeLeft:s,setTimeLeft:r,togglePause:d,isPaused:o}}const q=()=>({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:180,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:2,textAlign:"right"});function _({textString:i,preventParentClose:t,noPadding:s=!1}){const[r,o]=a.useState(!1),[n,d]=i.split(" "),{timeLeft:l,setTimeLeft:c,togglePause:x,isPaused:h}=F(parseInt(n),!0);a.useEffect(()=>x(),[x]);const j=()=>{t(),o(!0),c(parseInt(n)),h&&x()},u=a.useRef(void 0);a.useEffect(()=>(r&&(u.current=setTimeout(()=>o(!1),parseInt(n)*1e3)),()=>{u.current&&clearTimeout(u.current)}),[r,n]);const m=()=>{u.current&&clearTimeout(u.current),o(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(v,{onClick:j,sx:{p:s?0:1},color:"secondary",children:i}),e.jsx(w,{open:r,onClose:m,slots:{backdrop:I},slotProps:{backdrop:{timeout:500}},children:e.jsxs(G,{sx:q,children:[e.jsx(y,{close:m}),e.jsx(g,{variant:"h2",sx:{display:"inline-block"},children:l}),e.jsx(g,{sx:{ml:2,display:"inline-block"},children:d})]})})]})}function p({children:i,title:t,onClick:s,disabled:r}){return e.jsx(T,{size:{xs:12,sm:6},container:!0,children:e.jsx(P,{sx:{width:"100%"},children:e.jsx(A,{sx:{height:"100%",display:"inline-flex",alignItems:"flex-start",justifyContent:"flex-start"},onClick:s,disabled:r,children:e.jsxs(K,{sx:{width:"100%",color:r?"gray":"white"},children:[e.jsx(g,{variant:"h5",children:t}),e.jsx(E,{sx:{mb:2}}),i]})})})})}function W(){const{t:i}=D(),{id:t}=B(),{user:s}=z();return a.useCallback(async()=>{const o=`${i("restartingGame")}
#1: ${i("start")}
${i("action")}: ${i("start")}`;await U({room:t,user:s,text:o,type:"actions"})},[t,s,i])}function ee({isOpen:i=!1,close:t}){const{t:s}=D(),[r,o]=a.useState(!1),n=W(),d=M(),l=$(),[c,x]=R(),h=a.useCallback(()=>{n(),t()},[n,t]),j=a.useCallback(async()=>{await l({...c,boardUpdated:!0}),n(),t()},[l,c,n,t]),u=a.useCallback(async()=>{const b={...c,boardUpdated:!0,difficulty:"accelerated"};await l(b),x(b),n(),t()},[l,c,x,n,t]),m=a.useCallback(()=>{o(!0),t()},[t]),C=a.useCallback(()=>{o(!1),n()},[n]);return e.jsxs(e.Fragment,{children:[e.jsx(k,{open:i,onClose:t,fullScreen:d,"aria-labelledby":"modal-game-over",children:e.jsxs(S,{children:[e.jsx(g,{variant:"h4",textAlign:"center",sx:{mb:2,px:2},children:e.jsx(f,{i18nKey:"gameOverPlayAgain"})}),e.jsx(y,{close:t}),e.jsxs(T,{container:!0,spacing:2,alignItems:"stretch",children:[e.jsx(p,{title:s("sameBoard"),onClick:h,children:e.jsx(f,{i18nKey:"sameBoardDescription"})}),e.jsx(p,{title:s("rebuildBoard"),onClick:j,children:e.jsx(f,{i18nKey:"rebuildBoardDescription"})}),e.jsx(p,{title:s("finalDifficulty"),onClick:u,disabled:c.difficulty==="accelerated",children:e.jsx(f,{i18nKey:"finalDifficultyDescription"})}),e.jsx(p,{title:s("changeSettings"),onClick:m,children:e.jsx(f,{i18nKey:"changeSettingsDescription"})})]})]})}),!!r&&e.jsxs(k,{fullScreen:d,open:r,maxWidth:"md",children:[e.jsxs(L,{children:[e.jsx(f,{i18nKey:"gameSettings"}),e.jsx(y,{close:C})]}),e.jsx(S,{children:e.jsx(O,{closeDialog:C})})]})]})}export{_ as C,ee as G,F as u};
