import{u as Z,b as j,j as e,S as z,aL as k,I as Q,a8 as F,aA as L,aw as E,aa as R,ar as O,a3 as $,t as C,az as u,aF as ee,a4 as te}from"./chunk-CVSdvP5Z.js";import{C as G,A as ne,a as se,b as ie}from"./chunk-BeueL4UK.js";import{C as M}from"./chunk-BmM2eEZX.js";import{l as J,m as re,n as le,o as oe,u as ae}from"./chunk-E8HqAuJ1.js";import{a9 as ce,K as de,aa as ue,o as pe}from"./chunk-_SwOSjSw.js";import{T as fe}from"./chunk-84IffDWI.js";import{u as me}from"./chunk-CNqt7FHs.js";import{x as ge,F as he,y as xe}from"./chunk-B-cyqPC2.js";import{u as ve}from"./chunk-guvQFVv-.js";import"../assets/index-CZH-e7F_.js";import"./chunk-BVO8KFPS.js";import"./chunk-BUoOus3c.js";import"./chunk-AkXvan0D.js";(function(){var s=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};s.SENTRY_RELEASE={id:"874067a760cfa9079dd7f585e4ceff298b0e879f"}})();try{(function(){var s=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},i=new s.Error().stack;i&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[i]="036b591e-ce80-4bb6-af7c-2e58d97a61c3",s._sentryDebugIdIdentifier="sentry-dbid-036b591e-ce80-4bb6-af7c-2e58d97a61c3")})()}catch(s){}var ye=Object.defineProperty,je=Object.defineProperties,Be=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,V=(s,i,n)=>i in s?ye(s,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[i]=n,W=(s,i)=>{for(var n in i||(i={}))_e.call(i,n)&&V(s,n,i[n]);if(K)for(var n of K(i))Te.call(i,n)&&V(s,n,i[n]);return s},q=(s,i)=>je(s,Be(i)),Y=(s,i,n)=>new Promise((o,l)=>{var d=r=>{try{a(n.next(r))}catch(p){l(p)}},h=r=>{try{a(n.throw(r))}catch(p){l(p)}},a=r=>r.done?o(r.value):Promise.resolve(r.value).then(d,h);a((n=n.apply(s,i)).next())});function we({open:s,close:i,setAlert:n,board:o}){const{t:l}=Z(),[d,h]=j.useState(""),[a,r]=j.useState(o.title||"");function p(c){try{return a.length?c.map((m,g)=>{const[v,...B]=m.split(`
`).filter(S=>S);if(v===void 0)throw n({message:l("importNoEmpty")});if(!/^\[.+\]$/.test(v))throw n({message:l("importInvalidTitle",{entry:g+1})});if(!B.length)throw n({message:l("importMissingDescription",{entry:g+1})});return{title:v==null?void 0:v.replace(/\[|\]/g,""),description:B.join(`
`)}}):(n({message:l("importTitleRequired")}),null)}catch(m){return null}}const w=()=>Y(null,null,function*(){const c=d.split(/~+/).filter(g=>g),m=p(c);if(!m)return null;try{if(JSON.stringify(o.tiles)===JSON.stringify(m))return n({message:l("importNoChange")}),null}catch(g){return n({message:l("error"),type:"error"}),null}return J(q(W({},o),{title:a,tiles:m})),n({message:l("saved"),type:"success"}),i(),null}),f=()=>{var c;const m=(c=o==null?void 0:o.tiles)==null?void 0:c.map(g=>{if(!g)return"";const v=g.title||"",B=g.description||"";return`[${v}]
${B}`}).filter(Boolean);h((m==null?void 0:m.join(`
~~
`))||"")},b=c=>{r(c.target.value)},P=c=>Y(null,null,function*(){if(!c.target.value.length)return n({message:l("importTitleRequired")}),null;J(q(W({},o),{title:c.target.value}))});return j.useEffect(()=>{s&&f()},[s]),j.useEffect(()=>{r(o.title||"")},[o.title]),e.jsxs(e.Fragment,{children:[e.jsx(z,{fullWidth:!0,label:l("title"),value:a,onChange:b,onBlur:P}),e.jsx(z,{sx:{mt:2},multiline:!0,fullWidth:!0,value:d,onChange:c=>h(c.target.value),InputProps:{endAdornment:e.jsxs("div",{style:{display:"flex",flexDirection:"column",position:"sticky",top:0},children:[e.jsx(k,{title:l("save"),children:e.jsx(Q,{size:"small",onClick:w,"aria-label":l("save"),children:e.jsx(ce,{color:"success"})})}),e.jsx(M,{text:d}),e.jsx(M,{text:`${window.location.href}?importBoard=${o.id}`,copiedText:l("copiedLink"),icon:e.jsx(de,{}),tooltip:l("copyShareLink")})]}),sx:{alignItems:"flex-start"}}})]})}var H=(s,i,n)=>new Promise((o,l)=>{var d=r=>{try{a(n.next(r))}catch(p){l(p)}},h=r=>{try{a(n.throw(r))}catch(p){l(p)}},a=r=>r.done?o(r.value):Promise.resolve(r.value).then(d,h);a((n=n.apply(s,i)).next())});function Fe({open:s,close:i,isMobile:n}){var o;const l=me(oe),[d,h]=j.useState(null),[a,r]=j.useState(0),[p,w]=j.useState(0),f=ge()[0],{user:b}=ve();if(!l)return null;const P=t=>{if(!t||!t.length)return null;const x=t[t.length-1];return x!=null&&x.description?x.description.match(/\d+%/g):null},c=t=>{h(t)};function m(t){return H(this,arguments,function*({title:x,tiles:y}){const D=y.map(({title:X})=>`* ${X} 
`);D.pop(),D.shift();let _=`### ${u("activated")}: ${x}
`;_+=`---
`,_+=[...new Set(D)].join(" "),_+=`---
`;const T=P(y);T&&T.length===3&&(_+=`* ${u("finishSlider")} ${T[0]}  | ${T[1]} | ${T[2]}`);const I=yield he({title:x,gameBoard:JSON.stringify(y),settings:JSON.stringify(f)});I!=null&&I.id&&(yield xe({room:(f==null?void 0:f.room)||"PUBLIC",user:b,text:_,type:"settings",gameBoardId:I.id,boardSize:y.length,gameMode:f==null?void 0:f.gameMode}))})}const g=()=>H(null,null,function*(){const t=(yield ae({isActive:0}))||0;w(t)}),v=t=>{re(t.id),m(t),h({message:u("boardEnabled"),type:"success"})},B=t=>{t!==0&&r(t)},A=()=>{typeof a=="number"&&le(a),r(0)},S=t=>(x,y)=>{w(y?t:0)},N=t=>!t.tiles||t.tiles.length!==((f==null?void 0:f.roomTileCount)||40),U=t=>N(t)?u("boardWrongSize",{size:(f==null?void 0:f.roomTileCount)||40}):t.isActive?u("boardActive"):u("enableBoard");return e.jsxs(e.Fragment,{children:[e.jsxs(F,{fullScreen:n,open:s,onClose:i,PaperProps:{sx:{maxHeight:"100%",height:"100%"}},children:[e.jsxs(L,{children:[e.jsx(E,{i18nKey:"manageGameBoards"}),e.jsx(G,{close:i})]}),e.jsxs(R,{style:{overflowY:"scroll"},children:[e.jsxs(O,{sx:{mb:1},children:[e.jsx($,{variant:"outlined",onClick:g,endIcon:e.jsx(ue,{}),sx:{float:"right"},children:e.jsx(E,{i18nKey:"add"})}),e.jsx(C,{children:e.jsx(E,{i18nKey:"gameBoardDescription"})})]}),l.map(t=>{var x;return e.jsxs(ne,{expanded:p===t.id,onChange:S(t.id||0),children:[e.jsxs(se,{children:[e.jsxs(O,{children:[e.jsx(C,{variant:"body1",children:t.title}),e.jsx(C,{variant:"body2",children:u("tilesCount",{count:((x=t.tiles)==null?void 0:x.length)||0})})]}),e.jsxs(O,{style:{marginLeft:"auto"},justifyContent:"flex-end",children:[e.jsx(k,{title:U(t),children:e.jsx("div",{style:{display:"inline-block"},children:e.jsx(ee,{checked:!!t.isActive,disabled:!!t.isActive||N(t),onChange:()=>v(t),size:"small"})})}),e.jsx(k,{title:u("delete"),children:e.jsx("span",{style:{display:"inline-block"},children:e.jsx(Q,{onClick:()=>B(t.id||0),size:"small",component:"span",children:e.jsx(pe,{color:"error"})})})})]})]}),e.jsx(ie,{children:e.jsx(we,{open:s,close:()=>S(t.id||0)(null,!1),setAlert:c,board:t})})]},t.id)})]})]}),e.jsx(fe,{open:!!(d!=null&&d.message),type:(d==null?void 0:d.type)||"error",close:()=>h(null),children:d==null?void 0:d.message}),e.jsxs(F,{open:!!a,onClose:()=>r(0),children:[e.jsxs(L,{children:[u("deleteBoard"),e.jsx(G,{close:()=>r(0)})]}),e.jsx(R,{children:e.jsx(C,{variant:"body1",children:u("confirmDeleteBoard",{title:(o=l.find(t=>t.id===a))==null?void 0:o.title})})}),e.jsxs(te,{children:[e.jsx($,{onClick:()=>r(0),children:u("cancel")}),e.jsx($,{onClick:A,children:u("delete")})]})]})]})}export{Fe as default};
//# sourceMappingURL=index.tsx-DujN9Q9C.js.map
