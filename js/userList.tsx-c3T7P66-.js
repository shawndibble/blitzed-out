import{a7 as U,ad as w,r as t,j as E}from"./chunk-DzAIPjqH.js";import{a as R}from"./chunk-BmjRqaQ3.js";import{u as S}from"./chunk-BjQhdd70.js";import"./chunk-BfMAFFX0.js";import"../assets/index-BHv73vX6.js";import"./chunk-D4nXmTaT.js";(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};n.SENTRY_RELEASE={id:"b0aec1b7336667c3da787da9b7139ec106644213"}})();try{(function(){var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new n.Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="2557888e-cab7-407b-aa6a-5b974e29259f",n._sentryDebugIdIdentifier="sentry-dbid-2557888e-cab7-407b-aa6a-5b974e29259f")})()}catch{}function v(n){if(!n||typeof n!="object")return!1;const e=n;return typeof e.displayName=="string"&&typeof e.uid=="string"&&(e.lastSeen instanceof Date||typeof e.lastSeen=="number"||typeof e.lastSeen=="string")}const h=U.createContext(void 0);function P(n){const{id:e}=w(),{onlineUsers:i,setUsers:l,setRoom:f,clearUsers:o,flushPendingUpdates:u}=S(),a=t.useRef(null),d=t.useRef(e),c=t.useCallback(b=>{if(b===null)o();else{const p={};Object.entries(b).forEach(([y,r])=>{if(v(r)){const m={...r,lastSeen:r.lastSeen instanceof Date?r.lastSeen:new Date(r.lastSeen)};p[y]=m}else console.warn(`Invalid user data for uid ${y}:`,r)}),l(p)}},[l,o]),s=t.useCallback(()=>{a.current&&(a.current(),a.current=null),u()},[u]);t.useEffect(()=>{if(d.current!==e&&(f(e||null),d.current=e),!e){s(),o();return}return s(),R(e,c),a.current=null,s},[e,f,o,c,s]),t.useEffect(()=>s,[s]);const g=t.useMemo(()=>({onlineUsers:i}),[i]);return E.jsx(h.Provider,{value:g,...n})}export{h as UserListContext,P as UserListProvider};
//# sourceMappingURL=userList.tsx-c3T7P66-.js.map
