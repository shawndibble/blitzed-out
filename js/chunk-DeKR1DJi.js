import{ak as A,r,j as e,am as v,aR as S,A as b,Q as y,at as C,ar as c,T as k,a1 as L,au as W,W as P,av as F,Y as K,R as I}from"./chunk-u7ZaklyY.js";import{n as R,o as G,q,A as N}from"./chunk-CaZ9lMwi.js";import{G as B}from"./chunk-DjaG2sW1.js";import{u as _,C as z}from"./chunk-CND3TB5P.js";(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"b0aec1b7336667c3da787da9b7139ec106644213"}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="3ff60bec-7d09-455c-979b-eb014087af28",t._sentryDebugIdIdentifier="sentry-dbid-3ff60bec-7d09-455c-979b-eb014087af28")})()}catch{}function V({onSuccess:t,onSwitchToRegister:a,onSwitchToForgotPassword:l,isLinking:s=!1}){const{t:n}=A(),[o,i]=r.useState(""),[u,d]=r.useState(""),[h,m]=r.useState(""),[g,f]=r.useState(!1),j=async p=>{p.preventDefault(),m(""),f(!0);try{await R(o,u),t&&t()}catch(w){console.error("Login error:",w),m(w.message||"Failed to sign in")}finally{f(!1)}};return e.jsxs(v,{component:"form",onSubmit:j,sx:{mt:1},children:[h&&e.jsx(S,{severity:"error",sx:{mb:2},children:h}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:n("email"),name:"email",autoComplete:"email",autoFocus:!0,value:o,onChange:p=>i(p.target.value)}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:n("password"),type:"password",id:"password",autoComplete:"current-password",value:u,onChange:p=>d(p.target.value)}),e.jsx(y,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:g,children:g?e.jsx(C,{size:24}):s?e.jsx(c,{i18nKey:"linkAccount",children:"Link Account"}):e.jsx(c,{i18nKey:"signIn"})}),e.jsxs(k,{align:"center",children:[e.jsx(y,{onClick:a,variant:"text",children:e.jsx(c,{i18nKey:"needAccount"})})," | ",e.jsx(y,{onClick:l,variant:"text",children:e.jsx(c,{i18nKey:"forgotPassword"})})]})]})}function Y({onSuccess:t,onSwitchToLogin:a,isAnonymous:l=!1}){const{t:s}=A(),[n,o]=r.useState(""),[i,u]=r.useState(""),[d,h]=r.useState(""),[m,g]=r.useState(""),[f,j]=r.useState(""),[p,w]=r.useState(!1),T=async x=>{if(x.preventDefault(),j(""),d!==m){j(s("passwordsDoNotMatch")||"Passwords do not match");return}w(!0);try{await G(i?.trim(),d,n?.trim()),t&&t()}catch(E){console.error("Registration error:",E),j(E.message||"Failed to create account")}finally{w(!1)}};return e.jsxs(v,{component:"form",onSubmit:T,sx:{mt:1},children:[f&&e.jsx(S,{severity:"error",sx:{mb:2},children:f}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,id:"displayName",label:s("displayName"),name:"displayName",autoComplete:"name",autoFocus:!0,value:n,onChange:x=>o(x.target.value)}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:s("email"),name:"email",autoComplete:"email",value:i,onChange:x=>u(x.target.value)}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:s("password"),type:"password",id:"password",autoComplete:"new-password",value:d,onChange:x=>h(x.target.value)}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:s("confirmPassword"),type:"password",id:"confirmPassword",autoComplete:"new-password",value:m,onChange:x=>g(x.target.value)}),e.jsx(y,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:p,children:p?e.jsx(C,{size:24}):l?e.jsx(c,{i18nKey:"linkAccount"}):e.jsx(c,{i18nKey:"createAccount"})}),e.jsx(k,{align:"center",children:e.jsx(y,{onClick:a,variant:"text",children:e.jsx(c,{i18nKey:"alreadyHaveAccount"})})})]})}function H({onSuccess:t,isLinking:a=!1}){const[l,s]=r.useState(""),[n,o]=r.useState(!1),i=async()=>{s(""),o(!0);try{await q(),t&&t()}catch(u){s(u.message||"Failed to sign in with Google")}finally{o(!1)}};return e.jsxs(v,{sx:{mt:2,mb:2},children:[l&&e.jsx(S,{severity:"error",sx:{mb:2},children:l}),e.jsx(L,{sx:{mb:2},children:e.jsx(k,{variant:"body2",color:"text.secondary",children:e.jsx(c,{i18nKey:"or",children:"OR"})})}),e.jsx(y,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(B,{}),onClick:i,disabled:n,sx:{mb:1},"aria-busy":n,"aria-live":"polite",children:n?e.jsx(C,{size:24}):a?W("linkWithGoogle","Link with Google"):W("signInWithGoogle","Sign in with Google")})]})}function D(){const t=r.useContext(N);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function M({children:t,open:a,close:l=null,isMobile:s=null,title:n=null,isLoading:o=!1,maxWidth:i="md",fullWidth:u=!1,ariaLabelledby:d,ariaDescribedby:h,actions:m}){const g=_(),f=s!==null?s:g;return o?null:e.jsxs(P,{fullScreen:f,open:a,maxWidth:i,fullWidth:u,"aria-labelledby":d,"aria-describedby":h,children:[e.jsxs(F,{children:[n,typeof l=="function"&&e.jsx(z,{close:l})]}),e.jsx(K,{children:t}),m&&e.jsx(I,{sx:{p:2,gap:1},children:m})]})}function O({onToggleForm:t}){const[a,l]=r.useState(""),[s,n]=r.useState(""),[o,i]=r.useState(!1),[u,d]=r.useState(!1),{forgotPassword:h}=D(),m=async g=>{g.preventDefault(),n(""),i(!1),d(!0);try{await h(a),i(!0)}catch(f){n(f.message||"Failed to send reset email")}finally{d(!1)}};return e.jsxs(v,{component:"form",onSubmit:m,sx:{mt:1},children:[s&&e.jsx(S,{severity:"error",sx:{mb:2},children:s}),o&&e.jsx(S,{severity:"success",sx:{mb:2},children:e.jsx(c,{i18nKey:"resetEmailSent"})}),e.jsx(b,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:e.jsx(c,{i18nKey:"email"}),name:"email",autoComplete:"email",autoFocus:!0,value:a,onChange:g=>l(g.target.value)}),e.jsx(y,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:u,children:u?e.jsx(C,{size:24}):e.jsx(c,{i18nKey:"sendResetLink"})}),e.jsx(v,{sx:{textAlign:"center"},children:e.jsx(y,{variant:"text",onClick:()=>t("login"),children:e.jsx(c,{i18nKey:"backToLogin"})})})]})}function Z({open:t,close:a,initialView:l="login"}){const[s,n]=r.useState(l),{isAnonymous:o}=D(),{t:i}=A(),u=()=>{switch(s){case"login":return i(o?"linkAccount":"signIn");case"register":return i("createAccount");case"reset":return i("resetPassword");default:return i("Authentication")}};return e.jsxs(M,{title:u(),open:t,close:a,children:[s==="login"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{onSwitchToRegister:()=>n("register"),onSwitchToForgotPassword:()=>n("reset"),onSuccess:a,isLinking:o}),e.jsx(H,{onSuccess:a,isLinking:o})]}),s==="reset"&&e.jsx(O,{onToggleForm:n}),s==="register"&&e.jsx(Y,{onSwitchToLogin:()=>n("login"),onSuccess:a,isAnonymous:o})]})}export{Z as A,M as D,D as u};
//# sourceMappingURL=chunk-DeKR1DJi.js.map
