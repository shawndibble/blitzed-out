import{r as o,ad as T,au as w,j as e,am as d,ao as p,T as n,Q as I,ar as B,a1 as F}from"./chunk-CXdXj9vr.js";import{T as L}from"./chunk-D_3adld7.js";import{l as k}from"./chunk-D_XSr9hd.js";import{b as P}from"./chunk-DTHeDMMX.js";import{p as $,u as H,R as S}from"./chunk-dJQLWvmO.js";import{l as M}from"./chunk-CyaTfQvp.js";import{g as V}from"./chunk-B4ipE-Yx.js";import"./chunk-CwpkSHF3.js";import"./chunk-DevrYHC1.js";import"../assets/index-DHs8EHDD.js";import"./chunk-1y90xjpq.js";import"./chunk-B4PEA_xj.js";import"./chunk-yLOK5aTh.js";import"./chunk-C5RMXZJv.js";import"./chunk-DyFLsfdg.js";function W(r){const a=k(r,"room");let s=!1,t="";if(a){const{roomBackgroundURL:i}=JSON.parse(a.settings),c=$(i);c?.isVideo&&(s=c.isVideo),c?.url&&(t=c.url)}return["color","gray"].some(i=>t.includes(i))&&(t=""),{isVideo:s,url:t}}function O(){const[r,a]=o.useState(document.fullscreenElement!=null);o.useEffect(()=>{const t=()=>{a(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]);const s=o.useCallback(()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen().catch(t=>{console.error("Error attempting to enable fullscreen:",t)}):document.exitFullscreen().catch(t=>{console.error("Error attempting to exit fullscreen:",t)})},[]);return{isFullscreen:r,toggleFullscreen:s}}const D="actions",K=r=>{const{text:a,displayName:s}=r;if(!s)return{};const t=a?.split(`
`),[i,c]=t?.slice(1)||[],h=i?.split(":")[1]?.trim(),l=c?.split(":")[1]?.trim();return{displayName:s,type:h,activity:l}};function ae(){const{id:r}=T(),[a,s]=o.useState(""),[t,i]=o.useState(!1),[c,h]=o.useState(!1),{messages:l,isLoading:f}=P(),{isVideo:x,url:m}=W(l),v=k(l,D),y=H(v),{isFullscreen:A,toggleFullscreen:N}=O();if(o.useEffect(()=>{V().currentUser||M("Cast Viewer").catch(g=>{console.error("Anonymous login failed:",g)})},[r]),o.useEffect(()=>{const u=window.cast?.framework?.CastReceiverContext,g=navigator.userAgent,R=g.includes("CrKey")||g.includes("TV"),j=window.self!==window.top,C=u||R||window.location.search.includes("chromecast")||window.location.search.includes("receiver");return C&&(document.body.classList.add("cast-receiver-mode"),document.body.classList.remove("theme-light"),h(!0)),j&&document.body.classList.add("in-iframe"),()=>{C&&document.body.classList.remove("cast-receiver-mode"),j&&document.body.classList.remove("in-iframe")}},[]),o.useEffect(()=>{if(f)return;const u=l[l.length-1];u?.type==="settings"&&(i(!0),s(`${u.displayName} ${w("changedSettings")}`))},[l,f]),!v)return e.jsxs(d,{className:"flex-column",style:{backgroundColor:"transparent",color:"white",minHeight:"100vh",backgroundImage:!x&&m?`url(${m})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[!!m&&e.jsx(S,{url:m,isVideo:x}),e.jsx(p,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"100vh"},children:e.jsx(p,{container:!0,justifyContent:"center",children:e.jsxs("div",{className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",textAlign:"center",width:"clamp(320px, 90vw, 1400px)",margin:"0 auto"},children:[e.jsxs(n,{variant:"h2",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"1rem",fontSize:"clamp(1.5rem, 6vw, 4rem)"},children:["blitzedout.com/",r]}),f?e.jsx(n,{variant:"h4",style:{color:"#90CAF9",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 4vw, 2.5rem)"},children:"Connecting to game..."}):e.jsx(n,{variant:"h4",style:{color:"#A5D6A7",textShadow:"1px 1px 2px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 4vw, 2.5rem)"},children:"Ready for game to start"})]})})})]});const{displayName:E,type:z,activity:b}=K(v);return e.jsxs(d,{className:"flex-column",style:{backgroundColor:"transparent",color:"white",minHeight:"100vh",backgroundImage:!x&&m?`url(${m})`:"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[!!m&&e.jsx(S,{url:m,isVideo:x}),e.jsxs(d,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(d,{flex:"1",children:!c&&!A&&e.jsx(I,{variant:"text",onClick:N,style:{color:"white"},children:w("fullscreen")})}),e.jsx(d,{textAlign:"center",flex:"1",children:!!y?.displayName&&e.jsx(n,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(1rem, 3vw, 2rem)"},children:e.jsx(B,{i18nKey:"nextPlayersTurn",values:{player:y.displayName}})})},y?.displayName),e.jsx(d,{flex:"1",textAlign:"right",className:"text-stroke",children:b&&e.jsxs(n,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(0.8rem, 2.5vw, 1.5rem)"},children:["blitzedout.com/",r]})})]}),e.jsx(p,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"calc(100vh - 5rem)"},children:e.jsx(p,{container:!0,justifyContent:"center",children:b?e.jsxs(p,{size:12,className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",maxWidth:"95vw",minWidth:"fit-content",margin:"0 auto"},children:[e.jsx(n,{variant:"h3",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontSize:"clamp(1.2rem, 5vw, 3rem)"},children:`${z} ${w("for")} ${E}`}),e.jsx(d,{className:"divider",style:{marginTop:"-0.5rem",height:"0.5rem",backgroundColor:"white",border:"2px solid black"},children:e.jsx(F,{})}),e.jsx(n,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600,fontSize:"clamp(1.8rem, 8vw, 6rem)",lineHeight:1.2},children:b})]}):e.jsx("div",{className:"action-box responsive-cast-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"clamp(1rem, 4vw, 4rem)",borderRadius:"clamp(0.5rem, 1vw, 1rem)",maxWidth:"95vw",minWidth:"fit-content",margin:"0 auto"},children:e.jsxs(n,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600,fontSize:"clamp(1.8rem, 8vw, 6rem)",lineHeight:1.2},children:["blitzedout.com/",r]})})})},l.length),e.jsx(L,{open:!!t,close:()=>i(!1),hideCloseButton:!0,children:e.jsx(n,{variant:"h5",style:{color:"white"},children:a})})]})}export{ae as default};
