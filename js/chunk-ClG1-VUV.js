import{r as d,a7 as f,au as g}from"./chunk-DX6P0x0s.js";import{M as h,o as x}from"./chunk-y_Mwc0dd.js";import{A as y}from"./chunk-CwsWjbbg.js";import{u as v}from"./chunk-DLb-D4CO.js";function P(t){const e=t?.replace(/([A-Z])/g," $1").trim();return e?e.charAt(0).toUpperCase()+e.slice(1):""}function U(t){return{id:`simple-tab-${t}`,"aria-controls":`simple-tabpanel-${t}`}}function N(t){const e=t?.split(/\r?\n/)||[];return e[e.length-1]?.split(":")[1]}function b(t,e){const i=new RegExp(`\\d+\\s${e}`,"g");return t.match(i)?.filter((r,c,u)=>u.indexOf(r)===c)}function R(t){return t?.toUpperCase()==="PUBLIC"}function $(t){return t==="online"}function w(){const t=d.useContext(y);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function M(){const t=f.useContext(h);if(!t)throw new Error("MessagesContext's value is undefined.");return t}function A(t){const e=x(t,"actions","DESC");return[...new Map(e.map(i=>[i.uid,i])).values()]}function B(){const{user:t}=w(),{messages:e,isLoading:i}=M(),{onlineUsers:r}=v();return d.useMemo(()=>{if(i||!t)return[];const u=A(e);return Object.values(r).map(s=>{const a=u.find(n=>n.uid===s.uid)?.text,l=/(?:#)[\d]*(?=:)/gs;let o=0;if(a&&a.match(l)){const n=a.match(l);n&&n[0]&&(o=Number(n[0].replace("#","")))}const m=o>0?o-1:o,p=!!a?.includes(g("finish"));return{displayName:s.displayName||"Unknown",uid:s.uid,isSelf:s.uid===t.uid,location:s.gameState?.location||m,isFinished:s.gameState?.isFinished||p,status:s.status||"away",lastActivity:s.lastSeen||new Date(0)}}).sort((s,a)=>s.isSelf?-1:a.isSelf?1:s.status==="active"&&a.status!=="active"?-1:a.status==="active"&&s.status!=="active"?1:s.displayName.localeCompare(a.displayName))},[t,r,e,i])}export{B as a,M as b,b as c,$ as d,N as e,U as f,P as g,R as i,w as u};
