const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/chunk-bnailViW.js","js/chunk-C3xmVT4n.js","js/chunk-C8k943bk.js","js/chunk-ZK3ykfsb.js","js/chunk-DOeMVZ05.js","assets/index-BKpMoiS-.js","assets/index-DKbdyQom.css"])))=>i.map(i=>d[i]);
!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"2441bc0b1225efdbb7e754480fd00c933f689acb"}}catch(e){}}();try{(t=(new(e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).Error).stack)&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="689b2f4c-154b-452f-bbed-1a968086756c",e._sentryDebugIdIdentifier="sentry-dbid-689b2f4c-154b-452f-bbed-1a968086756c")}catch(e){}var e,t;import{Q as n,R as o,_ as s,m as a,T as r,x as l}from"./chunk-bnailViW.js";import{i,M as c,B as u,S as d,j as _,C as m,k as f,l as g,G as p,m as y,a as b,n as w,o as j,I,Q as h,p as E}from"../assets/index-BKpMoiS-.js";const O=(e,t,n,o)=>{n instanceof Error?n.message:String(n)},D={getItem:e=>{try{return localStorage.getItem(e)}catch(t){return O(0,0,t),null}},setItem:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(n){return O(0,0,n),!1}},removeItem:e=>{try{return localStorage.removeItem(e),!0}catch(t){return O(0,0,t),!1}},getJSON:e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return O(0,0,t),null}},setJSON:(e,t)=>{try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(n){return O(0,0,n),!1}}},v=async(e,t,n)=>{try{return await e()}catch(o){return O(0,0,o),null!=n?n:null}},A=()=>{const e=D.getJSON(_);return!!e&&(Date.now()-new Date(e.startedAt).getTime()>g?(D.removeItem(_),!1):e.inProgress)},T=e=>{if(e){const e={inProgress:!0,startedAt:(new Date).toISOString()};D.setJSON(_,e)}else D.removeItem(_)},S=e=>{const t=D.getJSON(m);return!!t&&(Date.now()-new Date(t.startedAt).getTime()>g?(D.removeItem(m),!1):t.locales&&t.locales.includes(e))},L=(e,t)=>{const n=D.getJSON(m)||{locales:[],startedAt:(new Date).toISOString()};if(t)n.locales.includes(e)||(n.locales.push(e),n.startedAt=(new Date).toISOString());else if(n.locales=n.locales.filter(t=>t!==e),0===n.locales.length)return void D.removeItem(m);D.setJSON(m,n)},P=e=>{if(e){const e={inProgress:!0,startedAt:(new Date).toISOString()};D.setJSON(f,e)}else D.removeItem(f)},R=()=>{D.setJSON(i,{version:c,completed:!0,completedAt:new Date})},N=e=>{const t=D.getJSON(u)||{version:c,completedLanguages:[],inProgress:!1},n=new Set(t.completedLanguages);n.add(e),t.completedLanguages=Array.from(n),D.setJSON(u,t)},V=e=>{const t=D.getJSON(u)||{version:c,completedLanguages:[],inProgress:!1};t.inProgress=e,e?t.startedAt=new Date:t.completedAt=new Date,D.setJSON(u,t)},J=()=>{const e=D.getJSON(i);return!!e&&e.completed&&e.version===c},G=e=>{const t=D.getJSON(u);if(t&&t.completedLanguages.includes(e))return!0;const n=D.getJSON(i);return!(!n||!n.completed||n.version!==c)&&(!t||d.every(e=>t.completedLanguages.includes(e)))},k=()=>({main:D.getJSON(i),background:D.getJSON(u)}),C=()=>{try{D.removeItem(i),D.removeItem(u),D.removeItem(_),D.removeItem(m),D.removeItem(f)}catch(e){O(0,0,e)}},$=()=>{try{const e=D.getJSON(i);if(!e)return{versionChanged:!1};const t=e.version;return t!==c?(x(),{versionChanged:!0,oldVersion:t}):{versionChanged:!1,oldVersion:t}}catch(e){return O(0,0,e),{versionChanged:!1}}},x=()=>{D.removeItem(i),D.removeItem(u),D.removeItem(_),D.removeItem(m),D.removeItem(f)},K=async()=>{try{const e=n.resolvedLanguage;if(void 0!==e)return e;const t=n.language;if(void 0!==t)return t;const o=localStorage.getItem("i18nextLng");if(o&&"undefined"!==o)return o;if("undefined"!=typeof navigator&&navigator.language){const e=navigator.language.split("-")[0];if(d.includes(e))return e}return"en"}catch(e){return O(0,0,e),"en"}},M=async(e,t,n)=>v(async()=>{const a=(await o(Object.assign({"../../locales/en/local-bundle.json":()=>s(()=>import("./local-bundle.json-B3lQOuuE.js"),[]),"../../locales/en/online-bundle.json":()=>s(()=>import("./online-bundle.json-BGrQnWj7.js"),[]),"../../locales/es/local-bundle.json":()=>s(()=>import("./local-bundle.json-B5AWEl7-.js"),[]),"../../locales/es/online-bundle.json":()=>s(()=>import("./online-bundle.json-CuJgIfn4.js"),[]),"../../locales/fr/local-bundle.json":()=>s(()=>import("./local-bundle.json-CYOAn7Ju.js"),[]),"../../locales/fr/online-bundle.json":()=>s(()=>import("./online-bundle.json-7k2diJFN.js"),[]),"../../locales/hi/local-bundle.json":()=>s(()=>import("./local-bundle.json-Hbc4irtQ.js"),[]),"../../locales/hi/online-bundle.json":()=>s(()=>import("./online-bundle.json-rgm0X0qd.js"),[]),"../../locales/zh/local-bundle.json":()=>s(()=>import("./local-bundle.json-qNcAg1_C.js"),[]),"../../locales/zh/online-bundle.json":()=>s(()=>import("./online-bundle.json-CTy_f1Vq.js"),[])}),`../../locales/${t}/${n}-bundle.json`,5)).default[e];if(!a)throw new Error(`Group "${e}" not found in ${t}/${n} bundle`);const r=a.label||e,l=a.type||"action",i=a.actions||{},c=Object.keys(i).map((t,n)=>({id:`${e}-${n+1}`,label:t,value:n+1,isDefault:!0})),u=y(e,t,n),d={id:u,name:e,label:r,intensities:c,type:l,isDefault:!0,locale:t,gameMode:n},_=[];for(const[e,t]of Object.entries(i)){if(!Array.isArray(t))continue;const n=c.find(t=>t.label===e);if(n)for(const e of t)"string"==typeof e&&e.trim()&&_.push({group_id:u,intensity:n.value,action:e.trim(),tags:["default"],isEnabled:1,isCustom:0})}return{customGroup:d,customTiles:_}}),q=async e=>{try{return await l(e),!0}catch(t){if((e=>e instanceof Error&&(e.message.includes("already exists")||e.message.includes("duplicate")||e.message.includes("unique constraint")))(t))return!1;throw t}},z=async(e,t,n,o)=>{try{(e=>{for(const t of e)if(!t.group_id||!t.group_id.trim())throw new Error(`Tile missing group_id during import: ${t.action}`)})(e);const s=await b({locale:t,gameMode:n,group:o});return s&&Array.isArray(s)?e.filter(e=>!s.some(t=>t.group_id===e.group_id&&t.intensity===e.intensity&&t.action===e.action)):e}catch(s){return O(0,0,s),e}},B=async e=>{if(0===e.length)return 0;try{return await w(e),e.length}catch(t){return O(0,0,t),0}},Y=async(e,t)=>{const n=await(async(e,t)=>{try{const n=await o(Object.assign({"../../locales/en/local-bundle.json":()=>s(()=>import("./local-bundle.json-B3lQOuuE.js"),[]),"../../locales/en/online-bundle.json":()=>s(()=>import("./online-bundle.json-BGrQnWj7.js"),[]),"../../locales/es/local-bundle.json":()=>s(()=>import("./local-bundle.json-B5AWEl7-.js"),[]),"../../locales/es/online-bundle.json":()=>s(()=>import("./online-bundle.json-CuJgIfn4.js"),[]),"../../locales/fr/local-bundle.json":()=>s(()=>import("./local-bundle.json-CYOAn7Ju.js"),[]),"../../locales/fr/online-bundle.json":()=>s(()=>import("./online-bundle.json-7k2diJFN.js"),[]),"../../locales/hi/local-bundle.json":()=>s(()=>import("./local-bundle.json-Hbc4irtQ.js"),[]),"../../locales/hi/online-bundle.json":()=>s(()=>import("./online-bundle.json-rgm0X0qd.js"),[]),"../../locales/zh/local-bundle.json":()=>s(()=>import("./local-bundle.json-qNcAg1_C.js"),[]),"../../locales/zh/online-bundle.json":()=>s(()=>import("./online-bundle.json-CTy_f1Vq.js"),[])}),`../../locales/${e}/${t}-bundle.json`,5);return Object.keys(n).sort()}catch(n){return O(0,0,n),[]}})(e,t);let r=0,l=0;const i=await s(()=>import("./chunk-bnailViW.js").then(function(e){return e.W}),__vite__mapDeps([0,1,2,3,4])).then(e=>e.default);for(const o of n)try{if(await a(o,e,t))continue;const n=await M(o,e,t);if(!n)continue;const{customGroup:s,customTiles:c}=n;await i.transaction("rw",[i.customGroups,i.customTiles],async()=>{if(await q(s)&&r++,c.length>0){const n=await z(c,e,t,o),s=await B(n);l+=s}})}catch(c){O(0,0,c)}return{groupsImported:r,tilesImported:l}},U=async()=>{const e=await v(async()=>{const e=d;let t=0;for(const n of e){const e=p;for(const o of e)t+=await r(n,o)}return t},0,0);return null!==e?e:0},Q=async()=>{const e=await v(async()=>{const e=d;for(const n of e){const e=p;for(const o of e)try{await Y(n,o)}catch(t){O(0,0,t)}}return await U(),R(),!0},0,!1);return null!==e&&e},W=async()=>{const e=await v(async()=>{var e,t,n;const o=k();return(null==(e=o.main)?void 0:e.completed)||(null==(n=null==(t=o.background)?void 0:t.completedLanguages)?void 0:n.length)?await U():0},0,0);return null!==e?e:0},X=async e=>{const t=e||await K();try{if(G(t))return!0;if(S(t))return await ne(()=>S(t),`${t} migration`),G(t);L(t,!0);try{const e=p;for(const o of e)try{await Y(t,o)}catch(n){O(0,0,n)}for(const o of e)try{const{removeDuplicateGroups:e}=await s(async()=>{const{removeDuplicateGroups:e}=await import("./chunk-bnailViW.js").then(function(e){return e.X});return{removeDuplicateGroups:e}},__vite__mapDeps([0,1,2,3,4]));await e(t,o)}catch(n){O(0,0,n)}return N(t),!0}finally{L(t,!1)}}catch(n){return O(0,0,n),L(t,!1),!1}},F=async e=>{try{if((()=>{const e=D.getJSON(f);return!!e&&(Date.now()-new Date(e.startedAt).getTime()>2*g?(D.removeItem(f),!1):e.inProgress)})())return;P(!0);const n=e||await K();V(!0);const o=d.filter(e=>e!==n);for(const e of o)if(!G(e))try{const t=p;for(const n of t)await Y(e,n),await new Promise(e=>setTimeout(e,j));for(const n of t){const{removeDuplicateGroups:t}=await s(async()=>{const{removeDuplicateGroups:e}=await import("./chunk-bnailViW.js").then(function(e){return e.X});return{removeDuplicateGroups:e}},__vite__mapDeps([0,1,2,3,4]));await t(e,n)}N(e)}catch(t){O(0,0,t)}V(!1);const{BACKGROUND_MIGRATION_KEY:a}=await s(async()=>{const{BACKGROUND_MIGRATION_KEY:e}=await import("../assets/index-BKpMoiS-.js").then(function(e){return e.t});return{BACKGROUND_MIGRATION_KEY:e}},__vite__mapDeps([5,1,2,0,3,4,6])),r=D.getJSON(a),l=new Set((null==r?void 0:r.completedLanguages)||[]);d.every(e=>l.has(e))&&R()}catch(t){O(0,0,t),V(!1),P(!1)}finally{P(!1)}},H=e=>{try{"undefined"!=typeof window&&"function"==typeof window.requestIdleCallback?window.requestIdleCallback(()=>F(e),{timeout:I}):setTimeout(()=>F(e),h)}catch(t){O(0,0,t)}},Z=async e=>{try{return!!G(e)||(S(e)?(await ne(()=>S(e),`${e} migration`),G(e)):await X(e))}catch(t){return O(0,0,t),O(0,0,null),!1}},ee=async()=>{try{const{versionChanged:e}=$(),t=await K();if(G(t))return!0;if(A())return await ne(()=>A(),"main migration"),J()||G(await K());T(!0);try{const e=await X(t);return e&&H(t),e}finally{T(!1)}}catch(e){return O(0,0,e),T(!1),O(0,0,null),!1}},te=async()=>{try{C();const e=await s(()=>import("./chunk-bnailViW.js").then(function(e){return e.W}),__vite__mapDeps([0,1,2,3,4]));await e.default.customGroups.clear(),await e.default.customTiles.clear()}catch(e){O(0,0,e)}},ne=async(e,t)=>{const n=Date.now();for(;e();){if(Date.now()-n>E){O(0,0,null);break}await new Promise(e=>setTimeout(e,50))}};export{X as a,F as b,ee as c,$ as d,Z as e,J as f,k as g,te as h,G as i,W as j,O as l,Q as m,H as q,C as r,D as s,v as w};
//# sourceMappingURL=chunk-BTFboKTn.js.map
