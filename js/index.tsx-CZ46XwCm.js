import{j as e,am as j,ak as T,ap as M,aq as z,aR as A,T as p,ar as h,U as L,ad as Q,r as m,A as le,Q as P,G as ce,aS as G,ao as w,aH as de,z as ue,y as pe,as as xe,M as he,b3 as me,aP as ge,b5 as be,au as $,at as _,aE as U,aG as Y,aF as H,a1 as X,E as ye,K as je,b6 as Se,b7 as fe,b8 as ve,al as Ce,W as ke,ay as Pe,Y as we}from"./chunk-BCLv-HyH.js";import{u as Ae,C as Ie}from"./chunk-Bzty42SC.js";import{Q as Re,R as Me,K as ze,F as Le,J as V,T as Te}from"./chunk-BqpKB5_W.js";import{i as R,d as B}from"./chunk-6r4ubesh.js";import{d as Ke}from"./chunk-C5tDN2aE.js";import{z as Be,A as Oe,I as We}from"./chunk-B4ipE-Yx.js";import{L as Ee,M as J,Y as Ne,G as Ge}from"./chunk-BKsciEZF.js";import{u as Ue}from"./chunk-CrxJbRFx.js";import{c as F,a as Ye,b as He}from"./chunk-CsuSNx_o.js";import{u as Ve}from"./chunk-Bh-K8CM6.js";import"../assets/index-FPnHeHSJ.js";import"./schedule.tsx-xMRhiLZe.js";import"./chunk-CdYmDWt4.js";import"./chunk-DeLoLJoz.js";import"./theme.tsx-CImP-dp7.js";import"./chunk-UgYn6M74.js";import"./chunk-BBKbBimA.js";import"./chunk-SJIi4_E6.js";import"./chunk-B4PEA_xj.js";import"./chunk-yLOK5aTh.js";import"./chunk-CsxC1lz0.js";import"./chunk-B1_FMVaf.js";import"./chunk-Cb6_SH5X.js";function W({children:t,justifyContent:i="space-evenly"}){return e.jsx(j,{sx:{mt:3,display:"flex",flexDirection:"row",justifyContent:i,alignItems:"center"},children:t})}function q({isPublic:t,onClick:i,isSelected:r}){const{t:a}=T();return e.jsx(M,{sx:{cursor:"pointer",border:r?"3px solid":"1px solid",borderColor:r?"primary.main":"grey.300",backgroundColor:r?"primary.50":"background.paper",transform:r?"scale(1.02)":"scale(1)",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.main",boxShadow:r?4:2,transform:"scale(1.02)"}},onClick:i,children:e.jsx(z,{sx:{p:3},children:e.jsxs(A,{direction:"row",spacing:3,alignItems:"center",children:[e.jsx(j,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:56,height:56,borderRadius:"50%",backgroundColor:r?"primary.main":"primary.50",color:r?"primary.contrastText":"primary.main",transition:"all 0.2s ease-in-out"},children:t?e.jsx(Re,{sx:{fontSize:28},"aria-label":"Public"}):e.jsx(Me,{sx:{fontSize:28},"aria-label":"Private"})}),e.jsxs(A,{spacing:.5,flex:1,children:[e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(p,{variant:"h6",component:"h3",sx:{fontWeight:600},children:e.jsx(h,{i18nKey:t?"public":"private"})}),r&&e.jsx(L,{label:a("selected"),size:"small",color:"primary",sx:{fontSize:"0.75rem",fontWeight:500,height:20}})]}),e.jsx(p,{variant:"body1",color:"text.secondary",sx:{fontSize:"0.95rem"},children:e.jsx(h,{i18nKey:t?"publicRoomBenefit":"privateRoomBenefit"})})]})]})})})}function Fe({formData:t,setFormData:i,nextStep:r}){const{t:a}=T(),{id:n}=Q(),[s,c]=m.useState(!R(t.room||n)),[d,S]=m.useState(t.room?.toUpperCase()||"");m.useEffect(()=>{const k=t.room||n,I=!R(k);c(I),S(k?.toUpperCase()||"")},[n,t.room,s]);const u=async k=>{try{const I=Be(),f=Oe(I,`rooms/${k}/uids`);return(await We(f)).exists()}catch{return!1}},l=m.useCallback(async()=>{const k=Ke("123456789ABCDEFGHJKLMNPQRSTUVWXYZ",5);let I,f=0;const C=10;do if(I=k(),f++,f>=C)break;while(await u(I));return I},[]),o=m.useCallback(()=>{i({...t,room:"PUBLIC",gameMode:"online",roomRealtime:!0}),c(!1)},[t,i]),x=m.useCallback(async()=>{const k=await l();i({...t,room:k,gameMode:"online",roomRealtime:!1}),S(k.toUpperCase()),c(!0)},[t,i,l]),y=m.useCallback(k=>{i({...t,room:k,boardUpdated:!0})},[t,i]),g=m.useCallback(k=>{const I=k.target.value.toUpperCase();S(I)},[]),b=m.useCallback(()=>{y(d)},[y,d]),v=m.useCallback(k=>{k.key==="Enter"&&y(d)},[y,d]),K=R(t.room||n);function O(){r(K?3:1)}return e.jsxs(j,{sx:{m:1},children:[e.jsx(p,{variant:"h5",gutterBottom:!0,textAlign:"center",children:e.jsx(h,{i18nKey:"chooseRoomType"})}),e.jsx(p,{variant:"body1",color:"text.secondary",textAlign:"center",sx:{mb:3},children:e.jsx(h,{i18nKey:"roomTypeDescription"})}),e.jsxs(A,{spacing:2,sx:{mb:3},children:[e.jsx(q,{isPublic:!0,onClick:o,isSelected:K}),e.jsx(q,{isPublic:!1,onClick:x,isSelected:!K})]}),s&&e.jsxs(j,{sx:{p:3,borderRadius:2,backgroundColor:"primary.50",mb:2},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:a("privateRoomCode")}),e.jsx(le,{fullWidth:!0,id:"privateRoom",value:d,onBlur:b,onKeyDown:v,onChange:g,inputProps:{style:{textTransform:"uppercase",fontFamily:"monospace",fontSize:"1.25rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.2em"}},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper","& fieldset":{borderColor:"divider",borderWidth:2},"&:hover fieldset":{borderColor:"primary.main"},"&.Mui-focused fieldset":{borderColor:"primary.main",borderWidth:2}}}}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mt:1.5,textAlign:"center"},children:a("privateRoomCodeHelp")})]}),e.jsx(W,{children:e.jsx(P,{variant:"contained",onClick:O,size:"large",children:e.jsx(h,{i18nKey:"next"})})})]})}function qe({formData:t,setFormData:i,nextStep:r,prevStep:a}){const{t:n}=T(),{hasLocalPlayers:s,clearLocalSession:c}=Ue(),[d,S]=m.useState(!1),[u,l]=m.useState(null),o=t.room!=="PUBLIC",x=m.useCallback(()=>{S(!0),l(null)},[]),y=m.useCallback(()=>{s&&c(),i(v=>({...v,hasLocalPlayers:!1,localPlayersData:void 0,localPlayerSessionSettings:void 0,gameMode:v.gameMode==="local"?"online":v.gameMode})),r()},[s,c,r,i]),g=m.useCallback(async(v,K)=>{try{i({...t,localPlayersData:v,localPlayerSessionSettings:K,hasLocalPlayers:!0}),S(!1),r()}catch(O){l(O instanceof Error?O.message:"Failed to save local player configuration")}},[t,i,r]),b=m.useCallback(()=>{S(!1),l(null)},[]);return m.useEffect(()=>{if(!o){const v=setTimeout(()=>{r()},100);return()=>clearTimeout(v)}},[o,r]),o?d?e.jsx(ce,{in:!0,children:e.jsxs(j,{children:[u&&e.jsx(G,{severity:"error",sx:{mb:2},children:u}),e.jsx(Ee,{roomId:t.room||"PRIVATE",isPrivateRoom:o,onComplete:g,onCancel:b,initialPlayers:t.localPlayersData,initialSettings:t.localPlayerSessionSettings})]})}):e.jsxs(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(h,{i18nKey:"localPlayersStep.title"})}),e.jsx(p,{variant:"body1",color:"text.secondary",sx:{mb:3},children:e.jsx(h,{i18nKey:"localPlayersStep.subtitle"})}),e.jsxs(w,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(M,{sx:{cursor:"pointer",border:"1px solid",borderColor:"divider",backgroundColor:"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:x,children:e.jsx(z,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:e.jsx(h,{i18nKey:"localPlayersStep.setupOption.title"})}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-line",textAlign:"left",width:"100%",lineHeight:1.8,mb:2},children:e.jsx(h,{i18nKey:"localPlayersStep.setupOption.description"})}),e.jsx(P,{variant:"outlined",fullWidth:!0,size:"large",sx:{mt:2},"data-testid":"localPlayersStep.setupOption.button",onClick:x,children:n("localPlayersStep.setupOption.button")})]})})})}),e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(M,{sx:{cursor:"pointer",border:"1px solid",borderColor:"divider",backgroundColor:"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:y,children:e.jsx(z,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:e.jsx(h,{i18nKey:"localPlayersStep.skipOption.title"})}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-line",textAlign:"left",width:"100%",lineHeight:1.8,mb:2},children:e.jsx(h,{i18nKey:"localPlayersStep.skipOption.description"})}),e.jsx(P,{variant:"outlined",fullWidth:!0,size:"large",sx:{mt:2},"data-testid":"localPlayersStep.skipOption.button",onClick:y,children:n("localPlayersStep.skipOption.button")})]})})})})]}),s&&e.jsx(G,{severity:"info",sx:{mb:3},children:e.jsx(p,{variant:"body2",children:e.jsx(h,{i18nKey:"localPlayersStep.currentStatus.hasPlayers"})})}),e.jsx(j,{sx:{flexGrow:1}}),e.jsxs(W,{children:[e.jsx(P,{onClick:a,children:e.jsx(h,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",onClick:y,children:e.jsx(h,{i18nKey:"skip"})})]})]}):e.jsx(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:e.jsx(p,{variant:"h6",color:"text.secondary",children:n("localPlayersStep.publicRoomMessage","Local players are not available for public rooms. Continuing...")})})}function Qe({formData:t,setFormData:i,nextStep:r,prevStep:a}){const{t:n}=T(),s=!!t.hasLocalPlayers;m.useEffect(()=>{s&&i(o=>({...o,gameMode:"local",roomRealtime:!1}))},[s,i]);const[c,d]=m.useState(!B(t?.gameMode)&&!s);m.useEffect(()=>{d(!B(t?.gameMode)&&!s)},[t?.gameMode,s]);const S=[{id:"local",title:"yesInteracting",description:n("physicalInteractionDesc"),isSelected:!B(t?.gameMode)},{id:"online",title:"noInteracting",description:n("soloOnlinePlayDesc"),isSelected:B(t?.gameMode)}],u=[{value:"dom",label:"Dominant",description:n("dominantRoleDesc")},{value:"vers",label:"Switch",description:n("switchRoleDesc")},{value:"sub",label:"Submissive",description:n("submissiveRoleDesc")}],l=[{id:"clothed",title:"noNaked",description:n("foreplayClothedDesc"),isSelected:!t.isNaked},{id:"naked",title:"yesNaked",description:n("intimateNudityDesc"),isSelected:t.isNaked}];return e.jsxs(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[!s&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(h,{i18nKey:"playingWithPeople"})}),e.jsx(w,{container:!0,spacing:2,sx:{mb:3},children:S.map(o=>e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(M,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:o.isSelected?"3px solid":"1px solid",borderColor:o.isSelected?"primary.main":"divider",backgroundColor:o.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>i({...t,gameMode:o.id==="local"?"local":"online",roomRealtime:o.id!=="local"}),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),i({...t,gameMode:o.id==="local"?"local":"online",roomRealtime:o.id!=="local"}))},children:e.jsx(z,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:n(o.title)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:o.description}),o.isSelected&&e.jsx(L,{label:n("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},o.id))})]}),s&&e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(h,{i18nKey:"gameModeSelection"})}),c&&e.jsxs(j,{sx:{mb:3},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:e.jsx(h,{i18nKey:"yourRole"})}),e.jsx(w,{container:!0,spacing:2,sx:{mb:3},children:u.map(o=>e.jsx(w,{size:{xs:12,sm:4},children:e.jsx(M,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:t.role===o.value?"2px solid":"1px solid",borderColor:t.role===o.value?"primary.main":"divider",backgroundColor:t.role===o.value?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>i({...t,role:o.value}),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),i({...t,role:o.value}))},children:e.jsx(z,{sx:{p:2.5},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"subtitle1",sx:{fontWeight:600},children:n(o.value)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:o.description}),t.role===o.value&&e.jsx(L,{label:n("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},o.value))})]}),!B(t?.gameMode)&&e.jsxs(j,{sx:{mb:3},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:e.jsx(h,{i18nKey:"areYouNaked"})}),e.jsx(w,{container:!0,spacing:2,children:l.map(o=>e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(M,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:o.isSelected?"2px solid":"1px solid",borderColor:o.isSelected?"primary.main":"divider",backgroundColor:o.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>i({...t,isNaked:o.id==="naked"}),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),i({...t,isNaked:o.id==="naked"}))},children:e.jsx(z,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:n(o.title)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:o.description}),o.isSelected&&e.jsx(L,{label:n("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},o.id))})]}),e.jsx(j,{sx:{flexGrow:1}}),e.jsxs(W,{children:[e.jsx(P,{onClick:a,children:e.jsx(h,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",onClick:r,children:e.jsx(h,{i18nKey:"next"})})]})]})}const $e=(t,i)=>{const{gameMode:r,isNaked:a}=t,n=B(r);return n&&["foreplay","sex"].includes(i.type)||!n&&a&&["solo","foreplay"].includes(i.type)||!n&&!a&&["solo","sex"].includes(i.type)},_e=t=>{const i={...t},r=t.selectedActions||{},a={};return Object.entries(r).forEach(([n,s])=>{$e(t,s)||(a[n]=s)}),i.selectedActions=a,i},Z=(t,i,r)=>{const a=t.selectedActions||{};return Object.entries(a).map(([n,s])=>{const c=i.find(d=>d.value===n);return s.type!==r||!c?null:n}).filter(n=>!!n)},Xe=(t,i,r)=>{const a={...t},n={...a.selectedActions};return Object.keys(n).forEach(s=>{n[s].type===i&&!r.includes(s)&&delete n[s]}),a.selectedActions=n,a},D=(t,i,r)=>{r(a=>{const n=Xe(a,i,t),s={...n.selectedActions};return t.forEach(c=>{if(s[c])return;let d={type:i,levels:[1]};i==="consumption"&&(d={...d,variation:n.isAppend?"appendMost":"standalone"}),s[c]=d}),{...n,selectedActions:s}})},ee=(t,i,r,a,n=null)=>{a(s=>{const c={...s.selectedActions||{}};return t.length===0?delete c[i]:c[i]={...c[i]||{},type:r,levels:t,...!!n&&{variation:n}},{...s,selectedActions:c}})},Je=t=>!!(t&&Object.keys(t).some(i=>{const r=t[i];return r?.levels&&r.levels.length>0&&r?.variation!=="appendMost"}));function te(){return e.jsxs(p,{variant:"h6",sx:{mt:2},children:[e.jsx(h,{i18nKey:"setIntensityLevel"}),e.jsx(de,{title:e.jsx(p,{variant:"body1",children:e.jsx(h,{i18nKey:"intensityTooltip"})}),arrow:!0,sx:{ml:1},children:e.jsx(ze,{sx:{ml:.5,fontSize:15}})})]})}function se({onChange:t,values:i,options:r,label:a}){const n=m.useCallback(c=>r?.find(d=>d.value===c)?.label,[r]),s=m.useCallback(c=>e.jsx(j,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:c?.map(d=>e.jsx(L,{label:n(d)},d))}),[n]);return e.jsxs(ue,{fullWidth:!0,children:[e.jsx(pe,{id:`${a}-label`,children:a}),e.jsx(xe,{labelId:`${a}-label`,id:`${a}`,multiple:!0,value:i,onChange:t,fullWidth:!0,input:e.jsx(be,{label:e.jsx(h,{i18nKey:"actionsLabel"})}),renderValue:s,children:r?.map(({label:c,value:d})=>e.jsxs(he,{value:d,children:[e.jsx(me,{checked:i.includes(d)}),e.jsx(ge,{primary:c})]},d))})]})}const Ze=4,De=t=>B(t?.gameMode)?"solo":t.isNaked?"sex":"foreplay";function et({formData:t,setFormData:i,options:r,actionsList:a}){const n=De(t),s=r(n),d=Z(t,s,n)||[],S=u=>{const{value:l}=u.target,o=typeof l=="string"?l.split(","):l;o.length<=Ze&&D(o,n,i)};return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h6",sx:{my:2},children:e.jsx(h,{i18nKey:"pickActions"})}),e.jsx(se,{onChange:S,values:d,options:s,label:$("actionsLabel")}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(te,{}),d.map(u=>{const l=a[u],o=l?.intensities?Object.keys(l.intensities).map(Number).filter(y=>y>0).sort((y,g)=>y-g):[1,2,3,4],x=t.selectedActions?.[u]?.levels||[];return e.jsx(J,{actionName:u,actionLabel:l?.label||u,selectedLevels:x,availableLevels:o,intensityNames:l?.intensities||{},onChange:y=>ee(y,u,n,i)},u)})]})]})}const tt=2;function st({formData:t,setFormData:i,options:r,actionsList:a}){const n="consumption",s=r(n),d=Z(t,s,n)||[],S=l=>{const{value:o}=l.target,x=typeof o=="string"?o.split(","):o;x.length<=tt&&D(x,n,i)},u=(l,o)=>{const x=l.target.checked?"appendMost":"standalone",y=l.target.checked,g={...t.selectedActions};o.forEach(v=>{g[v]&&(g[v]={...g[v],variation:x})});const b={...t,isAppend:y,selectedActions:g};i(b)};return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h6",sx:{my:2},children:e.jsx(h,{i18nKey:"pickConsumptions"})}),e.jsx(se,{onChange:S,values:d,options:s,label:$("consumables")}),!!d.length&&e.jsxs(e.Fragment,{children:[e.jsx(te,{}),d.map(l=>{const o=a[l],x=o?.intensities?Object.keys(o.intensities).map(Number).filter(g=>g>0).sort((g,b)=>g-b):[1,2,3,4],y=t.selectedActions?.[l]?.levels||[];return e.jsx(J,{actionName:l,actionLabel:o?.label||l,selectedLevels:y,availableLevels:x,intensityNames:o?.intensities||{},onChange:g=>ee(g,l,n,i,t.isAppend?"appendMost":"standalone")},l)}),e.jsx(p,{variant:"h6",sx:{mt:2},children:e.jsx(h,{i18nKey:"standaloneOrCombine"})}),e.jsx(Ne,{trueCondition:t.isAppend,onChange:l=>u(l,d),yesLabel:"combineWithActions"})]})]})}function nt({gameMode:t,onPresetSelect:i,selectedPreset:r,actionsList:a,showTitle:n=!0}){const{t:s}=T(),c={solo:[{id:"popperbating",name:s("presetPopperbating"),description:s("presetPopperbatingDesc"),actions:["bating"],consumptions:["poppers"],intensities:{bating:2,poppers:1}},{id:"smoking-tits",name:s("presetSmokingTits"),description:s("presetSmokingTitsDesc"),actions:["titTorture"],consumptions:["vaping"],intensities:{titTorture:2,vaping:1}},{id:"exploration-solo",name:s("presetExplorationSolo"),description:s("presetExplorationSoloDesc"),actions:["throatTraining","buttPlay","titTorture","ballBusting"],consumptions:[],intensities:{throatTraining:1,buttPlay:1,titTorture:1,ballBusting:1}},{id:"ball-busting",name:s("presetBallBusting"),description:s("presetBallBustingDesc"),actions:["ballBusting","bating"],consumptions:["poppers"],intensities:{ballBusting:2,bating:2}}],foreplay:[{id:"romantic-start",name:s("presetRomanticStart"),description:s("presetRomanticStartDesc"),actions:["kissing","stripping"],consumptions:["alcohol"],intensities:{kissing:2,stripping:1,alcohol:1}},{id:"degrading",name:s("presetDegrading"),description:s("presetDegradingDesc"),actions:["humiliation","footPlay","breathPlay"],consumptions:["poppers"],intensities:{humiliation:2,footPlay:2,breathPlay:2,poppers:2}},{id:"sensual-touch",name:s("presetSensualTouch"),description:s("presetSensualTouchDesc"),actions:["kissing","footPlay","tickling"],consumptions:[],intensities:{kissing:2,footPlay:1,tickling:1}},{id:"electric-play",name:s("presetElectricPlay"),description:s("presetElectricPlayDesc"),actions:["electric","bondage"],consumptions:["vaping"],intensities:{electric:1,bondage:2,vaping:1}}],sex:[{id:"gentle-sex",name:s("presetGentleSex"),description:s("presetGentleSexDesc"),actions:["throatTraining","bating","buttPlay"],consumptions:["alcohol"],intensities:{throatTraining:1,bating:1,buttPlay:1,alcohol:1}},{id:"fisting",name:s("presetFisting"),description:s("presetFistingDesc"),actions:["buttPlay"],consumptions:["poppers"],intensities:{buttPlay:4,poppers:4}},{id:"bdsm",name:s("presetBdsm"),description:s("presetBdsmDesc"),actions:["pissPlay","throatTraining","spanking","titTorture"],consumptions:[],intensities:{pissPlay:2,throatTraining:2,spanking:2,titTorture:2}},{id:"breath-control",name:s("presetBreathControl"),description:s("presetBreathControlDesc"),actions:["bating"],consumptions:["gasMask"],intensities:{bating:2,gasMask:2}}]},d=c[t]||c.solo,S=u=>{i(u)};return e.jsxs(j,{children:[n&&e.jsx(p,{variant:"h6",gutterBottom:!0,children:s("quickStart")}),e.jsx(w,{container:!0,spacing:2,children:d.map(u=>e.jsx(w,{size:{xs:12,sm:6,lg:3},children:e.jsx(M,{sx:{cursor:"pointer",border:r===u.id?2:1,borderColor:r===u.id?"primary.main":"divider",backgroundColor:r===u.id?"primary.dark":"background.paper",transition:"all 0.2s ease-in-out",height:"100%",boxShadow:1,"&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:3,backgroundColor:r===u.id?"primary.dark":"action.hover"}},onClick:()=>S(u),children:e.jsxs(z,{sx:{p:2.5},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:u.name}),e.jsxs(j,{children:[u.actions.map((l,o)=>e.jsx(L,{label:a[l]?.label||l,size:"small",variant:"outlined",sx:{mr:.5,mb:.5,borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"primary.50"}}},`action-${o}`)),u.consumptions.map((l,o)=>e.jsx(L,{label:a[l]?.label||l,size:"small",color:"secondary",variant:"outlined",sx:{mr:.5,mb:.5,borderColor:"secondary.main",color:"secondary.main","&:hover":{backgroundColor:"secondary.50"}}},`consumption-${o}`))]})]})})},u.id))})]})}function it({formData:t,setFormData:i,nextStep:r,prevStep:a,actionsList:n,isActionsLoading:s=!1}){const{t:c}=T(),[d,S]=m.useState(""),[u,l]=m.useState(!1),[o,x]=m.useState(!0);function y(f){return Object.keys(n).filter(C=>n[C]?.type===f)}m.useEffect(()=>{const f=_e(t);i(f)},[]),m.useEffect(()=>{t.selectedActions&&Object.keys(t.selectedActions).length>0&&(l(!0),x(!1))},[]);const g=f=>y(f).map(C=>({value:C,label:n[C]?.label}));let b;t.gameMode==="online"?b="solo":t.gameMode==="local"&&!t.isNaked?b="foreplay":b="sex";const v=(f,C,ne,ie)=>{f.forEach(E=>{if(n[E]){const oe=ne.intensities?.[E]||C,re=Object.keys(n[E].intensities||{}).filter(N=>N!=="None").length;ie[E]={type:n[E].type,levels:Array.from({length:Math.min(oe,re)},(N,ae)=>ae+1)}}})},K=f=>{S(f.id);const C={};v(f.actions,2,f,C),v(f.consumptions,1,f,C),i({...t,selectedActions:C}),x(!1),l(!0)},O=(f,C)=>{x(C),C&&l(!1)},k=(f,C)=>{l(C),C&&x(!1)},I=!Je(t.selectedActions);return s?e.jsxs(j,{children:[e.jsxs(j,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,gap:2},children:[e.jsx(_,{size:48}),e.jsx(p,{variant:"h6",color:"text.secondary",children:c("loadingAvailableActions")})]}),e.jsx(j,{sx:{mt:4},children:e.jsxs(W,{children:[e.jsx(P,{disabled:!0,children:e.jsx(h,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",disabled:!0,size:"large",children:e.jsx(h,{i18nKey:"next"})})]})})]}):e.jsxs(j,{children:[e.jsxs(U,{expanded:o,onChange:O,sx:{backgroundColor:"background.default",borderTop:1,borderBottom:1,borderColor:"divider",borderLeft:"none",borderRight:"none",borderRadius:0,"&:before":{display:"none"},boxShadow:"none"},children:[e.jsx(Y,{expandIcon:e.jsx(V,{}),"aria-controls":"quickstart-content",id:"quickstart-header",sx:{backgroundColor:"background.default"},children:e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Le,{}),e.jsx(p,{variant:"h6",children:c("quickStart")})]})}),e.jsx(H,{sx:{pb:1},children:e.jsx(nt,{gameMode:b,onPresetSelect:K,selectedPreset:d,actionsList:n,showTitle:!1})})]}),e.jsxs(U,{expanded:u,onChange:k,sx:{backgroundColor:"background.default",borderTop:o?"none":1,borderBottom:1,borderColor:"divider",borderLeft:"none",borderRight:"none",borderRadius:0,marginTop:o?-1:0,"&:before":{display:"none"},boxShadow:"none"},children:[e.jsx(Y,{expandIcon:e.jsx(V,{}),"aria-controls":"customization-content",id:"customization-header",sx:{backgroundColor:"background.default"},children:e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Te,{}),e.jsx(p,{variant:"h6",children:c("customizeActions")})]})}),e.jsxs(H,{children:[e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mb:2},children:c("customizeActionsDesc")}),e.jsx(et,{formData:t,setFormData:i,options:g,actionsList:n}),e.jsx(X,{sx:{my:3}}),e.jsx(st,{formData:t,setFormData:i,options:g,actionsList:n})]})]}),e.jsx(j,{sx:{mt:4},children:e.jsxs(W,{children:[e.jsx(P,{onClick:()=>a(R(t.room)?3:1),children:e.jsx(h,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",disabled:I,onClick:r,size:"large",children:e.jsx(h,{i18nKey:"next"})})]})})]})}function ot({formData:t,setFormData:i,prevStep:r,actionsList:a,close:n}){const s=[100,100],c=[0,0],[d,S]=m.useState(F(t?.finishRange||[],c)),[u,l]=m.useState(!1),o=Ye(),{t:x}=T();m.useEffect(()=>{let b={...t,boardUpdated:!0};(!d||!F(t.finishRange||[],s))&&(b.finishRange=s),i(b)},[]);async function y(){l(!0);try{await o(t,a)}catch(b){console.error("Error submitting settings:",b)}finally{l(!1)}typeof n=="function"&&n()}const g=[{id:"noOrgasm",title:"noOrgasm",description:x("noOrgasmDesc"),isSelected:!d},{id:"yesOrgasm",title:"yesOrgasm",description:x("yesOrgasmDesc"),isSelected:d}];return e.jsxs(j,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(h,{i18nKey:"WillYouOrgasm"})}),e.jsx(w,{container:!0,spacing:2,sx:{mb:4},children:g.map(b=>e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(M,{sx:{cursor:"pointer",border:b.isSelected?"3px solid":"1px solid",borderColor:b.isSelected?"primary.main":"divider",backgroundColor:b.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%",transform:b.isSelected?"scale(1.02)":"scale(1)","&:hover":{borderColor:"primary.main",transform:"scale(1.02)",boxShadow:2}},onClick:()=>{const v=b.id==="yesOrgasm";i({...t,finishRange:v?c:s}),S(v)},children:e.jsx(z,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:x(b.title)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:b.description}),b.isSelected&&e.jsx(L,{label:x("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},b.id))}),e.jsx(j,{sx:{flexGrow:1}}),e.jsxs(W,{children:[e.jsx(P,{onClick:r,disabled:u,children:e.jsx(h,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",onClick:y,disabled:u,startIcon:u?e.jsx(_,{size:20}):null,size:"large",sx:{px:4},children:e.jsx(h,{i18nKey:"buildGame"})})]})]})}function rt({currentStep:t,isPublicRoom:i,onStepClick:r}){const{t:a}=T(),n=ye(),s=je(n.breakpoints.down("md")),c=i?[{label:String(a("roomSelection","Room Selection")),wizardStep:1},{label:String(a("actionsSelection","Actions Selection")),wizardStep:4},{label:String(a("finishSetup","Finish Setup")),wizardStep:5}]:[{label:String(a("roomSelection","Room Selection")),wizardStep:1},{label:String(a("localPlayersStep.title","Local Players")),wizardStep:2},{label:String(a("gameModeSelection","Game Mode Selection")),wizardStep:3},{label:String(a("actionsSelection","Actions Selection")),wizardStep:4},{label:String(a("finishSetup","Finish Setup")),wizardStep:5}],d=c.findIndex(u=>u.wizardStep===t),S=u=>{if(r){const l=c[u].wizardStep;r(l)}};return e.jsx(Se,{activeStep:d,alternativeLabel:!s,orientation:"horizontal",sx:{...s&&{"& .MuiStepLabel-label":{display:"none"}}},children:c.map((u,l)=>e.jsx(fe,{children:e.jsx(ve,{onClick:()=>S(l),sx:{cursor:r?"pointer":"default","&:hover":r?{"& .MuiStepLabel-label":{color:"primary.main"}}:{}},children:s?null:u.label})},l))})}function at({close:t}){const{id:i}=Q(),[r,a]=m.useState(1),n={room:i||"PUBLIC"},[s,c]=Ve({gameMode:"online",roomRealtime:!0,actions:[],consumption:[],role:"sub",boardUpdated:!1,room:i||"PUBLIC",selectedActions:{}},n),{actionsList:d,isLoading:S}=He(s.gameMode),u=g=>{if(!Number.isInteger(g))return a(r+1);a(r+(g||1))},l=g=>{if(!Number.isInteger(g))return a(r-1);a(r-(g||1))},o=()=>a(0),x=()=>{R(s.room)||s.gameMode==="online"?a(4):a(1)},y=()=>{switch(r){case 1:return e.jsx(Fe,{formData:s,setFormData:c,nextStep:u});case 2:return R(s.room)?(a(4),null):e.jsx(qe,{formData:s,setFormData:c,nextStep:u,prevStep:l});case 3:return R(s.room)?(a(4),null):e.jsx(Qe,{formData:s,setFormData:c,nextStep:u,prevStep:l});case 4:return e.jsx(it,{formData:s,setFormData:c,nextStep:u,prevStep:l,actionsList:d,isActionsLoading:S});case 5:return e.jsx(ot,{formData:s,setFormData:c,prevStep:l,actionsList:d,close:t});default:return null}};return r===0?e.jsx(Ge,{closeDialog:t,onOpenSetupWizard:x}):e.jsxs(j,{children:[e.jsx(j,{sx:{width:"100%",mt:2,mb:4},children:e.jsx(rt,{currentStep:r,isPublicRoom:R(s.room),onStepClick:a})}),y(),e.jsx(X,{sx:{mt:3}}),e.jsx(P,{onClick:o,children:e.jsx(h,{i18nKey:"advancedSetup"})})]})}function Lt({open:t,close:i}){const r=Ae(),[a]=Ce();return a.get("importBoard")?null:e.jsxs(ke,{fullScreen:r,open:t,maxWidth:"md",children:[e.jsxs(Pe,{children:[e.jsx(h,{i18nKey:"gameSettingsHeading"}),typeof i=="function"&&e.jsx(Ie,{close:i})]}),e.jsx(we,{children:e.jsx(at,{close:typeof i=="function"?i:void 0})})]})}export{Lt as default};
