import{r as a,ad as R,au as j,j as e,am as u,ao as m,T as o,Q as B,ar as F,a1 as L}from"./chunk-DJZJtpVs.js";import{T as I}from"./chunk-9fkTg0gS.js";import{l as A}from"./chunk-BikDqVae.js";import{b as M}from"./chunk-Cr1EHUU6.js";import{p as V,u as P,R as w}from"./chunk-BJEMW_p6.js";import{l as W}from"./chunk-DHQAmiDX.js";import{g as $}from"./chunk-B4ipE-Yx.js";import"./chunk-7OQk-BoX.js";import"./chunk-DEqUmdJg.js";import"../assets/index-NwShAHf3.js";import"./chunk-DtF_b7C9.js";import"./chunk-B4PEA_xj.js";import"./chunk-yLOK5aTh.js";function z(s){const i=A(s,"room");let r=!1,t="";if(i){const{roomBackgroundURL:c}=JSON.parse(i.settings),n=V(c);n?.isVideo&&(r=n.isVideo),n?.url&&(t=n.url)}return["color","gray"].some(c=>t.includes(c))&&(t=""),{isVideo:r,url:t}}function H(){const[s,i]=a.useState(document.fullscreenElement!=null);a.useEffect(()=>{const t=()=>{i(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]);const r=a.useCallback(()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen().catch(t=>{console.error("Error attempting to enable fullscreen:",t)}):document.exitFullscreen().catch(t=>{console.error("Error attempting to exit fullscreen:",t)})},[]);return{isFullscreen:s,toggleFullscreen:r}}const O="actions",D=s=>{const{text:i,displayName:r}=s;if(!r)return{};const t=i?.split(`
`),[c,n]=t?.slice(1)||[],g=c?.split(":")[1]?.trim(),l=n?.split(":")[1]?.trim();return{displayName:r,type:g,activity:l}};function re(){const{id:s}=R(),[i,r]=a.useState(""),[t,c]=a.useState(!1),[n,g]=a.useState(!1),{messages:l,isLoading:p}=M(),{isVideo:v,url:x}=z(l),f=A(l,O),y=P(f),{isFullscreen:S,toggleFullscreen:N}=H();if(a.useEffect(()=>{$().currentUser||W("Cast Viewer").catch(h=>{console.error("Anonymous login failed:",h)})},[s]),a.useEffect(()=>{const d=window.cast?.framework?.CastReceiverContext,h=navigator.userAgent,T=h.includes("CrKey")||h.includes("TV"),C=d||T||window.location.search.includes("chromecast");return C&&(document.body.classList.add("cast-receiver-mode"),document.body.classList.remove("theme-light"),g(!0)),()=>{C&&document.body.classList.remove("cast-receiver-mode")}},[]),a.useEffect(()=>{if(p)return;const d=l[l.length-1];d?.type==="settings"&&(c(!0),r(`${d.displayName} ${j("changedSettings")}`))},[l,p]),!f)return e.jsxs(u,{className:"flex-column",style:{backgroundColor:"#000",color:"white",minHeight:"100vh"},children:[!!x&&e.jsx(w,{url:x,isVideo:v}),e.jsx(m,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"100vh"},children:e.jsx(m,{container:!0,justifyContent:"center",children:e.jsxs("div",{className:"action-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"2rem",borderRadius:"0.5rem",textAlign:"center",maxWidth:"80%",margin:"0 auto"},children:[e.jsxs(o,{variant:"h2",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",marginBottom:"1rem"},children:["blitzedout.com/",s]}),p?e.jsx(o,{variant:"h4",style:{color:"#90CAF9",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:"Connecting to game..."}):e.jsx(o,{variant:"h4",style:{color:"#A5D6A7",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:"Ready for game to start"})]})})})]});const{displayName:k,type:E,activity:b}=D(f);return e.jsxs(u,{className:"flex-column",style:{backgroundColor:n?"#000":"transparent",color:"white",minHeight:"100vh"},children:[!!x&&e.jsx(w,{url:x,isVideo:v}),e.jsxs(u,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(u,{flex:"1",children:!n&&!S&&e.jsx(B,{variant:"text",onClick:N,style:{color:"white"},children:j("fullscreen")})}),e.jsx(u,{textAlign:"center",flex:"1",children:!!y?.displayName&&e.jsx(o,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:e.jsx(F,{i18nKey:"nextPlayersTurn",values:{player:y.displayName}})})},y?.displayName),e.jsx(u,{flex:"1",textAlign:"right",className:"text-stroke",children:b&&e.jsxs(o,{variant:"h4",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:["blitzedout.com/",s]})})]}),e.jsx(m,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",style:{minHeight:"calc(100vh - 5rem)"},children:e.jsx(m,{container:!0,justifyContent:"center",children:b?e.jsxs(m,{size:12,className:"action-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"2rem",borderRadius:"0.5rem",maxWidth:"80%",margin:"0 auto"},children:[e.jsx(o,{variant:"h3",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:`${E} ${j("for")} ${k}`}),e.jsx(u,{className:"divider",style:{marginTop:"-0.5rem",height:"0.5rem",backgroundColor:"white",border:"2px solid black"},children:e.jsx(L,{})}),e.jsx(o,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600},children:b})]}):e.jsx("div",{className:"action-box",style:{backgroundColor:"rgba(0,0,0,0.7)",padding:"2rem",borderRadius:"0.5rem",maxWidth:"80%",margin:"0 auto"},children:e.jsxs(o,{variant:"h1",style:{color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.8)",fontWeight:600},children:["blitzedout.com/",s]})})})},l.length),e.jsx(I,{open:!!t,close:()=>c(!1),hideCloseButton:!0,children:e.jsx(o,{variant:"h5",style:{color:"white"},children:i})})]})}export{re as default};
