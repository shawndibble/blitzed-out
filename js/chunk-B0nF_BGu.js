var re=Object.defineProperty;var ae=(n,s,t)=>s in n?re(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var X=(n,s,t)=>ae(n,typeof s!="symbol"?s+"":s,t);import{r as p,j as e,z as T,y as R,as as I,M as v,am as S,aA as oe,au as q,aB as U,ak as k,A as J,T as j,aE as M,I as ce,ar as u,at as de,a1 as A,ao as C,aL as ue,aN as he,aM as xe,b7 as je,aR as Q,aS as pe,ad as ge,$ as me,Z as z,Q as W}from"./chunk-DJZJtpVs.js";import{J as be,K as ye,B as fe,b as D,H as L,F as ve}from"./chunk-DEqUmdJg.js";import{l as Se}from"./chunk-DX2sx8ru.js";import{u as ee}from"./chunk-CHjZF5e7.js";import{d as B,i as V,u as we,f as $}from"./chunk-COc20URl.js";import{u as Ce,C as ke}from"./chunk-mGbLcm_X.js";import{d as Te}from"./chunk-7OQk-BoX.js";import{T as Ae}from"./chunk-9fkTg0gS.js";import{a as Le,b as Ke}from"./chunk-Do9O9ZuT.js";function Pe(){const[n,s]=p.useState(!1);return p.useEffect(()=>{const t=window.matchMedia("(pointer: fine)");s(t.matches);const i=l=>{s(l.matches)};return t.addEventListener("change",i),()=>{t.removeEventListener("change",i)}},[]),n}function Ve({actionsFolder:n,settings:s,option:t,onChange:i,initValue:l=0}){const r=`${t}label`,c=n[t]?.label,a=()=>s.selectedActions?.[t]?.level||l,d=Pe(),[o,h]=p.useState(a()),b=m=>{i(m)},y=m=>{h(m)},g=m=>o>0&&m===0?!1:s.difficulty==="accelerated"?o<=2?o===m:o===m||o-1===m:o>=m;function x(m){return Object.keys(n[m]?.actions||{}).map((f,w)=>e.jsxs(v,{value:w,onMouseOver:()=>y(w),children:[!!d&&e.jsx("span",{className:"menu-item-icon",children:g(w)?e.jsx(be,{}):e.jsx(ye,{})}),f]},`${m}-${f}`))}return e.jsxs(T,{margin:"normal",fullWidth:!0,children:[e.jsx(R,{id:r,children:c}),e.jsx(I,{labelId:r,id:t,label:c,value:a(),onChange:b,onOpen:()=>h(a()),onClose:()=>h(a()),children:x(t)})]})}function Re({trueCondition:n,onChange:s,yesLabel:t,noLabel:i=null,sx:l={}}){const r=i??t;return e.jsx(S,{sx:{display:"flex",justifyContent:"center",my:1,...l},children:e.jsx(oe,{control:e.jsx(U,{checked:n||!1,onChange:s}),label:q(n?t:r)})})}function ne({formData:n,setFormData:s,backgrounds:t,isRoom:i=!1}){const{t:l}=k(),r=i?"roomBackground":"background",c=i?"roomBackgroundURL":"backgroundURL",[a,d]=p.useState(n?.[r]||Object.keys(t)[0]),o=()=>Object.entries(t).map(([y,g])=>e.jsx(v,{value:y,children:g},y)),h=y=>{s({...n,[r]:y.target.value}),d(y.target.value)};p.useEffect(()=>{a!==n?.[r]&&d(n?.[r]||"")},[n,a,r]);const b=y=>{const g={...n,[r]:"custom",[c]:y.target.value};i&&(g.roomUpdated=!0),s(g)};return e.jsxs(e.Fragment,{children:[e.jsxs(T,{fullWidth:!0,margin:"normal",children:[e.jsx(R,{id:"background-label",children:l("background")}),e.jsx(I,{labelId:"background-label",id:"background",label:l("background"),value:a||"",onChange:h,children:o()})]}),a==="custom"&&e.jsx(J,{sx:{mt:2},label:l("url"),value:n?.[c]||"",fullWidth:!0,onChange:b,helperText:e.jsxs(e.Fragment,{children:[l("supportedSites"),e.jsx("br",{}),l("requiresEmbeddedUrl")]})})]})}class Ie{constructor(){X(this,"voiceLoadPromise")}async waitForVoices(){return this.voiceLoadPromise?this.voiceLoadPromise:(this.voiceLoadPromise=new Promise(s=>{let t=window.speechSynthesis.getVoices();if(t.length>0){s(t);return}const i=()=>{t=window.speechSynthesis.getVoices(),t.length>0&&(window.speechSynthesis.removeEventListener("voiceschanged",i),s(t))};window.speechSynthesis.addEventListener("voiceschanged",i),setTimeout(()=>{window.speechSynthesis.removeEventListener("voiceschanged",i),s(window.speechSynthesis.getVoices())},3e3)}),this.voiceLoadPromise)}async getAvailableVoicesAsync(){return(await this.waitForVoices()).map(t=>({name:t.name,displayName:`${t.name} (${t.lang})`}))}async getPreferredVoiceAsync(){const s=await this.getAvailableVoicesAsync();return s.length>0?s[0].name:null}async speak(s,t,i=0){return new Promise((l,r)=>{if(!("speechSynthesis"in window)){r(new Error("Speech synthesis not supported"));return}const c=new SpeechSynthesisUtterance(s);if(c.pitch=i,t){const d=window.speechSynthesis.getVoices().find(o=>o.name===t);d&&(c.voice=d)}c.onend=()=>l(),c.onerror=a=>r(new Error(`Speech failed: ${a.error}`)),window.speechSynthesis.speak(c)})}stop(){window.speechSynthesis?.speaking&&window.speechSynthesis.cancel()}isAvailable(){return"speechSynthesis"in window}}const E=new Ie,Me=()=>{const[n,s]=p.useState(!1),[t,i]=p.useState(!1),[l,r]=p.useState(null),c=p.useCallback(()=>{E.stop(),s(!1),i(!1)},[]),a=p.useCallback(async(d,o={})=>{try{i(!0),r(null),c(),s(!0),await E.speak(d,o.voice,o.pitch),i(!1),s(!1)}catch(h){const b=h instanceof Error?h.message:"TTS failed";r(b),s(!1),i(!1),console.error("TTS Error:",h)}},[c]);return p.useEffect(()=>()=>{c()},[c]),{speak:a,stop:c,isPlaying:n,error:l,isLoading:t}};function Oe({formData:n,setFormData:s,onVoiceChange:t}){const{t:i}=k(),[l,r]=p.useState([]),[c,a]=p.useState(!0),{speak:d}=Me(),o=n.voicePreference||"",h=p.useCallback(x=>{const m={...n,voicePreference:x};s(m),t?.(x)},[n,s,t]);p.useEffect(()=>{let x=!0;return(async()=>{try{if(x){a(!0);const f=await E.getAvailableVoicesAsync();if(x){if(r(f),!o&&f.length>0){const w=await E.getPreferredVoiceAsync();w&&x&&h(w)}a(!1)}}}catch(f){console.error("Failed to load voices:",f),x&&a(!1)}})(),()=>{x=!1}},[o,h]);const b=x=>{h(x.target.value)},y=async()=>{const x=o||(l.length>0?l[0].name:"");if(!x)return;const m=i("tts.sampleText","Take a drink and enjoy the game.");try{await d(m,{voice:x,pitch:-2})}catch(f){console.error("Failed to play sample:",f)}},g=x=>x.displayName;return c?e.jsx(S,{sx:{py:1},children:e.jsx(j,{variant:"body2",color:"text.secondary",children:i("loadingVoices","Loading voices...")})}):l.length===0?e.jsx(S,{sx:{py:1},children:e.jsx(j,{variant:"body2",color:"text.secondary",children:i("noVoicesAvailable","No voices available for this language")})}):e.jsxs(S,{sx:{display:"flex",alignItems:"center",gap:1,py:1},children:[e.jsxs(T,{fullWidth:!0,size:"small",children:[e.jsx(R,{id:"voice-select-label",children:i("voiceSelection","Voice")}),e.jsx(I,{labelId:"voice-select-label",value:o,label:i("voiceSelection","Voice"),onChange:b,children:l.map(x=>e.jsx(v,{value:x.name,children:g(x)},x.name))})]}),e.jsx(M,{title:i("playSample","Play sample"),children:e.jsx(ce,{onClick:y,color:"primary",disabled:!o,size:"small",children:e.jsx(fe,{})})})]})}function Be({boardUpdated:n}){const{i18n:s}=k(),[t,i]=p.useState(s.resolvedLanguage||"en"),[l,r]=p.useState(!1);async function c(d){r(!0),i(d);try{await s.changeLanguage(d),n()}catch(o){console.error("Error changing language:",o),await s.changeLanguage(d),n()}finally{r(!1)}}const a=Object.entries(Se).map(([d,o])=>e.jsx(v,{value:d,children:o.label},d));return e.jsx(S,{sx:{minWidth:120,mt:1,mb:2},children:e.jsxs(T,{fullWidth:!0,children:[e.jsxs(R,{id:"language-label",sx:{display:"flex",alignItems:"center"},children:[e.jsx(D,{sx:{mr:1}}),e.jsx(u,{i18nKey:"language"})]}),e.jsx(I,{labelId:"language-label",id:"language-select",value:t,disabled:l,label:e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsx(u,{i18nKey:"language"})]}),onChange:d=>c(d.target.value),endAdornment:l&&e.jsx(de,{size:20}),MenuProps:{disableScrollLock:!0,BackdropProps:{invisible:!0},PaperProps:{style:{backdropFilter:"none",WebkitBackdropFilter:"none"}}},children:a})]})})}function P({field:n,formData:s,handleSwitch:t}){return e.jsx(Re,{trueCondition:s[n],onChange:i=>t(i,n),yesLabel:n,sx:{justifyContent:"left"}})}function Ee({formData:n,setFormData:s,boardUpdated:t}){const[i,l]=ee(),{t:r}=k(),c={color:r("color"),gray:r("gray"),"metronome.gif":r("hypnoDick"),"pink-spiral.gif":r("pinkSpiral"),custom:r("customURL")};function a(o,h){s({...n,[h]:o.target.checked}),l({...i,[h]:o.target.checked})}function d(o){l({...i,voicePreference:o})}return e.jsxs(e.Fragment,{children:[e.jsx(Be,{boardUpdated:t}),e.jsx(j,{variant:"h5",children:e.jsx(u,{i18nKey:"dialog"})}),e.jsx(P,{field:"playerDialog",formData:n,handleSwitch:a}),e.jsx(P,{field:"othersDialog",formData:n,handleSwitch:a}),e.jsx(A,{}),e.jsx(j,{variant:"h5",sx:{mt:2},children:e.jsx(u,{i18nKey:"sounds"})}),e.jsx(P,{field:"mySound",formData:n,handleSwitch:a}),e.jsx(P,{field:"otherSound",formData:n,handleSwitch:a}),e.jsx(P,{field:"chatSound",formData:n,handleSwitch:a}),e.jsx(P,{field:"readRoll",formData:n,handleSwitch:a}),n.readRoll&&e.jsx(Oe,{formData:n,setFormData:s,onVoiceChange:d}),e.jsx(A,{}),e.jsx(j,{variant:"h5",sx:{mt:2,textTransform:"capitalize"},children:e.jsx(u,{i18nKey:"misc"})}),e.jsx(P,{field:"hideBoardActions",formData:n,handleSwitch:a}),e.jsx(P,{field:"advancedSettings",formData:n,handleSwitch:a}),e.jsx(ne,{formData:n,setFormData:s,backgrounds:c}),e.jsx(A,{})]})}function F({children:n}){return e.jsx(C,{size:{xs:12,md:5},children:n})}const H=p.forwardRef(({value:n,onChange:s,label:t,options:i,defaultValue:l=null,sx:r,helpIcon:c=!1,fullWidth:a=!0,...d},o)=>{const h=p.useMemo(()=>i.map(b=>typeof b=="string"?e.jsx(v,{value:b,children:q(b)},b):e.jsx(v,{value:b.value,children:b.label},b.value)),[i]);return e.jsxs(T,{fullWidth:a,margin:"normal",sx:r,...d,ref:o,children:[e.jsxs(R,{id:`${t}Label`,children:[e.jsx(u,{i18nKey:t}),!!c&&e.jsx(L,{sx:{ml:1,fontSize:16}})]}),e.jsx(I,{labelId:`${t}Label`,id:t,label:e.jsxs(e.Fragment,{children:[e.jsx(u,{i18nKey:t}),!!c&&e.jsx(L,{sx:{ml:1,fontSize:16}})]}),value:n||l||"",onChange:s,children:h})]})});function G({children:n,title:s,subtitle:t,defaultExpanded:i=!1,...l}){return e.jsxs(ue,{defaultExpanded:i,...l,sx:{backgroundColor:"inherit",backgroundImage:"none",boxShadow:"none"},children:[e.jsxs(he,{expandIcon:e.jsx(ve,{}),sx:{px:0},children:[e.jsxs(j,{variant:"h6",sx:{width:"33%"},children:[s,":"]}),e.jsx(j,{sx:{pt:.5},children:t})]}),e.jsx(xe,{sx:{px:0},children:e.jsx(C,{container:!0,columnSpacing:2,justifyContent:"space-evenly",className:"columned-grid",children:n})})]})}function Ue({formData:n,setFormData:s}){const t=(l,r)=>{s({...n,finishRange:r,boardUpdated:!0})},i=n?.finishRange||[30,70];return e.jsxs(S,{children:[e.jsx(A,{}),e.jsx(j,{id:"finish-slider",sx:{my:1},children:e.jsx(u,{i18nKey:"finishSlider"})}),e.jsx(je,{"aria-labelledby":"finish-slider",value:i,onChange:t,valueLabelDisplay:"off"}),e.jsxs(S,{display:"flex",flexDirection:"column",justifyContent:"space-between",textAlign:"center",children:[e.jsxs(j,{whiteSpace:"nowrap",children:[e.jsx(u,{i18nKey:"noCum"})," ",i[0],"%"]}),e.jsxs(j,{whiteSpace:"nowrap",children:[e.jsx(u,{i18nKey:"ruined"})," ",i[1]-i[0],"%"]}),e.jsxs(j,{whiteSpace:"nowrap",children:[e.jsx(u,{i18nKey:"cum"})," ",100-i[1],"%"]})]}),e.jsx(A,{sx:{my:1}})]})}function Ne({option:n,settings:s,setSettings:t,actionsFolder:i,type:l,showVariation:r=!1,showRole:c=!1}){const{t:a}=k(),d=`${n}label`,o=i[n]?.label;function h(g,x,m){const f=s.selectedActions?.[x];t({...s,selectedActions:{...s.selectedActions,[x]:{...f,type:l,level:f?.level??0,[m]:g?.target?.value}},boardUpdated:!0})}let b=12;(r||c)&&(b=6);let y=["dom","vers","sub"];return i[n]?.dom&&(y=[{label:i[n].dom,value:"dom"},{label:a("vers"),value:"vers"},{label:i[n].sub,value:"sub"}]),e.jsxs(C,{container:!0,justifyContent:"center",children:[e.jsx(C,{size:b,children:e.jsx(Ve,{actionsFolder:i,settings:s,option:n,onChange:g=>h(g,n,"level")})}),!!c&&e.jsx(C,{size:6,children:e.jsx(H,{sx:{ml:1},value:s.selectedActions?.[n]?.role,onChange:g=>h(g,n,"role"),label:`${a("role")}: ${o}`,options:y,defaultValue:s.role||"sub"})}),!!r&&e.jsx(C,{size:6,children:e.jsx(M,{placement:"top",title:e.jsxs(u,{i18nKey:"variationTooltip",children:[e.jsx(j,{variant:"subtitle2",children:"Standalone = Its own tile. "}),e.jsx(j,{variant:"subtitle2",children:"Append Some = 50% chance."}),e.jsx(j,{variant:"subtitle2",children:"Append Most = 90% chance."})]}),arrow:!0,children:e.jsxs(T,{fullWidth:!0,margin:"normal",sx:{ml:1},children:[e.jsxs(R,{id:`${d}Variation`,children:[`${o} ${a("variation")}`,e.jsx(L,{sx:{ml:1,fontSize:16}})]}),e.jsxs(I,{labelId:`${d}Variation`,id:`${n}Variation`,label:e.jsxs(e.Fragment,{children:[o," ",a("variation"),e.jsx(L,{sx:{ml:1,fontSize:16}})]}),value:s.selectedActions?.[n]?.variation||"standalone",onChange:g=>h(g,n,"variation"),children:[e.jsx(v,{value:"standalone",children:e.jsx(u,{i18nKey:"standalone"})}),e.jsx(v,{value:"appendSome",children:e.jsx(u,{i18nKey:"appendSome"})}),e.jsx(v,{value:"appendMost",children:e.jsx(u,{i18nKey:"appendMost"})})]})]})})})]},n)}function ze({formData:n,setFormData:s}){return e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{mt:1},children:[e.jsx(j,{children:e.jsx(u,{i18nKey:"solo"})}),e.jsx(M,{title:e.jsx(j,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"soloTooltip"})}),arrow:!0,children:e.jsx(L,{sx:{fontSize:15}})}),e.jsx(U,{id:"gameMode",checked:!B(n.gameMode),onChange:t=>s({...n,gameMode:t.target.checked?"local":"online",boardUpdated:!0}),inputProps:{"aria-label":"Game Type"}}),e.jsx(j,{children:e.jsx(u,{i18nKey:"local"})}),e.jsx(M,{title:e.jsx(j,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"localTooltip"})}),arrow:!0,children:e.jsx(L,{sx:{fontSize:15}})})]})}function We({formData:n}){const[s,t]=p.useState(!1);return p.useEffect(()=>{const i=Object.values(n).filter(r=>typeof r=="object"&&r?.type==="consumption"&&r?.level>0).length,l=Object.values(n).filter(r=>typeof r=="object"&&r?.level>0).length;t(i>1&&i>=l-i)},[n]),s?e.jsx(pe,{severity:"warning",children:e.jsx(u,{i18nKey:"consumptionWarning"})}):null}function $e({formData:n,setFormData:s,actionsList:t}){const{t:i}=k(),l=!V(n?.room)&&!B(n.gameMode);function r(a,d={}){return Object.keys(t).filter(o=>t[o]?.type===a).map(o=>e.jsx(F,{children:e.jsx(Ne,{option:o,settings:n,setSettings:s,actionsFolder:t,type:a,...d})},o))}const c=a=>{const d=JSON.parse(JSON.stringify(n));return Object.keys(d).forEach(o=>{d.role=a,o.includes("role")&&(d[o]=a)}),d};return e.jsxs(e.Fragment,{children:[e.jsx(ze,{formData:n,setFormData:s}),V(n?.room)&&!B(n.gameMode)&&e.jsx(C,{container:!0,alignContent:"center",justifyContent:"space-evenly",children:e.jsx(C,{sx:{py:3},children:e.jsx(j,{variant:"h5",children:e.jsx(u,{i18nKey:"privateRequired"})})})}),e.jsxs(C,{container:!0,columnSpacing:2,justifyContent:"space-evenly",children:[e.jsx(F,{children:e.jsx(M,{placement:"top",title:e.jsx(u,{i18nKey:"difficultyTooltip",children:e.jsxs(j,{variant:"body2",children:["Normal = Slow ramp up. ",e.jsx("br",{}),e.jsx("br",{}),"Accelerated = Straight to max level + the level prior to it."]})}),arrow:!0,children:e.jsx(H,{value:n.difficulty,onChange:a=>s({...n,difficulty:a.target.value,boardUpdated:!0}),label:"difficulty",options:["normal","accelerated"],defaultValue:"normal",helpIcon:!0})})}),l&&e.jsx(F,{children:e.jsx(H,{value:n.role,onChange:a=>s({...c(a.target.value),boardUpdated:!0}),label:"mainRole",options:["dom","vers","sub"],defaultValue:"sub"})})]}),l?e.jsxs(e.Fragment,{children:[e.jsx(G,{title:i("consumption"),subtitle:i("consumptionSubtitle"),children:r("consumption",{showVariation:!0})}),e.jsx(G,{title:i("foreplay"),subtitle:i("foreplaySubtitle"),children:r("foreplay",{showRole:l})}),e.jsx(G,{title:i("sex"),subtitle:i("sexSubtitle"),children:r("sex",{showRole:l})})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{container:!0,columnSpacing:2,justifyContent:"space-evenly",children:r("consumption",{showVariation:!0})}),e.jsx(A,{}),e.jsx(C,{container:!0,columnSpacing:2,justifyContent:"center",children:r("solo")})]}),e.jsx(Ue,{setFormData:s,formData:n}),e.jsx(We,{formData:n})]})}function Fe({formData:n,setFormData:s}){const{t}=k(),i={"1d4":2.5,"1d6":3.5,"2d4":5},l=n?.roomTileCount?Math.floor(n.roomTileCount/i[n.roomDice||"1d6"]):16,r=Array.from({length:7},(c,a)=>(a+2)*10).map(c=>e.jsx(v,{value:c,children:c},c));return e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx(u,{i18nKey:"gameSpeed"})}),e.jsxs(S,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(T,{sx:{m:1},fullWidth:!0,children:[e.jsx(R,{id:"diceRole-label",children:e.jsx(u,{i18nKey:"roomDice"})}),e.jsxs(I,{labelId:"diceRole-label",id:"diceRole-select",value:n?.roomDice||"1d4",label:t("roomDice"),onChange:c=>s({...n,roomDice:c.target.value,roomUpdated:!0}),children:[e.jsx(v,{value:"1d4",children:"1d4"}),e.jsx(v,{value:"1d6",children:"1d6"}),e.jsx(v,{value:"2d4",children:"2d4"})]})]}),e.jsxs(T,{sx:{m:1},fullWidth:!0,children:[e.jsx(R,{id:"tile-count-label",children:e.jsx(u,{i18nKey:"roomTileCount"})}),e.jsx(I,{labelId:"tile-count-label",id:"tile-count-select",value:String(n?.roomTileCount||40),label:t("roomTileCount"),onChange:c=>s({...n,roomTileCount:Number(c.target.value),roomUpdated:!0}),children:r})]}),e.jsx(T,{fullWidth:!0,children:e.jsxs(j,{children:[e.jsx(u,{i18nKey:"averageRolls"}),l]})})]})]})}function Ge({formData:n,setFormData:s}){const t=p.useCallback(()=>{s({...n,roomRealtime:!n.roomRealtime,roomUpdated:!0})},[n,s]);return e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx(u,{i18nKey:"playerListOptions"})}),e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{width:"100%"},children:[e.jsx(j,{children:e.jsx(u,{i18nKey:"realtime"})}),e.jsx(M,{title:e.jsx(j,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"realtimeTooltip"})}),arrow:!0,children:e.jsx(L,{sx:{fontSize:15}})}),e.jsx(U,{id:"showPrivate",checked:!!n.roomRealtime,onChange:t,inputProps:{"aria-label":q("playerList")}}),e.jsx(j,{children:e.jsx(u,{i18nKey:"delayed"})}),e.jsx(M,{title:e.jsx(j,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"delayedTooltip"})}),arrow:!0,children:e.jsx(L,{sx:{fontSize:15}})})]})]})}function _e({formData:n,setFormData:s}){const{id:t}=ge(),{t:i}=k(),l=o=>{let h;o.target.checked&&V(t)?h=Te("123456789ABCDEFGHJKLMNPQRSTUVWXYZ",5)():t&&o.target.checked&&!V(t)?h=t:h="PUBLIC",s({...n,room:h.toUpperCase(),gameMode:V(h)?"online":n.gameMode})},r=p.useCallback(o=>{s({...n,room:o.currentTarget.value,boardUpdated:!0})},[n,s]),c=p.useCallback(o=>{o.key==="Enter"&&s({...n,room:o.currentTarget.value,boardUpdated:!0})},[n,s]),a=p.useCallback(o=>{const h=o.target.value.toUpperCase();o.target.value=h},[]),d=!V(n.room);return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{width:"100%"},children:[e.jsx(j,{children:e.jsx(u,{i18nKey:"public"})}),e.jsx(U,{id:"showPrivate",checked:d,onChange:l,slotProps:{input:{"aria-label":i("room")}}}),e.jsx(j,{children:e.jsx(u,{i18nKey:"private"})}),e.jsx(M,{title:e.jsx(j,{variant:"subtitle2",children:e.jsx(u,{i18nKey:"privateOptions"})}),arrow:!0,children:e.jsx(L,{sx:{fontSize:15}})})]}),d&&e.jsx(J,{fullWidth:!0,id:"privateRoom",label:i("privateRoom"),defaultValue:n.room?.toUpperCase(),margin:"normal",onBlur:r,onKeyDown:c,onChange:a,inputProps:{style:{textTransform:"uppercase"}}})]})}function He({formData:n,setFormData:s}){const{t}=k(),i={app:t("appBackground"),custom:t("customURL")};return e.jsxs(S,{sx:{margin:"0.5rem"},children:[e.jsx(_e,{formData:n,setFormData:s}),!V(n.room)&&e.jsxs(e.Fragment,{children:[e.jsx(A,{sx:{my:1}}),e.jsx(Fe,{formData:n,setFormData:s}),e.jsx(A,{sx:{my:1}}),e.jsx(Ge,{formData:n,setFormData:s}),e.jsx(A,{sx:{my:1}}),e.jsx(ne,{formData:n,setFormData:s,backgrounds:i,isRoom:!0})]})]})}function _({children:n,value:s,index:t,style:i,...l}){return e.jsx("div",{role:"tabpanel",hidden:s!==t,id:`simple-tabpanel-${t}`,"aria-labelledby":`simple-tab-${t}`,...l,children:s===t&&e.jsx(S,{sx:{p:3,...i},children:n})})}function qe(n){return Object.values(n).some(({level:s})=>s>0)}function Je(n,s){const t=n.selectedActions||{};return Object.entries(t).reduce((i,[l,r])=>(l in s&&(r?.variation?.startsWith("append")?i.withAppend[l]=r:i.withoutAppend[l]=r),i),{withAppend:{},withoutAppend:{}})}function Qe(n){return Object.keys(n).length>0&&Object.values(n).some(({level:s})=>s>0)}function Ye(n,s){const{withAppend:t,withoutAppend:i}=Je(n,s);return qe(i)?V(n.room)&&!B(n.gameMode)?"privateRequired":null:Qe(t)?"appendWithAction":"pickSomething"}function Ze({closeDialog:n,initialTab:s=0,onOpenSetupWizard:t}){const{user:i}=we(),{t:l}=k(),[r,c]=ee(),[a,d]=p.useState(s),[o,h]=p.useState(null),[b,y]=p.useState(!1),[g,x]=Ce(),m=Le(),{isLoading:f,actionsList:w}=Ke(g?.gameMode),se=(K,O)=>{d(O)},Y=()=>c({...r,boardUpdated:!0}),N=p.useCallback(async K=>{K.preventDefault();const{displayName:O,...le}=g,Z=Ye(le,w);return Z?(h(l(Z)),null):(await m(g,w),typeof n=="function"&&n(),null)},[g,w,l,h,m,n]),te=p.useCallback(K=>{x(O=>({...O,displayName:K.target.value}))},[x]),ie=p.useCallback(K=>{K.key==="Enter"&&(x(O=>({...O,displayName:K.target.value})),N(K))},[N,x]);return!g.room||f?e.jsxs(S,{children:[e.jsxs(j,{variant:"h2",children:[e.jsx(u,{i18nKey:"loading"}),"..."]}),e.jsx(j,{variant:"body1",children:e.jsx(u,{i18nKey:"clearStorage"})})]}):e.jsxs(S,{component:"form",method:"post",onSubmit:N,className:"settings-box",children:[e.jsx(J,{fullWidth:!0,id:"displayName",label:l("displayName"),defaultValue:i?.displayName||g.displayName||"",required:!0,autoFocus:!0,onBlur:te,onKeyDown:ie,margin:"normal"}),e.jsx(S,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(me,{value:a,onChange:se,"aria-label":l("gameSettings"),centered:!0,children:[e.jsx(z,{label:l("gameboard"),...$(0)}),e.jsx(z,{label:l("room"),...$(1)}),e.jsx(z,{label:l("application"),...$(2)})]})}),e.jsx(_,{value:a,index:0,style:{p:0},children:e.jsx($e,{formData:g,setFormData:x,actionsList:w})}),e.jsx(_,{value:a,index:1,style:{p:0,pt:1},children:e.jsx(He,{formData:g,setFormData:x})}),e.jsx(_,{value:a,index:2,style:{p:0,pt:1},children:e.jsx(Ee,{formData:g,setFormData:x,boardUpdated:Y})}),e.jsxs("div",{className:"flex-buttons",children:[e.jsxs("div",{className:"left-buttons",children:[t&&e.jsx(W,{variant:"outlined",type:"button",onClick:t,children:e.jsx(u,{i18nKey:"setupWizard"})}),a===0&&e.jsx(W,{variant:"outlined",type:"button",onClick:()=>y(!0),children:e.jsx(u,{i18nKey:"customTilesLabel",children:"Game Tiles"})})]}),e.jsx(W,{variant:"contained",type:"submit",children:e.jsx(u,{i18nKey:"update"})})]}),b&&e.jsx(ke,{open:b,setOpen:y,boardUpdated:Y,actionsList:w}),e.jsx(Ae,{open:!!o,close:()=>h(null),children:o})]})}const cn=Object.freeze(Object.defineProperty({__proto__:null,default:Ze},Symbol.toStringTag,{value:"Module"}));export{Ze as G,Ve as I,_ as T,Re as Y,cn as i,E as t};
