import{j as e,am as y,ak as K,ap as z,aq as M,aR as A,T as p,ar as x,U as T,ad as q,r as g,A as ae,Q as P,G as le,aS as N,ao as w,aE as ce,z as de,y as ue,as as pe,M as xe,b1 as he,aH as me,b2 as ge,au as Q,at as $,aL as G,aN as U,aM as V,a1 as _,E as be,K as ye,b3 as je,b4 as Se,b5 as fe,al as ve,W as Ce,ay as ke,Y as Pe}from"./chunk-B8izEdPk.js";import{u as we,C as Ae}from"./chunk-Dj6Jqs8e.js";import{y as Ie,z as Re,H as ze,B as Me,F as H,T as Te}from"./chunk-BwSveqi_.js";import{i as R,d as L}from"./chunk-DEA6y773.js";import{d as Ke}from"./chunk-B5PHAmSG.js";import{z as Be,A as Le,I as Oe}from"./chunk-B4ipE-Yx.js";import{L as We,I as X,Y as Ee,G as Ne}from"./chunk-CNMvD_G4.js";import{u as Ge}from"./chunk-HelPtATz.js";import{c as Y,a as Ue,b as Ve}from"./chunk-CwLnOYyf.js";import{u as He}from"./chunk-mSU1QIJf.js";import"../assets/index-DHZ0xqMM.js";import"./schedule.tsx-DSYAXEVL.js";import"./chunk-Bg66iSD7.js";import"./chunk-6VL6qIn1.js";import"./theme.tsx-DMXKS2rg.js";import"./chunk-Sx7sZXMQ.js";import"./chunk-BWRJAup5.js";import"./chunk-BoRVzNTi.js";import"./chunk-B4PEA_xj.js";import"./chunk-yLOK5aTh.js";import"./chunk-DV4CcANF.js";import"./chunk-Cb29ud5S.js";import"./chunk-DrFU2H2m.js";function W({children:n,justifyContent:i="space-evenly"}){return e.jsx(y,{sx:{mt:3,display:"flex",flexDirection:"row",justifyContent:i,alignItems:"center"},children:n})}function F({isPublic:n,onClick:i,isSelected:o}){const{t:r}=K();return e.jsx(z,{sx:{cursor:"pointer",border:o?"3px solid":"1px solid",borderColor:o?"primary.main":"grey.300",backgroundColor:o?"primary.50":"background.paper",transform:o?"scale(1.02)":"scale(1)",transition:"all 0.2s ease-in-out","&:hover":{borderColor:"primary.main",boxShadow:o?4:2,transform:"scale(1.02)"}},onClick:i,children:e.jsx(M,{sx:{p:3},children:e.jsxs(A,{direction:"row",spacing:3,alignItems:"center",children:[e.jsx(y,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:56,height:56,borderRadius:"50%",backgroundColor:o?"primary.main":"primary.50",color:o?"primary.contrastText":"primary.main",transition:"all 0.2s ease-in-out"},children:n?e.jsx(Ie,{sx:{fontSize:28},"aria-label":"Public"}):e.jsx(Re,{sx:{fontSize:28},"aria-label":"Private"})}),e.jsxs(A,{spacing:.5,flex:1,children:[e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(p,{variant:"h6",component:"h3",sx:{fontWeight:600},children:e.jsx(x,{i18nKey:n?"public":"private"})}),o&&e.jsx(T,{label:r("selected"),size:"small",color:"primary",sx:{fontSize:"0.75rem",fontWeight:500,height:20}})]}),e.jsx(p,{variant:"body1",color:"text.secondary",sx:{fontSize:"0.95rem"},children:e.jsx(x,{i18nKey:n?"publicRoomBenefit":"privateRoomBenefit"})})]})]})})})}function Ye({formData:n,setFormData:i,nextStep:o}){const{t:r}=K(),{id:s}=q(),[t,d]=g.useState(!R(n.room||s)),[l,m]=g.useState(n.room?.toUpperCase()||"");g.useEffect(()=>{const C=n.room||s,I=!R(C);d(I),m(C?.toUpperCase()||"")},[s,n.room,t]);const u=async C=>{try{const I=Be(),j=Le(I,`rooms/${C}/uids`);return(await Oe(j)).exists()}catch{return!1}},c=g.useCallback(async()=>{const C=Ke("123456789ABCDEFGHJKLMNPQRSTUVWXYZ",5);let I,j=0;const v=10;do if(I=C(),j++,j>=v)break;while(await u(I));return I},[]),a=g.useCallback(()=>{i({...n,room:"PUBLIC",gameMode:"online",roomRealtime:!0}),d(!1)},[n,i]),h=g.useCallback(async()=>{const C=await c();i({...n,room:C,gameMode:"online",roomRealtime:!1}),m(C.toUpperCase()),d(!0)},[n,i,c]),k=g.useCallback(C=>{i({...n,room:C,boardUpdated:!0})},[n,i]),S=g.useCallback(C=>{const I=C.target.value.toUpperCase();m(I)},[]),b=g.useCallback(()=>{k(l)},[k,l]),f=g.useCallback(C=>{C.key==="Enter"&&k(l)},[k,l]),B=R(n.room||s);function O(){o(B?3:1)}return e.jsxs(y,{sx:{m:1},children:[e.jsx(p,{variant:"h5",gutterBottom:!0,textAlign:"center",children:e.jsx(x,{i18nKey:"chooseRoomType"})}),e.jsx(p,{variant:"body1",color:"text.secondary",textAlign:"center",sx:{mb:3},children:e.jsx(x,{i18nKey:"roomTypeDescription"})}),e.jsxs(A,{spacing:2,sx:{mb:3},children:[e.jsx(F,{isPublic:!0,onClick:a,isSelected:B}),e.jsx(F,{isPublic:!1,onClick:h,isSelected:!B})]}),t&&e.jsxs(y,{sx:{p:3,borderRadius:2,backgroundColor:"primary.50",mb:2},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:r("privateRoomCode")}),e.jsx(ae,{fullWidth:!0,id:"privateRoom",value:l,onBlur:b,onKeyDown:f,onChange:S,inputProps:{style:{textTransform:"uppercase",fontFamily:"monospace",fontSize:"1.25rem",fontWeight:"bold",textAlign:"center",letterSpacing:"0.2em"}},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper","& fieldset":{borderColor:"divider",borderWidth:2},"&:hover fieldset":{borderColor:"primary.main"},"&.Mui-focused fieldset":{borderColor:"primary.main",borderWidth:2}}}}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mt:1.5,textAlign:"center"},children:r("privateRoomCodeHelp")})]}),e.jsx(W,{children:e.jsx(P,{variant:"contained",onClick:O,size:"large",children:e.jsx(x,{i18nKey:"next"})})})]})}function Fe({formData:n,setFormData:i,nextStep:o,prevStep:r}){const{t:s}=K(),{hasLocalPlayers:t,clearLocalSession:d}=Ge(),[l,m]=g.useState(!1),[u,c]=g.useState(null),a=n.room!=="PUBLIC",h=g.useCallback(()=>{m(!0),c(null)},[]),k=g.useCallback(()=>{t&&d(),i(f=>({...f,hasLocalPlayers:!1,localPlayersData:void 0,localPlayerSessionSettings:void 0,gameMode:f.gameMode==="local"?"online":f.gameMode})),o()},[t,d,o,i]),S=g.useCallback(async(f,B)=>{try{i({...n,localPlayersData:f,localPlayerSessionSettings:B,hasLocalPlayers:!0}),m(!1),o()}catch(O){c(O instanceof Error?O.message:"Failed to save local player configuration")}},[n,i,o]),b=g.useCallback(()=>{m(!1),c(null)},[]);return g.useEffect(()=>{if(!a){const f=setTimeout(()=>{o()},100);return()=>clearTimeout(f)}},[a,o]),a?l?e.jsx(le,{in:!0,children:e.jsxs(y,{children:[u&&e.jsx(N,{severity:"error",sx:{mb:2},children:u}),e.jsx(We,{roomId:n.room||"PRIVATE",isPrivateRoom:a,onComplete:S,onCancel:b,initialPlayers:n.localPlayersData,initialSettings:n.localPlayerSessionSettings})]})}):e.jsxs(y,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(x,{i18nKey:"localPlayersStep.title"})}),e.jsx(p,{variant:"body1",color:"text.secondary",sx:{mb:3},children:e.jsx(x,{i18nKey:"localPlayersStep.subtitle"})}),e.jsxs(w,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(z,{sx:{cursor:"pointer",border:"1px solid",borderColor:"divider",backgroundColor:"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:h,children:e.jsx(M,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:e.jsx(x,{i18nKey:"localPlayersStep.setupOption.title"})}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-line",textAlign:"left",width:"100%",lineHeight:1.8,mb:2},children:e.jsx(x,{i18nKey:"localPlayersStep.setupOption.description"})}),e.jsx(P,{variant:"outlined",fullWidth:!0,size:"large",sx:{mt:2},"data-testid":"localPlayersStep.setupOption.button",onClick:h,children:s("localPlayersStep.setupOption.button")})]})})})}),e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(z,{sx:{cursor:"pointer",border:"1px solid",borderColor:"divider",backgroundColor:"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:k,children:e.jsx(M,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:e.jsx(x,{i18nKey:"localPlayersStep.skipOption.title"})}),e.jsx(p,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-line",textAlign:"left",width:"100%",lineHeight:1.8,mb:2},children:e.jsx(x,{i18nKey:"localPlayersStep.skipOption.description"})}),e.jsx(P,{variant:"outlined",fullWidth:!0,size:"large",sx:{mt:2},"data-testid":"localPlayersStep.skipOption.button",onClick:k,children:s("localPlayersStep.skipOption.button")})]})})})})]}),t&&e.jsx(N,{severity:"info",sx:{mb:3},children:e.jsx(p,{variant:"body2",children:e.jsx(x,{i18nKey:"localPlayersStep.currentStatus.hasPlayers"})})}),e.jsx(y,{sx:{flexGrow:1}}),e.jsxs(W,{children:[e.jsx(P,{onClick:r,children:e.jsx(x,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",onClick:k,children:e.jsx(x,{i18nKey:"skip"})})]})]}):e.jsx(y,{sx:{minHeight:"200px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:e.jsx(p,{variant:"h6",color:"text.secondary",children:s("localPlayersStep.publicRoomMessage","Local players are not available for public rooms. Continuing...")})})}function qe({formData:n,setFormData:i,nextStep:o,prevStep:r}){const{t:s}=K(),t=!!n.hasLocalPlayers;g.useEffect(()=>{t&&i(a=>({...a,gameMode:"local",roomRealtime:!1}))},[t,i]);const[d,l]=g.useState(!L(n?.gameMode)&&!t);g.useEffect(()=>{l(!L(n?.gameMode)&&!t)},[n?.gameMode,t]);const m=[{id:"local",title:"yesInteracting",description:s("physicalInteractionDesc"),isSelected:!L(n?.gameMode)},{id:"online",title:"noInteracting",description:s("soloOnlinePlayDesc"),isSelected:L(n?.gameMode)}],u=[{value:"dom",label:"Dominant",description:s("dominantRoleDesc")},{value:"vers",label:"Switch",description:s("switchRoleDesc")},{value:"sub",label:"Submissive",description:s("submissiveRoleDesc")}],c=[{id:"clothed",title:"noNaked",description:s("foreplayClothedDesc"),isSelected:!n.isNaked},{id:"naked",title:"yesNaked",description:s("intimateNudityDesc"),isSelected:n.isNaked}];return e.jsxs(y,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[!t&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(x,{i18nKey:"playingWithPeople"})}),e.jsx(w,{container:!0,spacing:2,sx:{mb:3},children:m.map(a=>e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(z,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:a.isSelected?"3px solid":"1px solid",borderColor:a.isSelected?"primary.main":"divider",backgroundColor:a.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>i({...n,gameMode:a.id==="local"?"local":"online",roomRealtime:a.id!=="local"}),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),i({...n,gameMode:a.id==="local"?"local":"online",roomRealtime:a.id!=="local"}))},children:e.jsx(M,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:s(a.title)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:a.description}),a.isSelected&&e.jsx(T,{label:s("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},a.id))})]}),t&&e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(x,{i18nKey:"gameModeSelection"})}),d&&e.jsxs(y,{sx:{mb:3},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:e.jsx(x,{i18nKey:"yourRole"})}),e.jsx(w,{container:!0,spacing:2,sx:{mb:3},children:u.map(a=>e.jsx(w,{size:{xs:12,sm:4},children:e.jsx(z,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:n.role===a.value?"2px solid":"1px solid",borderColor:n.role===a.value?"primary.main":"divider",backgroundColor:n.role===a.value?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>i({...n,role:a.value}),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),i({...n,role:a.value}))},children:e.jsx(M,{sx:{p:2.5},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"subtitle1",sx:{fontWeight:600},children:s(a.value)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:a.description}),n.role===a.value&&e.jsx(T,{label:s("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},a.value))})]}),!L(n?.gameMode)&&e.jsxs(y,{sx:{mb:3},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:2},children:e.jsx(x,{i18nKey:"areYouNaked"})}),e.jsx(w,{container:!0,spacing:2,children:c.map(a=>e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(z,{role:"button",tabIndex:0,sx:{cursor:"pointer",border:a.isSelected?"2px solid":"1px solid",borderColor:a.isSelected?"primary.main":"divider",backgroundColor:a.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%","&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:2}},onClick:()=>i({...n,isNaked:a.id==="naked"}),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),i({...n,isNaked:a.id==="naked"}))},children:e.jsx(M,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:s(a.title)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:a.description}),a.isSelected&&e.jsx(T,{label:s("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},a.id))})]}),e.jsx(y,{sx:{flexGrow:1}}),e.jsxs(W,{children:[e.jsx(P,{onClick:r,children:e.jsx(x,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",onClick:o,children:e.jsx(x,{i18nKey:"next"})})]})]})}const Qe=(n,i)=>{const{gameMode:o,isNaked:r}=n,s=L(o);return s&&["foreplay","sex"].includes(i.type)||!s&&r&&["solo","foreplay"].includes(i.type)||!s&&!r&&["solo","sex"].includes(i.type)},$e=n=>{const i={...n},o=n.selectedActions||{},r={};return Object.entries(o).forEach(([s,t])=>{Qe(n,t)||(r[s]=t)}),i.selectedActions=r,i},J=(n,i,o)=>{const r=n.selectedActions||{};return Object.entries(r).map(([s,t])=>{const d=i.find(l=>l.value===s);return t.type!==o||!d?null:s}).filter(s=>!!s)},_e=(n,i,o)=>{const r={...n},s={...r.selectedActions};return Object.keys(s).forEach(t=>{s[t].type===i&&!o.includes(t)&&delete s[t]}),r.selectedActions=s,r},Z=(n,i,o)=>{o(r=>{const s=_e(r,i,n),t={...s.selectedActions};return n.forEach(d=>{if(t[d])return;let l={type:i,level:1};i==="consumption"&&(l={...l,variation:s.isAppend?"appendMost":"standalone"}),t[d]=l}),{...s,selectedActions:t}})},D=(n,i,o,r,s,t=null)=>{const d=n?.target?.value;if(d===0)return s(l=>l.filter(m=>m!==i)),r(l=>{const m={...l.selectedActions||{}};return delete m[i],{...l,selectedActions:m}});r(l=>{const m={...l.selectedActions||{}};return m[i]={...m[i]||{},type:o,level:typeof d=="number"?d:isNaN(Number(d))?0:Number(d),...!!t&&{variation:t}},{...l,selectedActions:m}})},Xe=n=>!!(n&&Object.keys(n).some(i=>{const o=n[i];return(o?.level??0)>0&&o?.variation!=="appendMost"}));function ee(){return e.jsxs(p,{variant:"h6",sx:{mt:2},children:[e.jsx(x,{i18nKey:"setIntensityLevel"}),e.jsx(ce,{title:e.jsx(p,{variant:"body1",children:e.jsx(x,{i18nKey:"intensityTooltip"})}),arrow:!0,sx:{ml:1},children:e.jsx(ze,{sx:{ml:.5,fontSize:15}})})]})}function ne({onChange:n,values:i,options:o,label:r}){const s=g.useCallback(d=>o?.find(l=>l.value===d)?.label,[o]),t=g.useCallback(d=>e.jsx(y,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:d?.map(l=>e.jsx(T,{label:s(l)},l))}),[s]);return e.jsxs(de,{fullWidth:!0,children:[e.jsx(ue,{id:`${r}-label`,children:r}),e.jsx(pe,{labelId:`${r}-label`,id:`${r}`,multiple:!0,value:i,onChange:n,fullWidth:!0,input:e.jsx(ge,{label:e.jsx(x,{i18nKey:"actionsLabel"})}),renderValue:t,children:o?.map(({label:d,value:l})=>e.jsxs(xe,{value:l,children:[e.jsx(he,{checked:i.includes(l)}),e.jsx(me,{primary:d})]},l))})]})}const Je=4,Ze=n=>L(n?.gameMode)?"solo":n.isNaked?"sex":"foreplay";function De({formData:n,setFormData:i,options:o,actionsList:r}){const s=Ze(n),t=o(s),l=J(n,t,s)||[],m=u=>{const{value:c}=u.target,a=typeof c=="string"?c.split(","):c;a.length<=Je&&Z(a,s,i)};return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h6",sx:{my:2},children:e.jsx(x,{i18nKey:"pickActions"})}),e.jsx(ne,{onChange:m,values:l,options:t,label:Q("actionsLabel")}),l.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),l.map(u=>e.jsx(X,{actionsFolder:r,settings:n,option:u,initValue:1,onChange:c=>D(c,u,s,i,()=>{})},u))]})]})}const en=2;function nn({formData:n,setFormData:i,options:o,actionsList:r}){const s="consumption",t=o(s),l=J(n,t,s)||[],m=c=>{const{value:a}=c.target,h=typeof a=="string"?a.split(","):a;h.length<=en&&Z(h,s,i)},u=(c,a)=>{const h=c.target.checked?"appendMost":"standalone",k=c.target.checked,S={...n.selectedActions};a.forEach(f=>{S[f]&&(S[f]={...S[f],variation:h})});const b={...n,isAppend:k,selectedActions:S};i(b)};return e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"h6",sx:{my:2},children:e.jsx(x,{i18nKey:"pickConsumptions"})}),e.jsx(ne,{onChange:m,values:l,options:t,label:Q("consumables")}),!!l.length&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),l.map(c=>e.jsx(X,{actionsFolder:r,settings:n,option:c,initValue:1,onChange:a=>D(a,c,s,i,()=>{},n.isAppend?"appendMost":"standalone")},c)),e.jsx(p,{variant:"h6",sx:{mt:2},children:e.jsx(x,{i18nKey:"standaloneOrCombine"})}),e.jsx(Ee,{trueCondition:n.isAppend,onChange:c=>u(c,l),yesLabel:"combineWithActions"})]})]})}function tn({gameMode:n,onPresetSelect:i,selectedPreset:o,actionsList:r,showTitle:s=!0}){const{t}=K(),d={solo:[{id:"popperbating",name:t("presetPopperbating"),description:t("presetPopperbatingDesc"),actions:["bating"],consumptions:["poppers"],intensities:{bating:2,poppers:1}},{id:"smoking-tits",name:t("presetSmokingTits"),description:t("presetSmokingTitsDesc"),actions:["titTorture"],consumptions:["vaping"],intensities:{titTorture:2,vaping:1}},{id:"exploration-solo",name:t("presetExplorationSolo"),description:t("presetExplorationSoloDesc"),actions:["throatTraining","buttPlay","titTorture","ballBusting"],consumptions:[],intensities:{throatTraining:1,buttPlay:1,titTorture:1,ballBusting:1}},{id:"ball-busting",name:t("presetBallBusting"),description:t("presetBallBustingDesc"),actions:["ballBusting","bating"],consumptions:["poppers"],intensities:{ballBusting:2,bating:2}}],foreplay:[{id:"romantic-start",name:t("presetRomanticStart"),description:t("presetRomanticStartDesc"),actions:["kissing","stripping"],consumptions:["alcohol"],intensities:{kissing:2,stripping:1,alcohol:1}},{id:"degrading",name:t("presetDegrading"),description:t("presetDegradingDesc"),actions:["humiliation","footPlay","breathPlay"],consumptions:["poppers"],intensities:{humiliation:2,footPlay:2,breathPlay:2,poppers:2}},{id:"sensual-touch",name:t("presetSensualTouch"),description:t("presetSensualTouchDesc"),actions:["kissing","footPlay","tickling"],consumptions:[],intensities:{kissing:2,footPlay:1,tickling:1}},{id:"electric-play",name:t("presetElectricPlay"),description:t("presetElectricPlayDesc"),actions:["electric","bondage"],consumptions:["vaping"],intensities:{electric:1,bondage:2,vaping:1}}],sex:[{id:"gentle-sex",name:t("presetGentleSex"),description:t("presetGentleSexDesc"),actions:["throatTraining","bating","buttPlay"],consumptions:["alcohol"],intensities:{throatTraining:1,bating:1,buttPlay:1,alcohol:1}},{id:"fisting",name:t("presetFisting"),description:t("presetFistingDesc"),actions:["buttPlay"],consumptions:["poppers"],intensities:{buttPlay:4,poppers:4}},{id:"bdsm",name:t("presetBdsm"),description:t("presetBdsmDesc"),actions:["pissPlay","throatTraining","spanking","titTorture"],consumptions:[],intensities:{pissPlay:2,throatTraining:2,spanking:2,titTorture:2}},{id:"breath-control",name:t("presetBreathControl"),description:t("presetBreathControlDesc"),actions:["bating"],consumptions:["gasMask"],intensities:{bating:2,gasMask:2}}]},l=d[n]||d.solo,m=u=>{i(u)};return e.jsxs(y,{children:[s&&e.jsx(p,{variant:"h6",gutterBottom:!0,children:t("quickStart")}),e.jsx(w,{container:!0,spacing:2,children:l.map(u=>e.jsx(w,{size:{xs:12,sm:6,lg:3},children:e.jsx(z,{sx:{cursor:"pointer",border:o===u.id?2:1,borderColor:o===u.id?"primary.main":"divider",backgroundColor:o===u.id?"primary.dark":"background.paper",transition:"all 0.2s ease-in-out",height:"100%",boxShadow:1,"&:hover":{borderColor:"primary.main",transform:"translateY(-2px)",boxShadow:3,backgroundColor:o===u.id?"primary.dark":"action.hover"}},onClick:()=>m(u),children:e.jsxs(M,{sx:{p:2.5},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:u.name}),e.jsxs(y,{children:[u.actions.map((c,a)=>e.jsx(T,{label:r[c]?.label||c,size:"small",variant:"outlined",sx:{mr:.5,mb:.5,borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"primary.50"}}},`action-${a}`)),u.consumptions.map((c,a)=>e.jsx(T,{label:r[c]?.label||c,size:"small",color:"secondary",variant:"outlined",sx:{mr:.5,mb:.5,borderColor:"secondary.main",color:"secondary.main","&:hover":{backgroundColor:"secondary.50"}}},`consumption-${a}`))]})]})})},u.id))})]})}function sn({formData:n,setFormData:i,nextStep:o,prevStep:r,actionsList:s,isActionsLoading:t=!1}){const{t:d}=K(),[l,m]=g.useState(""),[u,c]=g.useState(!1),[a,h]=g.useState(!0);function k(j){return Object.keys(s).filter(v=>s[v]?.type===j)}g.useEffect(()=>{const j=$e(n);i(j)},[]),g.useEffect(()=>{n.selectedActions&&Object.keys(n.selectedActions).length>0&&(c(!0),h(!1))},[]);const S=j=>k(j).map(v=>({value:v,label:s[v]?.label}));let b;n.gameMode==="online"?b="solo":n.gameMode==="local"&&!n.isNaked?b="foreplay":b="sex";const f=(j,v,te,se)=>{j.forEach(E=>{if(s[E]){const ie=te.intensities?.[E]||v,oe=Object.keys(s[E].intensities||{}).filter(re=>re!=="None").length;se[E]={type:s[E].type,level:Math.min(ie,oe)}}})},B=j=>{m(j.id);const v={};f(j.actions,2,j,v),f(j.consumptions,1,j,v),i({...n,selectedActions:v}),h(!1),c(!0)},O=(j,v)=>{h(v),v&&c(!1)},C=(j,v)=>{c(v),v&&h(!1)},I=!Xe(n.selectedActions);return t?e.jsxs(y,{children:[e.jsxs(y,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,gap:2},children:[e.jsx($,{size:48}),e.jsx(p,{variant:"h6",color:"text.secondary",children:d("loadingAvailableActions")})]}),e.jsx(y,{sx:{mt:4},children:e.jsxs(W,{children:[e.jsx(P,{disabled:!0,children:e.jsx(x,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",disabled:!0,size:"large",children:e.jsx(x,{i18nKey:"next"})})]})})]}):e.jsxs(y,{children:[e.jsxs(G,{expanded:a,onChange:O,sx:{backgroundColor:"background.default",borderTop:1,borderBottom:1,borderColor:"divider",borderLeft:"none",borderRight:"none",borderRadius:0,"&:before":{display:"none"},boxShadow:"none"},children:[e.jsx(U,{expandIcon:e.jsx(H,{}),"aria-controls":"quickstart-content",id:"quickstart-header",sx:{backgroundColor:"background.default"},children:e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Me,{}),e.jsx(p,{variant:"h6",children:d("quickStart")})]})}),e.jsx(V,{sx:{pb:1},children:e.jsx(tn,{gameMode:b,onPresetSelect:B,selectedPreset:l,actionsList:s,showTitle:!1})})]}),e.jsxs(G,{expanded:u,onChange:C,sx:{backgroundColor:"background.default",borderTop:a?"none":1,borderBottom:1,borderColor:"divider",borderLeft:"none",borderRight:"none",borderRadius:0,marginTop:a?-1:0,"&:before":{display:"none"},boxShadow:"none"},children:[e.jsx(U,{expandIcon:e.jsx(H,{}),"aria-controls":"customization-content",id:"customization-header",sx:{backgroundColor:"background.default"},children:e.jsxs(A,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(Te,{}),e.jsx(p,{variant:"h6",children:d("customizeActions")})]})}),e.jsxs(V,{children:[e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mb:2},children:d("customizeActionsDesc")}),e.jsx(De,{formData:n,setFormData:i,options:S,actionsList:s}),e.jsx(_,{sx:{my:3}}),e.jsx(nn,{formData:n,setFormData:i,options:S,actionsList:s})]})]}),e.jsx(y,{sx:{mt:4},children:e.jsxs(W,{children:[e.jsx(P,{onClick:()=>r(R(n.room)?3:1),children:e.jsx(x,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",disabled:I,onClick:o,size:"large",children:e.jsx(x,{i18nKey:"next"})})]})})]})}function on({formData:n,setFormData:i,prevStep:o,actionsList:r,close:s}){const t=[100,100],d=[0,0],[l,m]=g.useState(Y(n?.finishRange||[],d)),[u,c]=g.useState(!1),a=Ue(),{t:h}=K();g.useEffect(()=>{let b={...n,boardUpdated:!0};(!l||!Y(n.finishRange||[],t))&&(b.finishRange=t),i(b)},[]);async function k(){c(!0);try{await a(n,r)}catch(b){console.error("Error submitting settings:",b)}finally{c(!1)}typeof s=="function"&&s()}const S=[{id:"noOrgasm",title:"noOrgasm",description:h("noOrgasmDesc"),isSelected:!l},{id:"yesOrgasm",title:"yesOrgasm",description:h("yesOrgasmDesc"),isSelected:l}];return e.jsxs(y,{sx:{minHeight:"200px",display:"flex",flexDirection:"column"},children:[e.jsx(p,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:e.jsx(x,{i18nKey:"WillYouOrgasm"})}),e.jsx(w,{container:!0,spacing:2,sx:{mb:4},children:S.map(b=>e.jsx(w,{size:{xs:12,sm:6},children:e.jsx(z,{sx:{cursor:"pointer",border:b.isSelected?"3px solid":"1px solid",borderColor:b.isSelected?"primary.main":"divider",backgroundColor:b.isSelected?"primary.50":"background.paper",transition:"all 0.2s ease-in-out",height:"100%",transform:b.isSelected?"scale(1.02)":"scale(1)","&:hover":{borderColor:"primary.main",transform:"scale(1.02)",boxShadow:2}},onClick:()=>{const f=b.id==="yesOrgasm";i({...n,finishRange:f?d:t}),m(f)},children:e.jsx(M,{sx:{p:3},children:e.jsxs(A,{spacing:1,alignItems:"center",textAlign:"center",children:[e.jsx(p,{variant:"h6",sx:{fontWeight:600},children:h(b.title)}),e.jsx(p,{variant:"body2",color:"text.secondary",children:b.description}),b.isSelected&&e.jsx(T,{label:h("selected"),color:"primary",size:"small",sx:{mt:1}})]})})})},b.id))}),e.jsx(y,{sx:{flexGrow:1}}),e.jsxs(W,{children:[e.jsx(P,{onClick:o,disabled:u,children:e.jsx(x,{i18nKey:"previous"})}),e.jsx(P,{variant:"contained",onClick:k,disabled:u,startIcon:u?e.jsx($,{size:20}):null,size:"large",sx:{px:4},children:e.jsx(x,{i18nKey:"buildGame"})})]})]})}function rn({currentStep:n,isPublicRoom:i,onStepClick:o}){const{t:r}=K(),s=be(),t=ye(s.breakpoints.down("md")),d=i?[{label:String(r("roomSelection","Room Selection")),wizardStep:1},{label:String(r("actionsSelection","Actions Selection")),wizardStep:4},{label:String(r("finishSetup","Finish Setup")),wizardStep:5}]:[{label:String(r("roomSelection","Room Selection")),wizardStep:1},{label:String(r("localPlayersStep.title","Local Players")),wizardStep:2},{label:String(r("gameModeSelection","Game Mode Selection")),wizardStep:3},{label:String(r("actionsSelection","Actions Selection")),wizardStep:4},{label:String(r("finishSetup","Finish Setup")),wizardStep:5}],l=d.findIndex(u=>u.wizardStep===n),m=u=>{if(o){const c=d[u].wizardStep;o(c)}};return e.jsx(je,{activeStep:l,alternativeLabel:!t,orientation:"horizontal",sx:{...t&&{"& .MuiStepLabel-label":{display:"none"}}},children:d.map((u,c)=>e.jsx(Se,{children:e.jsx(fe,{onClick:()=>m(c),sx:{cursor:o?"pointer":"default","&:hover":o?{"& .MuiStepLabel-label":{color:"primary.main"}}:{}},children:t?null:u.label})},c))})}function an({close:n}){const{id:i}=q(),[o,r]=g.useState(1),s={room:i||"PUBLIC"},[t,d]=He({gameMode:"online",roomRealtime:!0,actions:[],consumption:[],role:"sub",boardUpdated:!1,room:i||"PUBLIC",selectedActions:{}},s),{actionsList:l,isLoading:m}=Ve(t.gameMode),u=S=>{if(!Number.isInteger(S))return r(o+1);r(o+(S||1))},c=S=>{if(!Number.isInteger(S))return r(o-1);r(o-(S||1))},a=()=>r(0),h=()=>{R(t.room)||t.gameMode==="online"?r(4):r(1)},k=()=>{switch(o){case 1:return e.jsx(Ye,{formData:t,setFormData:d,nextStep:u});case 2:return R(t.room)?(r(4),null):e.jsx(Fe,{formData:t,setFormData:d,nextStep:u,prevStep:c});case 3:return R(t.room)?(r(4),null):e.jsx(qe,{formData:t,setFormData:d,nextStep:u,prevStep:c});case 4:return e.jsx(sn,{formData:t,setFormData:d,nextStep:u,prevStep:c,actionsList:l,isActionsLoading:m});case 5:return e.jsx(on,{formData:t,setFormData:d,prevStep:c,actionsList:l,close:n});default:return null}};return o===0?e.jsx(Ne,{closeDialog:n,onOpenSetupWizard:h}):e.jsxs(y,{children:[e.jsx(y,{sx:{width:"100%",mt:2,mb:4},children:e.jsx(rn,{currentStep:o,isPublicRoom:R(t.room),onStepClick:r})}),k(),e.jsx(_,{sx:{mt:3}}),e.jsx(P,{onClick:a,children:e.jsx(x,{i18nKey:"advancedSetup"})})]})}function Tn({open:n,close:i}){const o=we(),[r]=ve();return r.get("importBoard")?null:e.jsxs(Ce,{fullScreen:o,open:n,maxWidth:"md",children:[e.jsxs(ke,{children:[e.jsx(x,{i18nKey:"gameSettingsHeading"}),typeof i=="function"&&e.jsx(Ae,{close:i})]}),e.jsx(Pe,{children:e.jsx(an,{close:typeof i=="function"?i:void 0})})]})}export{Tn as default};
