import{R as P,aj as O,b as n,j as E}from"./chunk-CVSdvP5Z.js";import{v as S}from"./chunk-B-cyqPC2.js";import{u as R}from"./chunk-AkXvan0D.js";import"./chunk-CNqt7FHs.js";import"./chunk-BVO8KFPS.js";import"./chunk-_SwOSjSw.js";(function(){var r=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{};r.SENTRY_RELEASE={id:"874067a760cfa9079dd7f585e4ceff298b0e879f"}})();try{(function(){var r=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:{},e=new r.Error().stack;e&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[e]="be64d7be-b4e7-4e1b-8bbb-2f84a834e214",r._sentryDebugIdIdentifier="sentry-dbid-be64d7be-b4e7-4e1b-8bbb-2f84a834e214")})()}catch(r){}var U=Object.defineProperty,h=Object.defineProperties,j=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,m=(r,e,t)=>e in r?U(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,g=(r,e)=>{for(var t in e||(e={}))I.call(e,t)&&m(r,t,e[t]);if(_)for(var t of _(e))x.call(e,t)&&m(r,t,e[t]);return r},L=(r,e)=>h(r,j(e));function T(r){if(!r||typeof r!="object")return!1;const e=r;return typeof e.displayName=="string"&&typeof e.uid=="string"&&(e.lastSeen instanceof Date||typeof e.lastSeen=="number"||typeof e.lastSeen=="string")}const C=P.createContext(void 0);function Y(r){const{id:e}=O(),{onlineUsers:t,setUsers:i,setRoom:l,clearUsers:f,flushPendingUpdates:u}=R(),a=n.useRef(null),d=n.useRef(e),c=n.useCallback(p=>{if(p===null)f();else{const b={};Object.entries(p).forEach(([y,o])=>{if(T(o)){const w=L(g({},o),{lastSeen:o.lastSeen instanceof Date?o.lastSeen:new Date(o.lastSeen)});b[y]=w}else console.warn(`Invalid user data for uid ${y}:`,o)}),i(b)}},[i,f]),s=n.useCallback(()=>{a.current&&(a.current(),a.current=null),u()},[u]);n.useEffect(()=>{if(d.current!==e&&(l(e||null),d.current=e),!e){s(),f();return}return s(),S(e,c),a.current=null,s},[e,l,f,c,s]),n.useEffect(()=>s,[s]);const v=n.useMemo(()=>({onlineUsers:t}),[t]);return E.jsx(C.Provider,g({value:v},r))}export{C as UserListContext,Y as UserListProvider};
//# sourceMappingURL=userList.tsx-DlUmKFMN.js.map
