import{i as b}from"./chunk-CalwtN_X.js";import{g as x}from"./chunk-B4PEA_xj.js";import{r as l,j as m,aa as y}from"./chunk-QuzIwS35.js";import{u as v}from"./chunk-CkQ5Z0DI.js";import{c as k}from"./chunk-D2XAL7ZP.js";function w(e){const t=/vimeo\.com\/(\d+)/,o=e.match(t);return`https://player.vimeo.com/video/${o?o[1]:""}?autoplay=1&loop=1&autostart=true`}function I(e){const t=/(?:youtube\.com\/(?:[^/]+\/.+\/|(?:v|e(?:mbed)?)\/|[^#]*[?&]v=|youtu\.be\/)([^"&?/ ]{11})|^(?:[^"&?/ ]{11})$)/,o=e.match(t);return`https://www.youtube.com/embed/${o?o[1]:""}?autoplay=1&loop=1&autostart=true`}function U(e){const t=/drive\.google\.com\/file\/d\/([^/]+)/,o=e.match(t);return`https://drive.google.com/file/d/${o?o[1]:""}/preview?loop=1`}function $(e){const t=/dropbox\.com\/s\/([^/]+)/,o=e.match(t);return`https://www.dropbox.com/s/${o?o[1]:""}?raw=1`}function R(e){return`https://pornhub.com/embed/${new URL(e).searchParams.get("viewkey")||""}?autoplay=1&loop=1&autostart=true`}function j(e){const t=e.split("-");return`https://xhamster.com/xembed.php?video=${t[t.length-1]}?autoplay=1&loop=1&autostart=true`}function B(e){try{const r=new URL(e);if((r.host==="discordapp.net"||r.host.endsWith(".discordapp.net"))&&r.pathname.startsWith("/external/")&&(r.pathname.includes("/https/i.imgur.com/")||r.pathname.includes("/https/imgur.com/")))return e}catch{}let t="",o=!1;try{const r=new URL(e);o=r.host==="imgur.com"||r.host==="i.imgur.com"}catch{return""}if(!o)return"";if(e.includes("/gallery/")){const r=e.match(/imgur\.com\/gallery\/[^#]*#([a-zA-Z0-9]+)/);if(r)t=r[1];else{const s=e.match(/#([a-zA-Z0-9]+)/);s&&(t=s[1])}}else{const r=/imgur\.com\/([a-zA-Z0-9]+)(?:\.(mp4|jpg|jpeg|png|gif|webp))?|images-ext-\d+\.discordapp\.net\/external\/[^/]+\/https\/i\.imgur\.com\/([a-zA-Z0-9]+)\.(mp4|jpg|jpeg|png|gif|webp)/,s=e.match(r);t=s?s[1]||s[3]:""}return`https://i.imgur.com/${t}.mp4`}function h(e){return/\.(mp4|webm|ogg|mov)(\?.*)?$/.test(e)}function P(e){return f(e,["media.discordapp.net","cdn.discordapp.com"])&&!h(e)}function f(e,t){try{const o=new URL(e);return t.some(n=>o.host===n||o.host.endsWith("."+n))}catch{return t.some(o=>e.includes(o))}}function L(e){let t=null,o=!0;if(!e)return{url:"",isVideo:!1};switch(!0){case e.includes("vimeo.com"):t=w(e);break;case f(e,["youtube.com","youtu.be"]):t=I(e);break;case e.includes("drive.google.com"):t=U(e);break;case e.includes("pornhub.com"):t=R(e);break;case e.includes("xhamster.com"):t=j(e);break;case e.includes("dropbox.com"):t=$(e);break;case f(e,["imgur.com","i.imgur.com"]):t=B(e);break;case f(e,["thisvid.com","boyfriendtv.com"]):t=e;break;case P(e):t=e,o=!1;break;case h(e):t=e;break;default:t=x(e),o=!1;break}return{url:t,isVideo:o}}function M(e,t,o){const{background:n,backgroundURL:r,roomBackground:s}=e,d=n!=="custom"?n:r,i=s==="app"?s:o,c=!b(t)&&s!=="app"?i:d;return c?L(c):{url:null,isVideo:!1}}function S(e,t){const o=e.findIndex(r=>r.uid===t);if(o===-1||e.length===0)return null;const n=o+1>=e.length?0:o+1;return e[n]}function N(e){const[t,o]=l.useState(null),n=v();return l.useEffect(()=>{if(!e)return;if(n.length<=1){o(null);return}const r=n.filter(d=>!d.isFinished),s=S(r,e.uid);o(s)},[e,n]),t}function E({url:e}){const[t,o]=l.useState("video"),[n,r]=l.useState(e);if(l.useEffect(()=>{r(e),o("video")},[e]),!e)return null;const s=()=>{let i=!1;try{const a=new URL(e);i=a.host==="imgur.com"||a.host==="i.imgur.com"}catch{i=!1}if(i){const a=e.match(/imgur\.com\/([a-zA-Z0-9]+)/)?.[1];if(a){const u=`https://i.imgur.com/${a}.jpg`;r(u),o("image");return}}const g=`${e.replace(/\.(mp4|webm|ogg|mov)(\?.*)?$/i,"")}.jpg`;r(g),o("image")},d=()=>{let i=!1;try{const c=new URL(e);i=c.host==="imgur.com"||c.host==="i.imgur.com"}catch{i=!1}if(i){const c=e.match(/imgur\.com\/([a-zA-Z0-9]+)/)?.[1];if(c){const g=["png","gif","jpeg","webp"],a=n?.split(".").pop(),u=g.find(p=>p!==a);if(u){const p=`https://i.imgur.com/${c}.${u}`;r(p)}}}else{const c=["png","gif","jpeg","webp"],g=n?.split(".").pop(),a=c.find(u=>u!==g);if(a&&n){const p=`${n.replace(/\.[^.]+(\?.*)?$/,"")}.${a}`;r(p)}}};return t==="video"?m.jsx("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,src:n||void 0,className:"video-background",onError:s}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"image-background",style:{backgroundImage:`url(${n})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"100%",height:"100%",position:"absolute",top:0,left:0}}),m.jsx("img",{src:n||void 0,onError:d,style:{display:"none"},alt:""})]})}function T({url:e=null,isVideo:t=null}){const o=e&&/\.(mp4|webm|ogg|mov)(\?.*)?$/i.test(e),n=e&&(e.includes("/images/color")||e.includes("/images/gray")),r=e&&!n&&(t||!t&&e);return m.jsx(y,{className:k("main-container",!r&&"default-background"),role:"presentation",sx:{backgroundImage:!t&&e&&!n?`url(${e})`:"none"},children:t&&(o?m.jsx(E,{url:e}):m.jsx("iframe",{width:"100%",height:"100%",src:e||void 0,title:"video",allowFullScreen:!0,allow:"autoplay",style:{border:0}}))})}export{T as R,M as g,L as p,N as u};
