const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C2e1Vf6X.js","assets/index-CdFengrE.js","assets/mui-DHsUyARS.js","assets/vendor-BqRCY_y4.js","assets/firebase-Bq5WjqAs.js","assets/translations-BGyRMCWP.js","assets/index-uiLgFlgU.css","assets/strings-DUzsPRT8.js","assets/index-BqUWfnOa.js","assets/index-MVD_18-b.js","assets/index-Bc0qcu8j.js","assets/useActionList-DWxEQFv9.js","assets/index-BnRKSWHl.js","assets/urls-BP4ggioV.js","assets/index-CignLajt.css","assets/index-B0WOVbdn.js","assets/index-0XjfPz8-.css","assets/index-BY-9UVWJ.js","assets/index-Bb5gJNj1.js","assets/index-CxiDa7kz.js"])))=>i.map(i=>d[i]);
import{S as $,A as J,k as U,r as H,m as Q,_}from"./index-CdFengrE.js";import{Z as Y,$ as Z,j as e,k as z,a0 as X,o as ee,q as te,p as se,f as S,a1 as L,g as E,B as A,a2 as R,h as D,D as ne,a3 as ae,a4 as oe,a5 as re,a6 as ie,a7 as ce,a8 as le,a9 as ue,aa as de,ab as me,ac as ge,ad as xe,ae as he,af as pe,ag as fe,ah as je,ai as we,aj as G,ak as Se,al as ye,l as F,am as Ce,an as be,w as ve,ao as ke,ap as Ae,aq as Ee,ar as N,as as _e,at as Ie,au as Le,av as De}from"./mui-DHsUyARS.js";import{r as s,a as Te,u as K}from"./vendor-BqRCY_y4.js";import{u as T,T as g,t as O}from"./translations-BGyRMCWP.js";import{i as Pe}from"./strings-DUzsPRT8.js";function W(t="sm"){const n=Y();return Z(n.breakpoints.down(t))}function Oe(t,n){const o=localStorage.getItem(t);if(!o)return n;try{const a=JSON.parse(o);return typeof n=="object"&&n!==null&&Object.keys(n).length?{...n,...a}:a}catch(a){return console.error("Error parsing localStorage value:",a),n}}function ze(t,n={}){const o=`${t}Storage`,[a,r]=s.useState(()=>Oe(t,n));s.useEffect(()=>{const c=d=>{d.newValue!==void 0&&r(d.newValue)};return window.addEventListener(o,c),()=>window.removeEventListener(o,c)},[o]);const l=s.useCallback(c=>{try{localStorage.setItem(t,JSON.stringify(c));const d=new Event(o);d.newValue=c,window.dispatchEvent(d)}catch(d){console.error("Error updating localStorage:",d)}},[t,o]);return[a,l]}function Re(){const t=Te.useContext($);if(!t)throw new Error("ScheduleContext's value is undefined.");return t}const Ne="/assets/blitzed-out-DGhYHOgx.png";function B(){const t=s.useContext(J);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function We({close:t}){return e.jsx(z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8},children:e.jsx(X,{})})}function q({children:t,open:n,close:o=null,isMobile:a=null,title:r=null,isLoading:l=!1}){const c=a!==null?a:W();return l?null:e.jsxs(ee,{fullScreen:c,open:n,maxWidth:"md",children:[e.jsxs(te,{children:[r,typeof o=="function"&&e.jsx(We,{close:o})]}),e.jsx(se,{children:t})]})}function Be({onSuccess:t,onSwitchToRegister:n,onSwitchToForgotPassword:o,isLinking:a=!1}){const{t:r}=T(),[l,c]=s.useState(""),[d,h]=s.useState(""),[w,u]=s.useState(""),[m,i]=s.useState(!1),j=async p=>{p.preventDefault(),u(""),i(!0);try{await U(l,d),t&&t()}catch(f){console.error("Login error:",f),u(f.message||"Failed to sign in")}finally{i(!1)}};return e.jsxs(S,{component:"form",onSubmit:j,sx:{mt:1},children:[w&&e.jsx(L,{severity:"error",sx:{mb:2},children:w}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:r("email"),name:"email",autoComplete:"email",autoFocus:!0,value:l,onChange:p=>c(p.target.value)}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:r("password"),type:"password",id:"password",autoComplete:"current-password",value:d,onChange:p=>h(p.target.value)}),e.jsx(A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:m,children:m?e.jsx(R,{size:24}):a?e.jsx(g,{i18nKey:"linkAccount",children:"Link Account"}):e.jsx(g,{i18nKey:"signIn"})}),e.jsxs(D,{align:"center",children:[e.jsx(A,{onClick:n,variant:"text",children:e.jsx(g,{i18nKey:"needAccount"})})," | ",e.jsx(A,{onClick:o,variant:"text",children:e.jsx(g,{i18nKey:"forgotPassword"})})]})]})}function Me({onSuccess:t,onSwitchToLogin:n,isAnonymous:o=!1}){const{t:a}=T(),[r,l]=s.useState(""),[c,d]=s.useState(""),[h,w]=s.useState(""),[u,m]=s.useState(""),[i,j]=s.useState(""),[p,f]=s.useState(!1),y=async C=>{if(C.preventDefault(),j(""),h!==u){j(a("passwordsDoNotMatch")||"Passwords do not match");return}f(!0);try{await H(c==null?void 0:c.trim(),h,r==null?void 0:r.trim()),t&&t()}catch(k){console.error("Registration error:",k),j(k.message||"Failed to create account")}finally{f(!1)}};return e.jsxs(S,{component:"form",onSubmit:y,sx:{mt:1},children:[i&&e.jsx(L,{severity:"error",sx:{mb:2},children:i}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,id:"displayName",label:a("displayName"),name:"displayName",autoComplete:"name",autoFocus:!0,value:r,onChange:C=>l(C.target.value)}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:a("email"),name:"email",autoComplete:"email",value:c,onChange:C=>d(C.target.value)}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:a("password"),type:"password",id:"password",autoComplete:"new-password",value:h,onChange:C=>w(C.target.value)}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:a("confirmPassword"),type:"password",id:"confirmPassword",autoComplete:"new-password",value:u,onChange:C=>m(C.target.value)}),e.jsx(A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:p,children:p?e.jsx(R,{size:24}):o?e.jsx(g,{i18nKey:"linkAccount"}):e.jsx(g,{i18nKey:"createAccount"})}),e.jsx(D,{align:"center",children:e.jsx(A,{onClick:n,variant:"text",children:e.jsx(g,{i18nKey:"alreadyHaveAccount"})})})]})}function Ge({onSuccess:t,isLinking:n=!1}){const[o,a]=s.useState(""),[r,l]=s.useState(!1),c=async()=>{a(""),l(!0);try{await Q(),t&&t()}catch(d){a(d.message||"Failed to sign in with Google")}finally{l(!1)}};return e.jsxs(S,{sx:{mt:2,mb:2},children:[o&&e.jsx(L,{severity:"error",sx:{mb:2},children:o}),e.jsx(ne,{sx:{mb:2},children:e.jsx(D,{variant:"body2",color:"text.secondary",children:e.jsx(g,{i18nKey:"or",children:"OR"})})}),e.jsx(A,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(ae,{}),onClick:c,disabled:r,sx:{mb:1},"aria-busy":r,"aria-live":"polite",children:r?e.jsx(R,{size:24}):n?O("linkWithGoogle","Link with Google"):O("signInWithGoogle","Sign in with Google")})]})}function Fe({onToggleForm:t}){const[n,o]=s.useState(""),[a,r]=s.useState(""),[l,c]=s.useState(!1),[d,h]=s.useState(!1),{forgotPassword:w}=B(),u=async m=>{m.preventDefault(),r(""),c(!1),h(!0);try{await w(n),c(!0)}catch(i){r(i.message||"Failed to send reset email")}finally{h(!1)}};return e.jsxs(S,{component:"form",onSubmit:u,sx:{mt:1},children:[a&&e.jsx(L,{severity:"error",sx:{mb:2},children:a}),l&&e.jsx(L,{severity:"success",sx:{mb:2},children:e.jsx(g,{i18nKey:"resetEmailSent"})}),e.jsx(E,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:e.jsx(g,{i18nKey:"email"}),name:"email",autoComplete:"email",autoFocus:!0,value:n,onChange:m=>o(m.target.value)}),e.jsx(A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:d,children:d?e.jsx(R,{size:24}):e.jsx(g,{i18nKey:"sendResetLink"})}),e.jsx(S,{sx:{textAlign:"center"},children:e.jsx(A,{variant:"text",onClick:()=>t("login"),children:e.jsx(g,{i18nKey:"backToLogin"})})})]})}function Ke({open:t,close:n,initialView:o="login"}){const[a,r]=s.useState(o),{isAnonymous:l}=B(),{t:c}=T(),d=()=>{switch(a){case"login":return c(l?"linkAccount":"signIn");case"register":return c("createAccount");case"reset":return c("resetPassword");default:return c("Authentication")}};return e.jsxs(q,{title:d(),open:t,close:n,children:[a==="login"&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{onSwitchToRegister:()=>r("register"),onSwitchToForgotPassword:()=>r("reset"),onSuccess:n,isLinking:l}),e.jsx(Ge,{onSuccess:n,isLinking:l})]}),a==="reset"&&e.jsx(Fe,{onToggleForm:r}),a==="register"&&e.jsx(Me,{onSwitchToLogin:()=>r("login"),onSuccess:n,isAnonymous:l})]})}const qe=s.lazy(()=>_(()=>import("./index-C2e1Vf6X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Ve=s.lazy(()=>_(()=>import("./index-BqUWfnOa.js"),__vite__mapDeps([8,2,3,9,10,5,7,1,4,6,11,12,13,14]))),$e=s.lazy(()=>_(()=>import("./index-B0WOVbdn.js"),__vite__mapDeps([15,2,3,5,1,4,6,7,16]))),Je=s.lazy(()=>_(()=>import("./index-BY-9UVWJ.js"),__vite__mapDeps([17,2,3,12,1,4,5,6,10,7]))),Ue=s.lazy(()=>_(()=>import("./index-Bb5gJNj1.js"),__vite__mapDeps([18,2,3,10,5,1,4,6,13,7]))),He=s.lazy(()=>_(()=>import("./index-CxiDa7kz.js"),__vite__mapDeps([19,2,3,11,12,1,4,5,6,10,7])));function Qe(){const{id:t}=K(),{user:n,logout:o,isAnonymous:a}=B(),r=W(),{i18n:l}=T(),[c,d]=s.useState(!1),h=x=>d(x),w=ze("gameSettings")[0],[u,m]=s.useState({settings:!1,gameBoard:!1,about:!1,schedule:!1,customTiles:!1,linkAccount:!1,appSettings:!1}),i=(x,v)=>m({...u,[x]:v}),j=async()=>{await o(),h(!1)},p=x=>window.open(x,"_blank","noreferrer"),f=e.jsx(pe,{children:e.jsx("path",{d:"M18.942 5.556a16.299 16.299 0 0 0-4.126-1.297c-.178.321-.385.754-.529 1.097a15.175 15.175 0 0 0-4.573 0 11.583 11.583 0 0 0-.535-1.097 16.274 16.274 0 0 0-4.129 1.3c-2.611 3.946-3.319 7.794-2.965 11.587a16.494 16.494 0 0 0 5.061 2.593 12.65 12.65 0 0 0 1.084-1.785 10.689 10.689 0 0 1-1.707-.831c.143-.106.283-.217.418-.331 3.291 1.539 6.866 1.539 10.118 0 .137.114.277.225.418.331-.541.326-1.114.606-1.71.832a12.52 12.52 0 0 0 1.084 1.785 16.46 16.46 0 0 0 5.064-2.595c.415-4.396-.709-8.209-2.973-11.589zM8.678 14.813c-.988 0-1.798-.922-1.798-2.045s.793-2.047 1.798-2.047 1.815.922 1.798 2.047c.001 1.123-.793 2.045-1.798 2.045zm6.644 0c-.988 0-1.798-.922-1.798-2.045s.793-2.047 1.798-2.047 1.815.922 1.798 2.047c0 1.123-.793 2.045-1.798 2.045z"})}),y=x=>{l.changeLanguage(x),localStorage.setItem("gameSettings",JSON.stringify({...JSON.parse(localStorage.getItem("gameSettings")||"{}"),locale:x}))},k=s.useMemo(()=>{const x=[{key:"gameBoard",title:e.jsx(g,{i18nKey:"gameBoards"}),icon:e.jsx(fe,{}),onClick:()=>i("gameBoard",!0)},{key:"customTiles",title:e.jsx(g,{i18nKey:"customTilesLabel"}),icon:e.jsx(je,{}),onClick:()=>i("customTiles",!0)},{key:"cast",title:e.jsx(g,{i18nKey:"tvMode"}),icon:e.jsx(we,{}),onClick:()=>p(`/${t==null?void 0:t.toUpperCase()}/cast`)},{key:"schedule",title:e.jsx(g,{i18nKey:"schedule"}),icon:e.jsx(G,{}),onClick:()=>i("schedule",!0)},{key:"discord",title:"Discord",icon:f,onClick:()=>p("https://discord.gg/mSPBE2hFef")},{key:"about",title:e.jsx(g,{i18nKey:"about"}),icon:e.jsx(Se,{}),onClick:()=>i("about",!0)}];return n&&(x.unshift({key:"appSettings",title:e.jsx(g,{i18nKey:"appSettings"}),icon:e.jsx(oe,{}),onClick:()=>i("appSettings",!0)}),x.unshift({key:"settings",title:e.jsx(g,{i18nKey:w.advancedSettings?"settings":"setupWizard"}),icon:e.jsx(re,{}),onClick:()=>i("settings",!0)}),a&&x.push({key:"linkAccount",title:e.jsx(g,{i18nKey:"linkAccount"}),icon:e.jsx(ie,{}),onClick:()=>i("linkAccount",!0)}),x.push({key:"logout",title:e.jsx(g,{i18nKey:"logout"}),icon:e.jsx(ce,{}),onClick:()=>j()})),x},[n,t,a,w.advancedSettings]).map(({key:x,title:v,icon:I,onClick:P})=>e.jsx(le,{disablePadding:!0,onClick:P,children:e.jsxs(ue,{children:[e.jsx(de,{children:I}),e.jsx(me,{primary:v})]})},x)),b=(x,v,I={})=>e.jsx(s.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(x,{open:u[v],close:()=>i(v.toString(),!1),isMobile:r,...I})});return e.jsxs(e.Fragment,{children:[e.jsx(z,{onClick:()=>h(!0),"aria-label":"open menu",children:e.jsx(ge,{})}),e.jsx(xe,{anchor:"right",open:c,onClose:()=>h(!1),children:e.jsxs(S,{role:"presentation",onClick:()=>h(!1),sx:{width:250,display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(he,{sx:{flexGrow:1},children:k}),e.jsxs(S,{sx:{borderTop:"1px solid rgba(0, 0, 0, 0.12)",p:2,display:"flex",justifyContent:"center",gap:1},children:[e.jsx(S,{component:"span",onClick:()=>y("en"),sx:{cursor:"pointer",fontWeight:l.language==="en"?"bold":"normal",color:l.language==="en"?"primary.main":"inherit"},children:"English"}),e.jsx(S,{component:"span",children:"|"}),e.jsx(S,{component:"span",onClick:()=>y("fr"),sx:{cursor:"pointer",fontWeight:l.language==="fr"?"bold":"normal",color:l.language==="fr"?"primary.main":"inherit"},children:"Français"}),e.jsx(S,{component:"span",children:"|"}),e.jsx(S,{component:"span",onClick:()=>y("es"),sx:{cursor:"pointer",fontWeight:l.language==="es"?"bold":"normal",color:l.language==="es"?"primary.main":"inherit"},children:"Español"})]})]})}),u.settings&&b(Ve,"settings"),u.appSettings&&b(qe,"appSettings"),u.about&&e.jsx(s.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(q,{open:u.about,close:()=>i("about",!1),children:e.jsx($e,{})})}),u.gameBoard&&b(Je,"gameBoard"),u.schedule&&b(Ue,"schedule"),u.customTiles&&b(He,"customTiles"),u.linkAccount&&b(Ke,"linkAccount")]})}function Ye({playerList:t,innerRef:n,...o}){return e.jsxs("div",{...o,ref:n,children:[e.jsx(ye,{color:"success",sx:{fontSize:8,marginRight:"0.2rem"}}),t.length]})}window.__castApiInitialized=window.__castApiInitialized||!1;function Ze(){const[t,n]=s.useState(!1),[o,a]=s.useState(null),{id:r}=K(),l=s.useRef(null),[c,d]=s.useState(!1);s.useEffect(()=>{const u=()=>{var i,j,p,f;try{if(!((i=window==null?void 0:window.cast)!=null&&i.framework))return;if(window.__castApiInitialized){d(!0),m();return}window.cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:"1227B8DE",autoJoinPolicy:(f=(p=(j=window.chrome)==null?void 0:j.cast)==null?void 0:p.AutoJoinPolicy)==null?void 0:f.ORIGIN_SCOPED}),window.__castApiInitialized=!0,d(!0),m()}catch(y){console.error("Error initializing Cast API:",y)}},m=()=>{var i,j,p;try{const f=(j=(i=window.cast)==null?void 0:i.framework)==null?void 0:j.CastContext.getInstance();if(!f)return;const y=f.getCurrentSession();if(y&&(n(!0),a(y),r&&h(y)),!((p=window==null?void 0:window.cast)!=null&&p.framework))return;f.addEventListener(window.cast.framework.CastContextEventType.SESSION_STATE_CHANGED,C=>{var b,x,v,I,P,M;const k=f.getCurrentSession();switch(C.sessionState){case((x=(b=window.cast)==null?void 0:b.framework)==null?void 0:x.SessionState.SESSION_STARTED):case((I=(v=window.cast)==null?void 0:v.framework)==null?void 0:I.SessionState.SESSION_RESUMED):n(!0),a(k),k&&r&&h(k);break;case((M=(P=window.cast)==null?void 0:P.framework)==null?void 0:M.SessionState.SESSION_ENDED):n(!1),a(null);break;default:break}})}catch(f){console.error("Error setting up session listener:",f)}};if(window.chrome&&window.chrome.cast&&window.cast)u();else if(window.__onGCastApiAvailable=function(i){i&&u()},!document.querySelector('script[src*="cast_sender.js"]')){const i=document.createElement("script");i.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",document.head.appendChild(i)}return()=>{}},[r]);const h=u=>{try{const m=`${window.location.origin}/${r}/cast`;console.log("Sending cast message with URL:",m),u.sendMessage("urn:x-cast:com.blitzedout.app",{type:"LOAD",url:m})}catch(m){console.error("Error sending cast message:",m)}},w=()=>{var u,m;if(c)if(t)o&&o.endSession(!0);else try{const i=(m=(u=window.cast)==null?void 0:u.framework)==null?void 0:m.CastContext.getInstance();i&&i.requestSession().then(()=>console.log("Cast session requested successfully"),j=>console.error("Error requesting cast session:",j))}catch(i){console.error("Error requesting cast session:",i)}};return s.useEffect(()=>{t&&o&&r&&h(o)},[r,t,o]),c?e.jsx(F,{title:t?O("stopCasting"):O("startCasting"),children:e.jsx(z,{ref:l,onClick:w,color:t?"primary":"default",children:t?e.jsx(Ce,{}):e.jsx(be,{})})}):null}const Xe=s.lazy(()=>_(()=>import("./index-Bb5gJNj1.js"),__vite__mapDeps([18,2,3,10,5,1,4,6,13,7])));function ot({room:t,playerList:n=[]}){const{t:o}=T(),[a,r]=s.useState(!1),[l,c]=s.useState(!1),{schedule:d}=Re(),h=W(),w=()=>{r(!0),c(!0)},u=e.jsxs(e.Fragment,{children:[e.jsx(D,{variant:"h6",children:e.jsx(g,{i18nKey:"online"})}),e.jsx("ul",{children:n.map(m=>e.jsx("li",{children:e.jsx(D,{variant:"body1",children:m.displayName})},m.uid))})]});return e.jsx(ve,{position:"fixed",children:e.jsxs(ke,{disableGutters:!0,variant:"dense",component:"nav",className:"nav",children:[e.jsxs("div",{className:"site-name",children:[e.jsx(S,{component:"img",sx:{height:32},alt:"Blitzed Out Logo",src:Ne}),e.jsx("h1",{children:"Blitzed Out"})]}),e.jsx("div",{children:e.jsxs("div",{className:"nav-room-name",children:[e.jsx("h2",{children:Pe(t)||t===void 0?o("public"):t}),e.jsx(F,{title:u,children:e.jsx(V,{playerList:n})}),e.jsx(z,{onClick:w,"aria-label":"schedule game",sx:{ml:2},children:e.jsx(Ae,{color:"primary",badgeContent:l?null:d.length,children:e.jsx(G,{})})}),a&&e.jsx(Ee,{children:e.jsx(s.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(Xe,{open:a,close:()=>r(!1),isMobile:h})})})]})}),e.jsxs("div",{className:"menu-drawer",children:[e.jsx(Ze,{}),e.jsx(Qe,{})]})]})})}const V=s.forwardRef(({playerList:t,...n},o)=>e.jsx(Ye,{playerList:t,...n,innerRef:o}));V.displayName="WrapPlayersOnline";const rt=N(t=>e.jsx(_e,{disableGutters:!0,elevation:0,square:!0,...t}))(({theme:t})=>({border:`1px solid ${t.palette.divider}`,"&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"}})),it=N(t=>e.jsx(Ie,{expandIcon:e.jsx(Le,{sx:{fontSize:"0.9rem"}}),...t}))(({theme:t})=>({backgroundColor:t.palette.mode==="dark"?"rgba(255, 255, 255, .05)":"rgba(0, 0, 0, .03)",flexDirection:"row-reverse","& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(90deg)"},"& .MuiAccordionSummary-content":{marginLeft:t.spacing(1)}})),ct=N(De)(({theme:t})=>({padding:t.spacing(2),borderTop:"1px solid rgba(0, 0, 0, .125)"}));export{Ke as A,We as C,ot as N,ze as a,rt as b,it as c,ct as d,Re as e,W as u};
