import{j as e,f as d,B,h as m,G as h,D as k}from"./mui-CNa9U2uD.js";import{T as A}from"./index-DYwkNjtW.js";import{l as C}from"./index-OPGlpRyR.js";import{a as I}from"./strings-Dc09WpXy.js";import{p as b,u as L,R as $}from"./index-zbfVzyne.js";import{t as y,T as z}from"./translations-CgIJnvC3.js";import{a as l,u as M}from"./vendor-B5xINevW.js";import"./firebase-C4LKcFbe.js";import"./urls-bwAPA7IR.js";function O(r){const t=C(r,"room");let o=!1,n="";if(t){const{roomBackgroundURL:c}=JSON.parse(t.settings),s=b(c);s!=null&&s.isVideo&&(o=s.isVideo),s!=null&&s.url&&(n=s.url)}return["color","gray"].includes(n)&&(n=""),{isVideo:o,url:n}}function V(){const[r,t]=l.useState(document.fullscreenElement!=null);return l.useEffect(()=>{const n=()=>{t(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",n),()=>{document.removeEventListener("fullscreenchange",n)}},[]),{isFullscreen:r,toggleFullscreen:()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen():document.exitFullscreen()}}}const D="actions",G=r=>{const{text:t,displayName:o}=r;if(!o)return{};const n=t==null?void 0:t.split(`
`),[c,s]=(n==null?void 0:n.slice(1))||[],f=c==null?void 0:c.split(":")[1].trim(),x=s==null?void 0:s.split(":")[1].trim();return{displayName:o,type:f,activity:x}};function Q(){const{id:r}=M(),{messages:t,isLoading:o}=I(),[n,c]=l.useState(""),[s,f]=l.useState(!1),[x,w]=l.useState(!1),{isVideo:E,url:g}=O(t),v=C(t,D)||{},i=L(r,v),{isFullscreen:N,toggleFullscreen:R}=V();l.useEffect(()=>{const a=window.cast&&window.cast.framework&&window.cast.framework.CastReceiverContext;if(a){document.body.classList.add("cast-receiver-mode"),w(!0);try{const u=window.cast.framework.CastReceiverContext.getInstance(),j=new window.cast.framework.CastReceiverOptions;j.disableIdleTimeout=!0,u.start(j)}catch(u){console.error("Error initializing Cast receiver:",u)}}return()=>{if(a){document.body.classList.remove("cast-receiver-mode");try{window.cast.framework.CastReceiverContext.getInstance().stop()}catch(u){console.error("Error stopping Cast receiver:",u)}}}},[]),l.useEffect(()=>{if(o)return;const a=t[t.length-1];(a==null?void 0:a.type)==="settings"&&(f(!0),c(`${a.displayName} ${y("changedSettings")}`))},[t,o]);const{displayName:F,type:T,activity:p}=G(v);return e.jsxs(d,{className:"flex-column",children:[!!g&&e.jsx($,{url:g,isVideo:E}),e.jsxs(d,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(d,{flex:"1",children:!x&&!N&&e.jsx(B,{variant:"text",onClick:R,children:"Fullscreen"})}),e.jsx(d,{textAlign:"center",flex:"1",children:!!(i!=null&&i.displayName)&&e.jsx(m,{variant:"h4",children:e.jsx(z,{i18nKey:"nextPlayersTurn",values:{player:i.displayName}})})},i==null?void 0:i.displayName),e.jsx(d,{flex:"1",textAlign:"right",className:"text-stroke",children:p&&e.jsxs(m,{variant:"h4",children:["blitzedout.com/",r]})})]}),e.jsx(h,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",children:e.jsx(h,{container:!0,justifyContent:"center",children:p?e.jsxs(h,{size:12,className:"action-box",children:[e.jsx(m,{variant:"h3",children:`${T} ${y("for")} ${F}`}),e.jsx(d,{className:"divider",children:e.jsx(k,{})}),e.jsx(m,{variant:"h1",children:p})]}):e.jsx("div",{className:"action-box",children:e.jsxs(m,{variant:"h1",children:["blitzedout.com/",r]})})})},t.length),e.jsx(A,{open:!!s,close:()=>f(!1),hideCloseButton:!0,children:e.jsx(m,{variant:"h5",children:n})})]})}export{Q as default};
