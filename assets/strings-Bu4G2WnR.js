import{t as b}from"./translations-BGyRMCWP.js";import{a as L,r as m}from"./vendor-BqRCY_y4.js";import{M as N,U as R,u as S,o as T}from"./index-DKEnn_wL.js";function U(){const t=L.useContext(N);if(!t)throw new Error("MessagesContext's value is undefined.");return t}function k(){const t=m.useContext(R);if(!t)throw new Error("UserListContext's value is undefined.");return t}function I(t){const e=T(t,"actions","DESC");return[...new Map(e.map(n=>[n.uid,n])).values()]}function P(t){if(!t||Object.keys(t).length===0)return!1;const n=Object.values(t);if(n.length===0)return!1;const s=n.sort((o,c)=>c.lastActive-o.lastActive)[0];return s&&Date.now()-s.lastActive<3e5}function O(t,e){var o;if(!t||t.length===0||!e)return!1;const n=10*60*1e3,s=(o=t.sort((c,l)=>l.timestamp.toMillis()-c.timestamp.toMillis()).find(c=>c.uid===e))==null?void 0:o.timestamp.toMillis();return s?Date.now()-s<n:!1}function j(){const{user:t}=S(),{messages:e,isLoading:n}=U(),{onlineUsers:s}=k(),o=m.useCallback((l,i,h,v)=>{if(v||!l||!i)return[];const E=I(h);return Object.entries(l).filter(([a,f])=>{const p=a===(i==null?void 0:i.uid);return P(f)||O(h,a)||p}).map(([a,f])=>{var M;if(!f||Object.keys(f).length===0)return{displayName:"Unknown",uid:a,isSelf:a===(i==null?void 0:i.uid),location:0,isFinished:!1};const p=Object.values(f),g=p.length>0?p.sort((r,x)=>x.lastActive-r.lastActive)[0]:{displayName:"Unknown"},{displayName:C="Unknown"}=g,u=(M=E.find(r=>r.uid===a))==null?void 0:M.text,y=/(?:#)[\d]*(?=:)/gs;let d=0;if(u&&u.match(y)){const r=u.match(y);r&&r[0]&&(d=Number(r[0].replace("#","")))}const w=d>0?d-1:d,A=!!(u!=null&&u.includes(b("finish")));return{displayName:C,uid:a,isSelf:a===(i==null?void 0:i.uid),location:w,isFinished:A}})},[]);return m.useMemo(()=>o(s,t,[...e],n),[o,s,t,e,n])}function B(t){const e=t==null?void 0:t.replace(/([A-Z])/g," $1").trim();return e?e.charAt(0).toUpperCase()+e.slice(1):""}function D(t){return{id:`simple-tab-${t}`,"aria-controls":`simple-tabpanel-${t}`}}function V(t){var n;const e=(t==null?void 0:t.split(/\r?\n/))||[];return(n=e[e.length-1])==null?void 0:n.split(":")[1]}function q(t,e){var s;const n=new RegExp(`\\d+\\s${e}`,"g");return(s=t.match(n))==null?void 0:s.filter((o,c,l)=>l.indexOf(o)===c)}function G(t){return(t==null?void 0:t.toUpperCase())==="PUBLIC"}function Z(t){return t==="online"}export{U as a,D as b,V as c,Z as d,q as e,B as f,G as i,j as u};
