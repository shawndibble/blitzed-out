import{j as e,f as c,B as N,h as l,G as x,D as F}from"./mui-BMKXmDCw.js";import{T}from"./index-BB-q-kK8.js";import{l as v}from"./index-B6-h4wZ4.js";import{a as B}from"./strings-BVYGyWlj.js";import{p as R,u as k,R as A}from"./index-BjdGrh40.js";import{t as j,T as I}from"./translations-CairTNs2.js";import{a as u,u as $}from"./vendor-Bf6wU4zJ.js";import"./firebase-C4LKcFbe.js";import"./urls-bwAPA7IR.js";function b(n){const s=v(n,"room");let a=!1,r="";if(s){const{roomBackgroundURL:i}=JSON.parse(s.settings),t=R(i);t!=null&&t.isVideo&&(a=t.isVideo),t!=null&&t.url&&(r=t.url)}return{isVideo:a,url:r}}function L(){const[n,s]=u.useState(document.fullscreenElement!=null);return u.useEffect(()=>{const r=()=>{s(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",r),()=>{document.removeEventListener("fullscreenchange",r)}},[]),{isFullscreen:n,toggleFullscreen:()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen():document.exitFullscreen()}}}const M="actions",O=n=>{const{text:s,displayName:a}=n;if(!a)return{};const r=s==null?void 0:s.split(`
`),[i,t]=(r==null?void 0:r.slice(1))||[],d=i==null?void 0:i.split(":")[1].trim(),f=t==null?void 0:t.split(":")[1].trim();return{displayName:a,type:d,activity:f}},V=()=>{if(window.cast&&window.cast.framework){const n=new cast.framework.CastReceiverOptions;n.disableIdleTimeout=!0,cast.framework.CastReceiverContext.getInstance().start(n)}};function U(){const{id:n}=$(),{messages:s,isLoading:a}=B(),[r,i]=u.useState(""),[t,d]=u.useState(!1),{isVideo:f,url:h}=b(s),g=v(s,M)||{},o=k(n,g),{isFullscreen:y,toggleFullscreen:w}=L();u.useEffect(()=>(V(),()=>{window.cast&&window.cast.framework&&cast.framework.CastReceiverContext.getInstance().stop()}),[]),u.useEffect(()=>{if(a)return;const m=s[s.length-1];(m==null?void 0:m.type)==="settings"&&(d(!0),i(`${m.displayName} ${j("changedSettings")}`))},[s,a]);const{displayName:C,type:E,activity:p}=O(g);return e.jsxs(c,{className:"flex-column",children:[!!h&&e.jsx(A,{url:h,isVideo:f}),e.jsxs(c,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(c,{flex:"1",children:!y&&e.jsx(N,{variant:"text",onClick:w,children:"Fullscreen"})}),e.jsx(c,{textAlign:"center",flex:"1",children:!!(o!=null&&o.displayName)&&e.jsx(l,{variant:"h4",children:e.jsx(I,{i18nKey:"nextPlayersTurn",values:{player:o.displayName}})})},o==null?void 0:o.display_name),e.jsx(c,{flex:"1",textAlign:"right",class:"text-stroke",children:p&&e.jsxs(l,{variant:"h4",children:["blitzedout.com/",n]})})]}),e.jsx(x,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",children:e.jsx(x,{container:!0,justifyContent:"center",children:p?e.jsxs(x,{size:12,className:"action-box",children:[e.jsx(l,{variant:"h3",children:`${E} ${j("for")} ${C}`}),e.jsx(c,{className:"divider",children:e.jsx(F,{})}),e.jsx(l,{variant:"h1",children:p})]}):e.jsx("div",{className:"action-box",children:e.jsxs(l,{variant:"h1",children:["blitzedout.com/",n]})})})},s.length),e.jsx(T,{open:!!t,close:()=>d(!1),hideCloseButton:!0,children:e.jsx(l,{variant:"h5",children:r})})]})}export{U as default};
