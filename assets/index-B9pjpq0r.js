import{j as e,f as u,B as R,h as m,G as j,D as b}from"./mui-BDjMQLu-.js";import{T as L}from"./index-pDQ-cv9k.js";import{a as N}from"./index-DbDl3cvH.js";import{a as k}from"./strings-BQQ7uF5O.js";import{p as I,u as $,R as w}from"./index-Bkzi56Rv.js";import{t as E,T as M}from"./translations-CW-OSHAD.js";import{r as i,u as V}from"./vendor-DoDY-zMw.js";import"./firebase-CfKEY2sz.js";import"./urls-BP4ggioV.js";function z(c){const t=N(c,"room");let r=!1,s="";if(t){const{roomBackgroundURL:o}=JSON.parse(t.settings),n=I(o);n!=null&&n.isVideo&&(r=n.isVideo),n!=null&&n.url&&(s=n.url)}return["color","gray"].some(o=>s.includes(o))&&(s=""),{isVideo:r,url:s}}function O(){const[c,t]=i.useState(document.fullscreenElement!=null);i.useEffect(()=>{const s=()=>{t(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",s),()=>{document.removeEventListener("fullscreenchange",s)}},[]);const r=i.useCallback(()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen().catch(s=>{console.error("Error attempting to enable fullscreen:",s)}):document.exitFullscreen().catch(s=>{console.error("Error attempting to exit fullscreen:",s)})},[]);return{isFullscreen:c,toggleFullscreen:r}}const D="actions",G=c=>{var f,x;const{text:t,displayName:r}=c;if(!r)return{};const s=t==null?void 0:t.split(`
`),[o,n]=(s==null?void 0:s.slice(1))||[],d=(f=o==null?void 0:o.split(":")[1])==null?void 0:f.trim(),h=(x=n==null?void 0:n.split(":")[1])==null?void 0:x.trim();return{displayName:r,type:d,activity:h}};function Q(){const{id:c}=V(),{messages:t,isLoading:r}=k(),[s,o]=i.useState(""),[n,d]=i.useState(!1),[h,f]=i.useState(!1),{isVideo:x,url:v}=z(t),p=N(t,D),l=$(p),{isFullscreen:B,toggleFullscreen:F}=O();if(i.useEffect(()=>{var y,C;const a=(C=(y=window.cast)==null?void 0:y.framework)==null?void 0:C.CastReceiverContext;return a&&(document.body.classList.add("cast-receiver-mode"),f(!0)),()=>{a&&document.body.classList.remove("cast-receiver-mode")}},[]),i.useEffect(()=>{if(r)return;const a=t[t.length-1];(a==null?void 0:a.type)==="settings"&&(d(!0),o(`${a.displayName} ${E("changedSettings")}`))},[t,r]),!p)return null;const{displayName:T,type:A,activity:g}=G(p);return e.jsxs(u,{className:"flex-column",children:[!!v&&e.jsx(w,{url:v,isVideo:x}),e.jsxs(u,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(u,{flex:"1",children:!h&&!B&&e.jsx(R,{variant:"text",onClick:F,children:"Fullscreen"})}),e.jsx(u,{textAlign:"center",flex:"1",children:!!(l!=null&&l.displayName)&&e.jsx(m,{variant:"h4",children:e.jsx(M,{i18nKey:"nextPlayersTurn",values:{player:l.displayName}})})},l==null?void 0:l.displayName),e.jsx(u,{flex:"1",textAlign:"right",className:"text-stroke",children:g&&e.jsxs(m,{variant:"h4",children:["blitzedout.com/",c]})})]}),e.jsx(j,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",children:e.jsx(j,{container:!0,justifyContent:"center",children:g?e.jsxs(j,{size:12,className:"action-box",children:[e.jsx(m,{variant:"h3",children:`${A} ${E("for")} ${T}`}),e.jsx(u,{className:"divider",children:e.jsx(b,{})}),e.jsx(m,{variant:"h1",children:g})]}):e.jsx("div",{className:"action-box",children:e.jsxs(m,{variant:"h1",children:["blitzedout.com/",c]})})})},t.length),e.jsx(L,{open:!!n,close:()=>d(!1),hideCloseButton:!0,children:e.jsx(m,{variant:"h5",children:s})})]})}export{Q as default};
