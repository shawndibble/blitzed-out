import{j as e,f as u,B as R,h as m,G as h,D as B}from"./mui-BMKXmDCw.js";import{T}from"./index-BB-q-kK8.js";import{l as v}from"./index-6azip5aT.js";import{a as A}from"./strings-BnFyzFLe.js";import{p as b,u as L,R as k}from"./index-D0mB-2st.js";import{t as j,T as I}from"./translations-CairTNs2.js";import{a,u as $}from"./vendor-Bf6wU4zJ.js";import"./firebase-C4LKcFbe.js";import"./urls-bwAPA7IR.js";function M(r){const s=v(r,"room");let o=!1,n="";if(s){const{roomBackgroundURL:i}=JSON.parse(s.settings),t=b(i);t!=null&&t.isVideo&&(o=t.isVideo),t!=null&&t.url&&(n=t.url)}return["color","gray"].some(i=>n.includes(i))&&(n=""),{isVideo:o,url:n}}function V(){const[r,s]=a.useState(document.fullscreenElement!=null);return a.useEffect(()=>{const n=()=>{s(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",n),()=>{document.removeEventListener("fullscreenchange",n)}},[]),{isFullscreen:r,toggleFullscreen:()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen():document.exitFullscreen()}}}const z="actions",O=r=>{const{text:s,displayName:o}=r;if(!o)return{};const n=s==null?void 0:s.split(`
`),[i,t]=(n==null?void 0:n.slice(1))||[],d=i==null?void 0:i.split(":")[1].trim(),f=t==null?void 0:t.split(":")[1].trim();return{displayName:o,type:d,activity:f}};function _(){const{id:r}=$(),{messages:s,isLoading:o}=A(),[n,i]=a.useState(""),[t,d]=a.useState(!1),[f,y]=a.useState(!1),{isVideo:C,url:p}=M(s),g=v(s,z)||{},c=L(r,g),{isFullscreen:N,toggleFullscreen:E}=V();a.useEffect(()=>{const l=window.cast&&window.cast.framework&&window.cast.framework.CastReceiverContext;return l?(document.body.classList.add("cast-receiver-mode"),y(!0),console.log("Running in Cast receiver environment")):console.log("Running in normal browser environment"),()=>{l&&document.body.classList.remove("cast-receiver-mode")}},[]),a.useEffect(()=>{if(o)return;const l=s[s.length-1];(l==null?void 0:l.type)==="settings"&&(d(!0),i(`${l.displayName} ${j("changedSettings")}`))},[s,o]);const{displayName:w,type:F,activity:x}=O(g);return e.jsxs(u,{className:"flex-column",children:[!!p&&e.jsx(k,{url:p,isVideo:C}),e.jsxs(u,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(u,{flex:"1",children:!f&&!N&&e.jsx(R,{variant:"text",onClick:E,children:"Fullscreen"})}),e.jsx(u,{textAlign:"center",flex:"1",children:!!(c!=null&&c.displayName)&&e.jsx(m,{variant:"h4",children:e.jsx(I,{i18nKey:"nextPlayersTurn",values:{player:c.displayName}})})},c==null?void 0:c.displayName),e.jsx(u,{flex:"1",textAlign:"right",className:"text-stroke",children:x&&e.jsxs(m,{variant:"h4",children:["blitzedout.com/",r]})})]}),e.jsx(h,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",children:e.jsx(h,{container:!0,justifyContent:"center",children:x?e.jsxs(h,{size:12,className:"action-box",children:[e.jsx(m,{variant:"h3",children:`${F} ${j("for")} ${w}`}),e.jsx(u,{className:"divider",children:e.jsx(B,{})}),e.jsx(m,{variant:"h1",children:x})]}):e.jsx("div",{className:"action-box",children:e.jsxs(m,{variant:"h1",children:["blitzedout.com/",r]})})})},s.length),e.jsx(T,{open:!!t,close:()=>d(!1),hideCloseButton:!0,children:e.jsx(m,{variant:"h5",children:n})})]})}export{_ as default};
