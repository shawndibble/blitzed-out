import{j as e,f as c,B,h as a,G as h,D as C}from"./mui-CFdxPsB0.js";import{T}from"./index-DV7ZzWGL.js";import{l as y}from"./index-BoYCg6nK.js";import{a as A}from"./strings-BIn62cSG.js";import{p as R,u as $,R as I}from"./index-DmC97BsJ.js";import{t as j,T as L}from"./translations-CairTNs2.js";import{a as u,u as M}from"./vendor-Bf6wU4zJ.js";import"./firebase-C4LKcFbe.js";import"./urls-bwAPA7IR.js";function V(r){const s=y(r,"room");let l=!1,n="";if(s){const{roomBackgroundURL:i}=JSON.parse(s.settings),t=R(i);t!=null&&t.isVideo&&(l=t.isVideo),t!=null&&t.url&&(n=t.url)}return{isVideo:l,url:n}}function b(){const[r,s]=u.useState(document.fullscreenElement!=null);return u.useEffect(()=>{const n=()=>{s(document.fullscreenElement!=null)};return document.addEventListener("fullscreenchange",n),()=>{document.removeEventListener("fullscreenchange",n)}},[]),{isFullscreen:r,toggleFullscreen:()=>{document.fullscreenElement==null?document.documentElement.requestFullscreen():document.exitFullscreen()}}}const k="actions",z=r=>{const{text:s,displayName:l}=r;if(!l)return{};const n=s==null?void 0:s.split(`
`),[i,t]=(n==null?void 0:n.slice(1))||[],m=i==null?void 0:i.split(":")[1].trim(),f=t==null?void 0:t.split(":")[1].trim();return{displayName:l,type:m,activity:f}};function S(){const{id:r}=M(),{messages:s,isLoading:l}=A(),[n,i]=u.useState(""),[t,m]=u.useState(!1),{isVideo:f,url:p}=V(s),g=y(s,k)||{},o=$(r,g),{isFullscreen:v,toggleFullscreen:N}=b();u.useEffect(()=>{if(l)return;const d=s[s.length-1];(d==null?void 0:d.type)==="settings"&&(m(!0),i(`${d.displayName} ${j("changedSettings")}`))},[s,l]);const{displayName:E,type:F,activity:x}=z(g);return e.jsxs(c,{className:"flex-column",children:[!!p&&e.jsx(I,{url:p,isVideo:f}),e.jsxs(c,{display:"flex",justifyContent:"space-between",sx:{mx:2,mt:2,mb:-2},children:[e.jsx(c,{flex:"1",children:!v&&e.jsx(B,{variant:"text",onClick:N,children:"Fullscreen"})}),e.jsx(c,{textAlign:"center",flex:"1",children:!!(o!=null&&o.displayName)&&e.jsx(a,{variant:"h4",children:e.jsx(L,{i18nKey:"nextPlayersTurn",values:{player:o.displayName}})})},o==null?void 0:o.display_name),e.jsx(c,{flex:"1",textAlign:"right",class:"text-stroke",children:x&&e.jsxs(a,{variant:"h4",children:["blitzedout.com/",r]})})]}),e.jsx(h,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",className:"cast-container",children:e.jsx(h,{container:!0,justifyContent:"center",children:x?e.jsxs(h,{size:12,className:"action-box",children:[e.jsx(a,{variant:"h3",children:`${F} ${j("for")} ${E}`}),e.jsx(c,{className:"divider",children:e.jsx(C,{})}),e.jsx(a,{variant:"h1",children:x})]}):e.jsx("div",{className:"action-box",children:e.jsxs(a,{variant:"h1",children:["blitzedout.com/",r]})})})},s.length),e.jsx(T,{open:!!t,close:()=>m(!1),hideCloseButton:!0,children:e.jsx(a,{variant:"h5",children:n})})]})}export{S as default};
