import{t as y}from"./translations-CgIJnvC3.js";import{b as d,a as A}from"./vendor-B5xINevW.js";import{M as C,U as g,u as h,o as x}from"./index-BvgHY_8x.js";function b(){const t=d.useContext(C);if(!t)throw new Error("MessagesContext's value is undefined.");return t}function w(){const t=d.useContext(g);if(!t)throw new Error("UserListContext's value is undefined.");return t}function T(t){const e=x(t,"actions","DESC");return[...new Map(e.map(n=>[n.uid,n])).values()]}function L(t){const n=Object.values(t).sort((i,o)=>o.lastActive-i.lastActive)[0];return Date.now()-n.lastActive<3e5}function N(t,e){var o;const i=(o=t.sort((s,r)=>r.timestamp-s.timestamp).find(s=>s.uid===e))==null?void 0:o.timestamp.toMillis();return Date.now()-i<6e5}function R(t,e,n,i){if(i||!t)return[];const o=T(n);return Object.entries(t).filter(([s,r])=>{const a=s===(e==null?void 0:e.uid);return L(r)||N(n,s)||a}).map(([s,r])=>{var p;const a=Object.values(r).sort((l,M)=>M.lastActive-l.lastActive)[0],{displayName:m}=a,c=(p=o.find(l=>l.uid===s))==null?void 0:p.text,f=/(?:#)[\d]*(?=:)/gs,u=c&&c.match(f)?Number(c.match(f)[0].replace("#","")):0,E=u>0?u-1:u,v=c==null?void 0:c.includes(y("finish"));return{displayName:m,uid:s,isSelf:s===(e==null?void 0:e.uid),location:E,isFinished:v}})}function P(){const{user:t}=h(),{messages:e,isLoading:n}=b(),{onlineUsers:i}=w();return A.useMemo(()=>R(i,t,[...e],n),[i,t,e,n])}function _(t){const e=t==null?void 0:t.replace(/([A-Z])/g," $1").trim();return e?e.charAt(0).toUpperCase()+e.slice(1):""}function O(t){return{id:`simple-tab-${t}`,"aria-controls":`simple-tabpanel-${t}`}}function $(t){var n;const e=(t==null?void 0:t.split(/\r?\n/))||[];return(n=e[e.length-1])==null?void 0:n.split(":")[1]}function j(t,e){var i;const n=new RegExp(`\\d+\\s${e}`,"g");return(i=t.match(n))==null?void 0:i.filter((o,s,r)=>r.indexOf(o)===s)}function D(t){return(t==null?void 0:t.toUpperCase())==="PUBLIC"}function F(t){return t==="online"}export{b as a,O as b,$ as c,F as d,j as e,_ as f,D as i,P as u};
